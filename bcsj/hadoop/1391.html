<!DOCTYPE html>
<html>
<head>
  <title>Hadoop集群（第8期）_HDFS初探之旅</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords" content="Hadoop集群,HDFS初探之旅" />
  <meta name="description" content="1、HDFS简介 HDFS（Hadoop Distributed File System）是Hadoop项目的核心子项目，是分布式计算中数据存储管理的基础，是基于 流数据模式 访问和处理 超大文件 的需求而开发的，可以运行于廉价" />
  <link href="/templets/default/css/bootstrap.min.css" rel="stylesheet">
  <link href="/templets/default/css/bootstrap-theme.min.css" rel="stylesheet">
  <link href="/templets/default/css/theme.css" rel="stylesheet">
  <link href="/templets/default/css/main.css" rel="stylesheet">
  <link href="/templets/default/css/animate.css" rel="stylesheet">
  <link href="/templets/default/css/header.css" rel="stylesheet">
</head>
<body>
  <header id="header" class="site-header">
    <div class="container" style="margin-top:0px;">
      <div class="row">
        <div class="col-sm-12 col-md-12">
          <div class="site-header-banner" style="min-height:170px;">
            <h2 class="title-site-name swing animated" id="title-site-name">一起学编程</h2>
            <div class="title-site-domain" id="title-site-domain">www.yqxbc.com</div>
            <div class="title-site-memo" id="title-site-memo">常用技术，开发中遇到的坑，你想要的或许这里有。</div>
          </div>
        </div>
      </div>
    </div>
    <nav class="navbar navbar-default navbar-custom">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header navbar-header-custom">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">首页</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav nav-custom">
            <li class="dropdown">
              <a href="/bcsj" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">编程设计<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="/bcsj/css/" title="CSS">CSS</a> </li>
                <li><a href="/bcsj/hadoop/" title="Hadoop">Hadoop</a> </li>
                <li><a href="/bcsj/ajax/" title="Ajax">Ajax</a> </li>
                <li><a href="/bcsj/js/" title="Javascript">Javascript</a> </li>
                <li><a href="/bcsj/java/" title="Java">Java</a> </li>
                <li><a href="/bcsj/jetty/" title="Jetty">Jetty</a> </li>
                <li><a href="/bcsj/python/" title="Python">Python</a> </li>
                <li><a href="/storm/" title="Storm">Storm</a> </li>
                <li><a href="/elasticsearch/" title="ElasticSearch">ElasticSearch</a> </li>
                <li><a href="/SpringBoot/" title="SpringBoot">SpringBoot</a> </li>
                <li><a href="/sublime/" title="Sublime">Sublime</a> </li>
                <li><a href="/springcloud/" title="SpringCloud">SpringCloud</a> </li>
                <li><a href="/zookeeper/" title="ZooKeeper">ZooKeeper</a> </li>
                <li><a href="/git/" title="Git">Git</a> </li>
                <li><a href="/maven/" title="Maven">Maven</a> </li>
                <li><a href="/gradle/" title="Gradle">Gradle</a> </li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="/shujuku" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">数据库 <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="/shujuku/redis/" title="redis">redis</a> </li>
                <li><a href="/shujuku/sqlserver/" title="SQL Server">SQL Server</a> </li>
                <li><a href="/shujuku/memcache/" title="Memcache">Memcache</a> </li>
                <li><a href="/shujuku/mysql/" title="MySql">MySql</a> </li>
                <li><a href="/shujuku/oracle/" title="Oracle">Oracle</a> </li>
                <li><a href="/shujuku/mangodb/" title="MangoDB">MangoDB</a> </li>
                <li><a href="/shujuku/hbase/" title="Hbase">Hbase</a> </li>
                <li><a href="/shujuku/access/" title="Access">Access</a> </li>
                <li><a href="/shujuku/db2/" title="DB2">DB2</a> </li>
              </ul>
            </li>
            <li><a href="/dnzs" target="_blank" title="电脑基础知识学习，计算机技术学习网站，计算机基础知识,电脑学习">电脑知识 <span class="sr-only">(current)</span></a></li>
            <li><a href="/wlzs" target="_blank" title="网络知识大全">网络知识</a></li>
            <li><a href="http://www.win10os.com"target="_blank" title="windows10系统">windows10</a></li>
            <li><a href="/czxt/linux" target="_blank" title="linux系统">linux</a></li>
            <li><a href="/erweima/" target="_blank" title="二维码生成">常用工具</a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>
  </header><!-- /header -->

  <div class="modal fade" id="imgModal" tabindex="-1" role="dialog" aria-hidden="true">
	   <div class="modal-dialog">
		  <div class="modal-content">
			 <div class="modal-body">
				<div id="modal_img" ></div>
			 </div>
		  </div>
	   </div>
	</div>
  <div class="container" style="padding-left:0px;padding-right:0px">
    
    <div class="col-sm-8  col-md-8">
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="art_title">
            <div>Hadoop集群（第8期）_HDFS初探之旅</div>
            <a href="/">yqxbc</a>  发布时间：11-25 来源：虾皮工作室 浏览：48次
          </div>
          <div class="art_body">
            <div class="col-md-12 well bg-success" role="complementary">
              <h3>文章目录</h3>
            	<nav>
            		<ul id="rootul" class="nav bs-docs-sidenav"></ul>		
            	</nav>
            </div>
            <div id="1391" class="art_content"><h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	1、HDFS简介</h2>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　HDFS（Hadoop Distributed File System）是Hadoop项目的核心子项目，是分布式计算中数据存储管理的基础，是基于<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">流数据模式</strong></span>访问和处理<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">超大文件</strong></span>的需求而开发的，可以运行于廉价的商用服务器上。它所具有的高容错、高可靠性、高可扩展性、高获得性、高吞吐率等特征为海量数据提供了不怕故障的存储，为超大数据集（Large Data Set）的应用处理带来了很多便利。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　Hadoop整合了众多文件系统，在其中有一个综合性的文件系统抽象，它提供了文件系统实现的各类接口，HDFS只是这个抽象文件系统的一个实例。提供了一个高层的文件系统抽象类org.apache.hadoop.fs.FileSystem，这个抽象类展示了一个分布式文件系统，并有几个具体实现，如下表1-1所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	表1-1 Hadoop的文件系统</p>
<div style="margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<table border="0" style="margin: 0px; padding: 0px; border-style: solid; border-color: silver; border-collapse: collapse; word-break: break-word;">
		<colgroup style="margin: 0px; padding: 0px;">
			<col style="margin: 0px; padding: 0px; width: 168px;" />
			<col style="margin: 0px; padding: 0px; width: 69px;" />
			<col style="margin: 0px; padding: 0px; width: 193px;" />
			<col style="margin: 0px; padding: 0px; width: 324px;" />
		</colgroup>
		<tbody style="margin: 0px; padding: 0px;" valign="top">
			<tr style="margin: 0px; padding: 0px; background: rgb(224, 224, 224);">
				<td style="margin: 0px; padding: 3px 7px; border-width: 1.5pt 0.75pt 0.75pt 1.5pt; border-style: solid; border-color: initial; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 10pt;"><strong style="margin: 0px; padding: 0px;">文件系统</strong></span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-top-width: 1.5pt; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: solid solid solid none; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">URI</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">方案</span></strong></span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-top-width: 1.5pt; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: solid solid solid none; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Java</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span></strong></span></p>
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 9pt;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">（</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; color: red;">org.apache.hadoop</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">）</span></strong></span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-top-width: 1.5pt; border-right-width: 1.5pt; border-bottom-width: 0.75pt; border-style: solid solid solid none; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 10pt;"><strong style="margin: 0px; padding: 0px;">定义</strong></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">Local</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">file</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">fs.LocalFileSystem</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">支持有客户端校验和本地文件系统。带有校验和的本地系统文件在</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">fs.RawLocalFileSystem</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">中实现。</span></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">HDFS</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">hdfs</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">hdfs.DistributionFileSystem</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Hadoop</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的分布式文件系统。</span></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">HFTP</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">hftp</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">hdfs.HftpFileSystem</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">支持通过</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; color: blue;"><strong style="margin: 0px; padding: 0px;">HTTP</strong></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">方式以<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">只读</strong></span>的方式访问</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">HDFS</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">distcp</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">经常用在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">不同</strong></span>的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">HDFS</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">集群间</strong></span>复制数据。</span></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">HSFTP</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">hsftp</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">hdfs.HsftpFileSystem</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">支持通过</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; color: blue;"><strong style="margin: 0px; padding: 0px;">HTTPS</strong></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">方式以<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">只读</strong></span>的方式访问</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">HDFS</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">。</span></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">HAR</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">har</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">fs.HarFileSystem</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">构建在</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Hadoop</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">文件系统之上，对文件进行归档。</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Hadoop</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">归档文件主要用来<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">减少</strong></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">NameNode</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">内存使用</strong></span>。</span></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">KFS</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">kfs</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">fs.kfs.KosmosFileSystem</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Cloudstore</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">（其前身是</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Kosmos</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">文件系统）文件系统是<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">类似于</strong></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">HDFS</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">和</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Google</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">GFS</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">文件系统，使用</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">C++</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">编写。</span></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">FTP</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">ftp</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">fs.ftp.FtpFileSystem</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">由</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">FTP</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">服务器支持的文件系统。</span></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">S3</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">（本地）</span></span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">s3n</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">fs.s3native.NativeS3FileSystem</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 0.75pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">基于</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Amazon S3</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的文件系统。</span></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 1.5pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">S3</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">（基于块）</span></span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 1.5pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">s3</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 1.5pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;" valign="middle">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">fs.s3.NativeS3FileSystem</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 1.5pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">基于</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Amazon S3</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的文件系统，以块格式存储解决了</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">S3</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">5GB</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">文件大小的限制。</span></span></p>
				</td>
			</tr>
		</tbody>
	</table>
</div>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　Hadoop提供了许多文件系统的接口，用户可以使用URI方案选取合适的文件系统来实现交互。</p>
<h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	2、HDFS基础概念</h2>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	2.1 数据块（block）</h3>
<ul style="margin: 0px 0px 0px 30px; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			HDFS(Hadoop Distributed File System)默认的最基本的存储单位是64M的数据块。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			和普通文件系统相同的是，HDFS中的文件是被分成64M一块的数据块存储的。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			不同于普通文件系统的是，HDFS中，如果一个文件小于一个数据块的大小，并不占用整个数据块存储空间。</div>
	</li>
</ul>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	2.2 NameNode和DataNode</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　HDFS体系结构中有两类节点，一类是NameNode，又叫&quot;元数据节点&quot;；另一类是DataNode，又叫&quot;数据节点&quot;。这两类节点分别承担Master和Worker具体任务的执行节点。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）元数据节点用来管理文件系统的命名空间</strong></span></p>
<ul style="margin: 0px 0px 0px 42pt; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			其将所有的文件和文件夹的元数据保存在一个文件系统树中。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			这些信息也会在硬盘上保存成以下文件：命名空间镜像(namespace image)及修改日志(edit log)</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			其还保存了一个文件包括哪些数据块，分布在哪些数据节点上。然而这些信息并不存储在硬盘上，而是在系统启动的时候从数据节点收集而成的。</div>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）数据节点是文件系统中真正存储数据的地方。</strong></span></p>
<ul style="margin: 0px 0px 0px 42pt; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			客户端(client)或者元数据信息(namenode)可以向数据节点请求写入或者读出数据块。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			其周期性的向元数据节点回报其存储的数据块信息。</div>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　3）从元数据节点（secondary namenode）</strong></span></p>
<ul style="margin: 0px 0px 0px 42pt; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			从元数据节点并不是元数据节点出现问题时候的备用节点，它和元数据节点负责不同的事情。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			其主要功能就是周期性将元数据节点的命名空间镜像文件和修改日志合并，以防日志文件过大。这点在下面会相信叙述。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			合并过后的命名空间镜像文件也在从元数据节点保存了一份，以防元数据节点失败的时候，可以恢复。</div>
	</li>
</ul>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	2.3 元数据节点目录结构</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/134025J46-0.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　VERSION文件是java properties文件，保存了HDFS的版本号。</p>
<ul style="margin: 0px 0px 0px 30px; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			layoutVersion是一个负整数，保存了HDFS的持续化在硬盘上的数据结构的格式版本号。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			namespaceID是文件系统的唯一标识符，是在文件系统初次格式化时生成的。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			cTime此处为0</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			storageType表示此文件夹中保存的是元数据节点的数据结构。</div>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		namespaceID=1232737062</p>
	<p style="margin: 10px auto; padding: 0px;">
		cTime=0</p>
	<p style="margin: 10px auto; padding: 0px;">
		storageType=NAME_NODE</p>
	<p style="margin: 10px auto; padding: 0px;">
		layoutVersion=-18</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	2.4 数据节点的目录结构</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/134025D42-1.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<ul style="margin: 0px 0px 0px 30px; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			数据节点的VERSION文件格式如下：</div>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		namespaceID=1232737062</p>
	<p style="margin: 10px auto; padding: 0px;">
		storageID=DS-1640411682-127.0.1.1-50010-1254997319480</p>
	<p style="margin: 10px auto; padding: 0px;">
		cTime=0</p>
	<p style="margin: 10px auto; padding: 0px;">
		storageType=DATA_NODE</p>
	<p style="margin: 10px auto; padding: 0px;">
		layoutVersion=-18</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<ul style="margin: 0px 0px 0px 30px; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			blk_&lt;id&gt;保存的是HDFS的数据块，其中保存了具体的二进制数据。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			blk_&lt;id&gt;.meta保存的是数据块的属性信息：版本信息，类型信息，和checksum</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			当一个目录中的数据块到达一定数量的时候，则创建子文件夹来保存数据块及数据块属性信息。</div>
	</li>
</ul>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	2.5 文件系统命名空间映像文件及修改日志</h3>
<ul style="margin: 0px 0px 0px 30px; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			当文件系统客户端(client)进行写操作时，首先把它记录在修改日志中(edit log)</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			元数据节点在内存中保存了文件系统的元数据信息。在记录了修改日志后，元数据节点则修改内存中的数据结构。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			每次的写操作成功之前，修改日志都会同步(sync)到文件系统。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			fsimage文件，也即命名空间映像文件，是内存中的元数据在硬盘上的checkpoint，它是一种序列化的格式，并不能够在硬盘上直接修改。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			同数据的机制相似，当元数据节点失败时，则最新checkpoint的元数据信息从fsimage加载到内存中，然后逐一重新执行修改日志中的操作。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			从元数据节点就是用来帮助元数据节点将内存中的元数据信息checkpoint到硬盘上的</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			checkpoint的过程如下：</div>
		<ul style="margin: 0px 0px 0px 30px; padding-right: 0px; padding-left: 0px;">
			<li style="margin: 0px; padding: 0px; list-style: disc;">
				<div style="margin: 0px; padding: 0px; text-align: justify;">
					从元数据节点通知元数据节点生成新的日志文件，以后的日志都写到新的日志文件中。</div>
			</li>
			<li style="margin: 0px; padding: 0px; list-style: disc;">
				<div style="margin: 0px; padding: 0px; text-align: justify;">
					从元数据节点用http get从元数据节点获得fsimage文件及旧的日志文件。</div>
			</li>
			<li style="margin: 0px; padding: 0px; list-style: disc;">
				<div style="margin: 0px; padding: 0px; text-align: justify;">
					从元数据节点将fsimage文件加载到内存中，并执行日志文件中的操作，然后生成新的fsimage文件。</div>
			</li>
			<li style="margin: 0px; padding: 0px; list-style: disc;">
				<div style="margin: 0px; padding: 0px; text-align: justify;">
					从元数据节点奖新的fsimage文件用http post传回元数据节点</div>
			</li>
			<li style="margin: 0px; padding: 0px; list-style: disc;">
				<div style="margin: 0px; padding: 0px; text-align: justify;">
					元数据节点可以将旧的fsimage文件及旧的日志文件，换为新的fsimage文件和新的日志文件(第一步生成的)，然后更新fstime文件，写入此次checkpoint的时间。</div>
			</li>
			<li style="margin: 0px; padding: 0px; list-style: disc;">
				<div style="margin: 0px; padding: 0px; text-align: justify;">
					这样元数据节点中的fsimage文件保存了最新的checkpoint的元数据信息，日志文件也重新开始，不会变的很大了。</div>
			</li>
		</ul>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1340252606-2.jpg" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	3、HDFS体系结构</h2>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　HDFS是一个主/从（Mater/Slave）体系结构，从最终用户的角度来看，它就像传统的文件系统一样，可以通过目录路径对文件执行CRUD（Create、Read、Update和Delete）操作。但由于分布式存储的性质，HDFS集群拥有一个NameNode和一些DataNode。NameNode管理文件系统的元数据，DataNode存储实际的数据。客户端通过同NameNode和DataNodes的交互访问文件系统。客户端联系NameNode以获取文件的元数据，而真正的文件I/O操作是直接和DataNode进行交互的。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1340255453-3.jpg" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图3.1 HDFS总体结构示意图</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）NameNode、DataNode和Client</strong></span></p>
<ul style="margin: 0px 0px 0px 42pt; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			NameNode可以看作是分布式文件系统中的管理者，主要负责管理文件系统的命名空间、集群配置信息和存储块的复制等。NameNode会将文件系统的Meta-data存储在内存中，这些信息主要包括了文件信息、每一个文件对应的文件块的信息和每一个文件块在DataNode的信息等。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			DataNode是文件存储的基本单元，它将Block存储在本地文件系统中，保存了Block的Meta-data，同时周期性地将所有存在的Block信息发送给NameNode。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			Client就是需要获取分布式文件系统文件的应用程序。</div>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）文件写入</strong></span></p>
<ul style="margin: 0px 0px 0px 42pt; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			Client向NameNode发起文件写入的请求。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			NameNode根据文件大小和文件块配置情况，返回给Client它所管理部分DataNode的信息。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			Client将文件划分为多个Block，根据DataNode的地址信息，按顺序写入到每一个DataNode块中。</div>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　3）文件读取</strong></span></p>
<ul style="margin: 0px 0px 0px 42pt; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			Client向NameNode发起文件读取的请求。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			NameNode返回文件存储的DataNode的信息。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			Client读取文件信息。</div>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　HDFS<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">典型的部署</strong></span>是在一个专门的机器上运行NameNode，集群中的其他机器各运行一个DataNode；也可以在运行NameNode的机器上同时运行DataNode，或者一台机器上运行多个DataNode。一个集群只有一个NameNode的设计大大简化了系统架构。</p>
<h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	4、HDFS的优缺点</h2>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	4.1 HDFS的优点</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）处理超大文件</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　这里的超大文件通常是指百MB、设置数百TB大小的文件。目前在实际应用中，HDFS已经能用来存储管理PB级的数据了。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）流式的访问数据</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　HDFS的设计建立在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">更多</strong></span>地响应&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">一次写入、多次读写</strong></span>&quot;任务的基础上。这意味着一个数据集<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">一旦</strong></span>由数据源生成，就会被<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">复制</strong></span>分发到<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">不同</strong></span>的存储节点中，然后<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">响应</strong></span>各种各样的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">数据分析</strong></span>任务<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">请求</strong></span>。在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">多数情况</strong></span>下，分析任务都会涉及数据集中的大部分数据，也就是说，对HDFS来说，请求读取<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">整个数据集</strong></span>要比<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">读取一条记录</strong></span>更加<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">高效</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　3）运行于廉价的商用机器集群上</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　Hadoop设计对硬件需求比较<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">低</strong></span>，只须运行在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">低廉</strong></span>的商用硬件集群上，而无需昂贵的高可用性机器上。廉价的商用机也就意味着大型集群中出现节点故障情况的概率非常高。这就要求设计HDFS时要充分考虑数据的可靠性，安全性及高可用性。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	4.2 HDFS的缺点</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）不适合<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;">低延迟<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);">数据访问</span></span></strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　如果要处理一些用户要求<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">时间比较短</strong></span>的低延迟应用请求，则HDFS<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">不适合</strong></span>。HDFS是为了处理<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">大型<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);">数据集分析任务</span></strong>的，主要是为达到<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">高</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">数据吞吐量</strong></span>而设计的，</span>这就可能要求以高延迟作为代价。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">　　改进策略</strong></span>：对于那些有低延时要求的应用程序，HBase是一个更好的选择。通过<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">上层数据管理</strong></span>项目来尽可能地弥补这个不足。在性能上有了很大的提升，它的口号就是goes real time。使用缓存或多master设计可以降低client的数据请求压力，以减少延时。还有就是对HDFS系统内部的修改，这就得权衡大吞吐量与低延时了，HDFS不是万能的银弹。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）无法<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">高效<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);">存储<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;">大量小<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);">文件</span></span></span></span></strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　因为Namenode把文件系统的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">元数据</strong></span>放置在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">内存</strong></span>中，所以文件系统所能容纳的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">文件数目</strong></span>是由Namenode的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">内存大小</strong></span>来决定。一般来说，每一个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">文件</strong></span>、<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">文件夹</strong></span>和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">Block</strong></span>需要占据150字节左右的空间，所以，如果你有100万个文件，每一个占据一个Block，你就至少需要300MB内存。当前来说，数百万的文件还是可行的，当扩展到数十亿时，对于当前的硬件水平来说就没法实现了。还有一个问题就是，因为Map task的数量是由splits来决定的，所以用MR处理大量的小文件时，就会产生过多的Maptask，线程管理开销将会增加作业时间。<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">举个例子</strong></span>，处理10000M的文件，若每个split为1M，那就会有10000个Maptasks，会有很大的线程开销；若每个split为100M，则只有100个Maptasks，每个Maptask将会有更多的事情做，而线程的管理开销也将减小很多。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">　　改进策略</strong></span>：要想让HDFS能处理好小文件，有不少方法。</p>
<ul style="margin: 0px 0px 0px 42pt; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			利用SequenceFile、MapFile、Har等方式归档小文件，这个方法的原理就是把小文件<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">归档</strong></span>起来管理，HBase就是基于此的。对于这种方法，如果想找回原来的小文件内容，那就必须得知道与归档文件的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">映射</strong></span>关系。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			横向扩展，一个Hadoop集群能管理的小文件有限，那就把几个Hadoop集群拖在一个虚拟服务器后面，形成一个大的Hadoop集群。google也是这么干过的。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			多Master设计，这个作用显而易见了。正在研发中的GFS II也要改为分布式多Master设计，还支持Master的Failover，而且Block大小改为1M，有意要调优处理小文件啊。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			附带个Alibaba DFS的设计，也是多Master设计，它把Metadata的映射存储和管理分开了，由多个Metadata存储节点和一个查询Master节点组成。</div>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　3）不支持<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">多用户<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);">写入及<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">任意<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);">修改文件</span></span></span></span></strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　在HDFS的一个文件中<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">只有</strong></span>一个写入者，而且写操作<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">只能</strong></span>在文件<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">末尾</strong></span>完成，即<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">只能执行追加操作</strong></span>。目前HDFS还<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">不支持<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">多个用户</span></strong>对<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">同一文件</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">写</strong></span>操作，以及在文件任意位置进行修改。</span></p>
<h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	5、HDFS常用操作</h2>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　先说一下&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">hadoop fs</strong></span>&nbsp;和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">hadoop dfs</strong></span>的区别&quot;，看两本Hadoop书上各有用到，但效果一样，求证与网络发现下面一解释比较中肯。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　粗略的讲，fs是个比较抽象的层面，在分布式环境中，fs就是dfs，但在本地环境中，fs是local file system，这个时候dfs就不能用。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	5.1 文件操作</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）列出HDFS文件</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　此处为你展示如何通过&quot;-ls&quot;命令列出HDFS下的文件：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		hadoop fs -ls</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　执行结果如图5-1-1所示。在这里需要注意：在HDFS中未带参数的&quot;-ls&quot;命名没有返回任何值，它<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">默认</strong></span>返回HDFS的&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">home</strong></span>&quot;目录下的内容。在HDFS中，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">没</strong></span>有<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">当前目录</strong></span>这样一个概念，也<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">没</strong></span>有<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">cd</strong></span>这个命令。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340253G8-4.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5-1-1 列出HDFS文件</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）列出HDFS目录下<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;">某个文档<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);">中的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);">文件</span></span></span></strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　此处为你展示如何通过&quot;-ls 文件名&quot;命令浏览HDFS下名为&quot;input&quot;的文档中文件：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		hadoop fs &ndash;ls input</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　执行结果如图5-1-2所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/134025O06-5.png" style="margin: 0px; padding: 0px; border: 0px; width: 846px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5-1-2 列出HDFS下名为input的文档下的文件</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　3）上传文件到HDFS</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　此处为你展示如何通过&quot;-put 文件1 文件2&quot;命令将&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">Master.Hadoop</strong></span>&quot;机器下的&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">/home/hadoop</strong></span>&quot;目录下的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">file</strong></span>文件上传到HDFS上并<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">重命名</strong></span>为<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">test</strong></span>：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		hadoop fs &ndash;put ~/file test</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　执行结果如图5-1-3所示。在执行&quot;-put&quot;时<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">只</strong></span>有<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">两种</strong></span>可能，即是<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">执行成功</strong></span>和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">执行失败</strong></span>。在上传文件时，文件首先复制到<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">DataNode</strong></span>上。<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">只有</strong></span>所有的DataNode都<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">成功</strong></span>接收完数据，文件上传<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">才是</strong></span>成功的。其他情况（如文件上传终端等）对HDFS来说都是做了无用功。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/134025L16-6.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5-1-3 成功上传file到HDFS</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　4）将<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;">HDFS<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);">中文件<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">复制<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);">到<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);">本地系统<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);">中</span></span></span></span></span></span></strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　此处为你展示如何通过&quot;-get 文件1 文件2&quot;命令将HDFS中的&quot;output&quot;文件复制到本地系统并命名为&quot;getout&quot;。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		hadoop fs &ndash;get output getout</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　执行结果如图5-1-4所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340256242-7.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5-1-4 成功将HDFS中output文件复制到本地系统</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">　　备注</strong></span>：与&quot;-put&quot;命令一样，&quot;-get&quot;操作既可以操作<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">文件</strong></span>，也可以操作<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">目录</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　5）删除HDFS下的文档</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　此处为你展示如何通过&quot;-rmr 文件&quot;命令删除HDFS下名为&quot;newoutput&quot;的文档：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		hadoop fs &ndash;rmr newoutput</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　执行结果如图5-1-5所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340256430-8.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5-1-5 成功删除HDFS下的newoutput文档</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　6）查看HDFS下某个文件</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　此处为你展示如何通过&quot;-cat 文件&quot;命令查看HDFS下input文件中内容：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		hadoop fs -cat input/*</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　执行结果如图5-1-6所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340254132-9.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5-1-6 HDFS下input文件的内容</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　&quot;hadoop fs&quot;的命令远不止这些，本小节介绍的命令已可以在HDFS上完成大多数常规操作。对于其他操作，可以通过&quot;-help commandName&quot;命令所列出的清单来进一步学习与探索。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	5.2 管理与更新</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）报告HDFS的基本统计情况</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　此处为你展示通过&quot;-report&quot;命令如何查看HDFS的基本统计信息：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		hadoop dfsadmin -report</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　执行结果如图5-2-1所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340255b4-10.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5-2-1 HDFS基本统计信息</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）退出安全模式</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　NameNode在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">启动时</strong></span>会<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">自动</strong></span>进入<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">安全模式</strong></span>。安全模式是NameNode的一种状态，在这个阶段，文件系统<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">不允许</strong></span>有任何<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">修改</strong></span>。安全模式的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">目的</strong></span>是在系统启动时<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">检查</strong></span>各个DataNode上数据块的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">有效</strong></span>性，同时<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">根据策略</strong></span>对数据块进行必要的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">复制</strong></span>或<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">删除</strong></span>，当数据块最小百分比数满足的最小副本数条件时，会<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">自动退出</strong></span>安全模式。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　系统显示&quot;Name node is in safe mode&quot;，说明系统正处于安全模式，这时只需要等待17秒即可，也可以通过下面的命令退出安全模式：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		hadoop dfsadmin &ndash;safemode enter</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　成功退出安全模式结果如图5-2-2所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340255121-11.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5-2-2 成功退出安全模式</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　3）进入安全模式</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　在必要情况下，可以通过以下命令把HDFS置于安全模式：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		hadoop dfsadmin &ndash;safemode enter</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　执行结果如图5-2-3所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340252461-12.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5-2-3 进入HDFS安全模式</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　4）添加节点</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">　　可扩展性</strong></span>是HDFS的一个重要特性，向HDFS集群中添加节点是很容易实现的。添加一个新的DataNode节点，首先在新加节点上安装好Hadoop，要和NameNode使用相同的配置（可以直接从NameNode复制），修改&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">/usr/hadoop/conf/<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;">master</span></strong>&quot;文件，加入<strong style="margin: 0px; padding: 0px;">NameNode</strong></span>主机名。然后在NameNode节点上修改&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">/usr/hadoop/conf/<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">slaves</span></strong>&quot;文件，加入新节点主机名，再建立到新加点无密码的</span>SSH连接，运行启动命令：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		start-all.sh</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　5）负载均衡</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　HDFS的数据在各个DataNode中的分布肯能很不均匀，尤其是在DataNode节点<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">出现故障<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">或<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">新增</span></span></strong>DataNode</span>节点时。新增数据块时NameNode对DataNode节点的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">选择策略</strong></span>也有可能导致数据块分布的不均匀。用户可以使用命令重新平衡DataNode上的数据块的分布：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		start-balancer.sh</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　执行命令前，DataNode节点上数据分布情况如图5-2-4所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/134025M39-13.png" style="margin: 0px; padding: 0px; border: 0px; width: 846px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　负载均衡完毕后，DataNode节点上数据的分布情况如图5-2-5所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340251104-14.png" style="margin: 0px; padding: 0px; border: 0px; width: 846px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　执行负载均衡命令如图5-2-6所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/134025I16-15.png" style="margin: 0px; padding: 0px; border: 0px; width: 846px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	6、HDFS API详解</h2>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　Hadoop中关于文件操作类基本上全部是在&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">org.apache.hadoop.fs</strong></span>&quot;包中，这些API能够支持的操作包含：打开文件，读写文件，删除文件等。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	Hadoop类库中最终面向用户提供的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">接口类</strong></span>是<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">FileSystem</strong></span>，该类是个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">抽象类</strong></span>，只能通过来类的get方法得到具体类。get方法存在几个重载版本，常用的是这个：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		static FileSystem get(Configuration conf);</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　该类封装了几乎所有的文件操作，例如mkdir，delete等。综上基本上可以得出操作文件的程序库框架：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		operator()</p>
	<p style="margin: 10px auto; padding: 0px;">
		{</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp; 得到Configuration对象</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp; 得到FileSystem对象</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp; 进行文件操作</p>
	<p style="margin: 10px auto; padding: 0px;">
		}</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.1 上传本地文件</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　通过&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">FileSystem.copyFromLocalFile（Path src，Patch dst）</strong></span>&quot;可将<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">本地文件<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">上传</span></strong>到<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">HDFS</strong></span>的制定位置上，其中</span>src和dst均为文件的完整路径。具体事例如下：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.file;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileStatus;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileSystem;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;CopyFile {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileSystem hdfs=FileSystem.<em style="margin: 0px; padding: 0px;">get</em>(conf);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">本地文件</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Path src =<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;D:\\HebutWinOS&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//HDFS</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">为止</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Path dst =<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;/&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hdfs.copyFromLocalFile(src, dst);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">out</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Upload to&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+conf.get(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;fs.default.name&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">));</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileStatus files[]=hdfs.listStatus(dst);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">for</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">(FileStatus file:files){</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">out</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(file.getPath());</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　运行结果可以通过控制台、项目浏览器和SecureCRT查看，如图6-1-1、图6-1-2、图6-1-3所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）控制台结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/134025L56-16.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-1-1 运行结果（1）</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）项目浏览器</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340251514-17.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-1-2 运行结果（2）</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　3）SecureCRT结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/134025Na-18.png" style="margin: 0px; padding: 0px; border: 0px; width: 846px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-1-3 运行结果（3）</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.2 创建HDFS文件</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　通过&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">FileSystem.create（Path f）</strong></span>&quot;可在HDFS上创建文件，其中f为文件的完整路径。具体实现如下：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.file;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FSDataOutputStream;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileSystem;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;CreateFile {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileSystem hdfs=FileSystem.<em style="margin: 0px; padding: 0px;">get</em>(conf);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">byte</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">[] buff=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;hello hadoop world!\n&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.getBytes();</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Path dfs=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;/test&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FSDataOutputStream outputStream=hdfs.create(dfs);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; outputStream.write(buff,0,buff.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">length<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　运行结果如图6-2-1和图6-2-2所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）项目浏览器</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340251003-19.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-2-1 运行结果（1）</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）SecureCRT结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340251061-20.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-2-2 运行结果（2）</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.3 创建HDFS目录</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　通过&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">FileSystem.mkdirs（Path f）</strong></span>&quot;可在HDFS上创建文件夹，其中f为文件夹的完整路径。具体实现如下：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.dir;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileSystem;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;CreateDir {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception{</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileSystem hdfs=FileSystem.<em style="margin: 0px; padding: 0px;">get</em>(conf);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Path dfs=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;/TestDir&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hdfs.mkdirs(dfs);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp; }</span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　运行结果如图6-3-1和图6-3-2所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）项目浏览器</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/13402553a-21.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-3-1 运行结果（1）</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）SecureCRT结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/13402529E-22.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-3-2 运行结果（2）</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.4 重命名HDFS文件</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　通过&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">FileSystem.rename（Path src，Path dst）</strong></span>&quot;可为指定的HDFS文件重命名，其中src和dst均为文件的完整路径。具体实现如下：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.file;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileSystem;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; background-color: silver;">Rename</span>{</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileSystem hdfs=FileSystem.<em style="margin: 0px; padding: 0px;">get</em>(conf);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Path frpaht=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;/test&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span></span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">旧的文件名</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Path topath=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;/test1&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span></span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">新的文件名</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">boolean</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;isRename=hdfs.rename(frpaht, topath);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String result=isRename?<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">成功</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">:<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;</span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">失败</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">out</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;</span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">文件重命名结果为：</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(42, 0, 255);">&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+result);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp; }</span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　运行结果如图6-4-1和图6-4-2所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）项目浏览器</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/13402525X-23.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-4-1 运行结果（1）</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）SecureCRT结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340253535-24.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-4-2 运行结果（2）</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.5 删除HDFS上的文件</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　通过&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">FileSystem.delete（Path f，Boolean recursive）</strong></span>&quot;可删除指定的HDFS文件，其中f为需要删除文件的完整路径，recuresive用来确定是否进行递归删除。具体实现如下：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.file;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileSystem;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;DeleteFile {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileSystem hdfs=FileSystem.<em style="margin: 0px; padding: 0px;">get</em>(conf);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Path delef=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;/test1&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">boolean</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;isDeleted=hdfs.delete(delef,<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">false</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">递归删除</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//boolean isDeleted=hdfs.delete(<span style="margin: 0px; padding: 0px; line-height: 1.8; text-decoration: underline;">delef</span>,true);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">out</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Delete?&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+isDeleted);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　运行结果如图6-5-1和图6-5-2所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）控制台结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340253033-25.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-5-1 运行结果（1）</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）项目浏览器</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340252310-26.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-5-2 运行结果（2）</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.6 删除HDFS上的目录</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　同<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">删除文件</strong></span>代码<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">一样</strong></span>，只是换成删除目录路径即可，如果目录下有文件，要进行递归删除。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.7 查看某个HDFS文件是否存在</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　通过&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">FileSystem.exists（Path f）</strong></span>&quot;可查看指定HDFS文件是否存在，其中f为文件的完整路径。具体实现如下：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.file;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileSystem;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;CheckFile {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileSystem hdfs=FileSystem.<em style="margin: 0px; padding: 0px;">get</em>(conf);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Path findf=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;/test1&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">boolean</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;isExists=hdfs.exists(findf);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">out</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Exist?&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+isExists);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　运行结果如图6-7-1和图6-7-2所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）控制台结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340255X3-27.png" style="margin: 0px; padding: 0px; border: 0px; width: 846px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-7-1 运行结果（1）</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）项目浏览器</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340252292-28.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-7-2 运行结果（2）</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.8 查看HDFS文件的最后修改时间</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　通过&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">FileSystem.getModificationTime()</strong></span>&quot;可查看指定HDFS文件的修改时间。具体实现如下：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.file;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileStatus;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileSystem;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;GetLTime {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileSystem hdfs=FileSystem.<em style="margin: 0px; padding: 0px;">get</em>(conf);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Path fpath =<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;/user/hadoop/test/file1.txt&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileStatus fileStatus=hdfs.getFileStatus(fpath);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">long</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;modiTime=fileStatus.getModificationTime();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">out</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;file1.txt</span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的修改时间是</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(42, 0, 255);">&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+modiTime);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　运行结果如图6-8-1所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340256007-29.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-8-1 控制台结果</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.9 读取HDFS某个目录下的所有文件</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　通过&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">FileStatus.getPath（）</strong></span>&quot;可查看指定HDFS中某个目录下所有文件。具体实现如下：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.file;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileStatus;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileSystem;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;ListAllFile {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; text-decoration: underline;">Configuration</span>();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileSystem hdfs=FileSystem.<em style="margin: 0px; padding: 0px;">get</em>(conf);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Path listf =<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;/user/hadoop/test&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileStatus stats[]=hdfs.listStatus(listf);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">for</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;i = 0; i &lt; stats.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">length<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">; ++i)</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">　　　　 {</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">　　　　　　 System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">out</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(stats[i].getPath().toString());</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">　　　　 }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hdfs.close();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　运行结果如图6-9-1和图6-9-2所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）控制台结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340252b0-30.png" style="margin: 0px; padding: 0px; border: 0px; width: 846px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-9-1 运行结果（1）</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）项目浏览器</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340254524-31.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-9-2 运行结果（2）</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.10 查找某个文件在HDFS集群的位置</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　通过&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">FileSystem.getFileBlockLocation（FileStatus file，long start，long len）</strong></span>&quot;可查找指定文件在HDFS集群上的位置，其中file为文件的完整路径，start和len来标识查找文件的路径。具体实现如下：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.file;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.BlockLocation;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileStatus;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileSystem;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;FileLoc {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileSystem hdfs=FileSystem.<em style="margin: 0px; padding: 0px;">get</em>(conf);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Path fpath=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;/user/hadoop/cygwin&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileStatus filestatus = hdfs.getFileStatus(fpath);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BlockLocation[] blkLocations = hdfs.getFileBlockLocations(</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">filestatus, 0, filestatus.getLen());</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;blockLen = blkLocations.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">length<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">for</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;i=0;i&lt;blockLen;i++){</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] hosts = blkLocations[i].getHosts();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">out</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;block_&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+i+<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;_location:&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+hosts[0]);</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　运行结果如图6-10-1和6.10.2所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）控制台结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/134025F47-32.png" style="margin: 0px; padding: 0px; border: 0px; width: 846px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-10-1 运行结果（1）</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）项目浏览器</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/134025F25-33.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-10-2 运行结果（2）</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.11 获取HDFS集群上所有节点名称信息</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　通过&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">DatanodeInfo.getHostName（）</strong></span>&quot;可获取HDFS集群上的所有节点名称。具体实现如下：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.file;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.FileSystem;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.hdfs.DistributedFileSystem;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.hdfs.protocol.DatanodeInfo;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;GetList {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileSystem fs=FileSystem.<em style="margin: 0px; padding: 0px;">get</em>(conf);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DistributedFileSystem hdfs = (DistributedFileSystem)fs;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DatanodeInfo[] dataNodeStats = hdfs.getDataNodeStats();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">for</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;i=0;i&lt;dataNodeStats.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">length<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;i++){</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">out</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;DataNode_&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+i+<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;_Name:&quot;</span></span></span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+dataNodeStats[i].getHostName());</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　运行结果如图6-11-1所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/134025K00-34.png" style="margin: 0px; padding: 0px; border: 0px; width: 846px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6-11-1 控制台结果</p>
<h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	7、HDFS的读写数据流</h2>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	7.1 文件的读取剖析</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340252953-35.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　文件读取的过程如下：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）解释一</strong></span></p>
<ul style="margin: 0px 0px 0px 42pt; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			客户端(client)用FileSystem的open()函数打开文件。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			DistributedFileSystem用RPC调用元数据节点，得到文件的数据块信息。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			对于每一个数据块，元数据节点返回保存数据块的数据节点的地址。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			DistributedFileSystem返回FSDataInputStream给客户端，用来读取数据。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			客户端调用stream的read()函数开始读取数据。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			DFSInputStream连接保存此文件第一个数据块的最近的数据节点。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			Data从数据节点读到客户端(client)。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			当此数据块读取完毕时，DFSInputStream关闭和此数据节点的连接，然后连接此文件下一个数据块的最近的数据节点。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			当客户端读取完毕数据的时候，调用FSDataInputStream的close函数。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			在读取数据的过程中，如果客户端在与数据节点通信出现错误，则尝试连接包含此数据块的下一个数据节点。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			失败的数据节点将被记录，以后不再连接。</div>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）解释二</strong></span></p>
<ul style="margin: 0px 0px 0px 42pt; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			使用HDFS提供的客户端开发库，向远程的Namenode发起RPC请求；</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			Namenode会视情况返回文件的部分或者全部block列表，对于每个block，Namenode都会返回有该block拷贝的datanode地址；</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			客户端开发库会选取离客户端最接近的datanode来读取block；</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			读取完当前block的数据后，关闭与当前的datanode连接，并为读取下一个block寻找最佳的datanode；</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			当读完列表的block后，且文件读取还没有结束，客户端开发库会继续向Namenode获取下一批的block列表。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			读取完一个block都会进行checksum验证，如果读取datanode时出现错误，客户端会通知Namenode，然后再从下一个拥有该block拷贝的datanode继续读。</div>
	</li>
</ul>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	7.2 文件的写入剖析</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　<img alt="" src="/uploads/allimg/151125/1340251T2-36.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　写入文件的过程比读取较为复杂：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　1）解释一</strong></span></p>
<ul style="margin: 0px 0px 0px 42pt; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			客户端调用create()来创建文件</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			DistributedFileSystem用RPC调用元数据节点，在文件系统的命名空间中创建一个新的文件。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			元数据节点首先确定文件原来不存在，并且客户端有创建文件的权限，然后创建新文件。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			DistributedFileSystem返回DFSOutputStream，客户端用于写数据。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			客户端开始写入数据，DFSOutputStream将数据分成块，写入data queue。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			Data queue由Data Streamer读取，并通知<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">元数据节点</strong></span>分配<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">数据节点</strong></span>，用来存储数据块(每块默认复制3块)。分配的数据节点放在一个pipeline里。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			Data Streamer将数据块写入pipeline中的第一个数据节点。第一个数据节点将数据块发送给第二个数据节点。第二个数据节点将数据发送给第三个数据节点。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			DFSOutputStream为发出去的数据块保存了ack queue，等待pipeline中的数据节点告知数据已经写入成功。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			如果数据节点在写入的过程中失败：</div>
		<ul style="margin: 0px 0px 0px 30px; padding-right: 0px; padding-left: 0px;">
			<li style="margin: 0px; padding: 0px; list-style: disc;">
				<div style="margin: 0px; padding: 0px; text-align: justify;">
					关闭pipeline，将ack queue中的数据块放入data queue的开始。</div>
			</li>
			<li style="margin: 0px; padding: 0px; list-style: disc;">
				<div style="margin: 0px; padding: 0px; text-align: justify;">
					当前的数据块在已经写入的数据节点中被元数据节点赋予新的标示，则错误节点重启后能够察觉其数据块是过时的，会被删除。</div>
			</li>
			<li style="margin: 0px; padding: 0px; list-style: disc;">
				<div style="margin: 0px; padding: 0px; text-align: justify;">
					失败的数据节点从pipeline中移除，另外的数据块则写入pipeline中的另外两个数据节点。</div>
			</li>
			<li style="margin: 0px; padding: 0px; list-style: disc;">
				<div style="margin: 0px; padding: 0px; text-align: justify;">
					元数据节点则被通知此数据块是复制块数不足，将来会再创建第三份备份。</div>
			</li>
		</ul>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			当客户端结束写入数据，则调用stream的close函数。此操作将所有的数据块写入pipeline中的数据节点，并等待ack queue返回成功。<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">最后</strong></span>通知元数据节点写入完毕。</div>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">　　2）解释二</strong></span></p>
<ul style="margin: 0px 0px 0px 42pt; padding-right: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			使用HDFS提供的客户端开发库，向远程的Namenode发起RPC请求；</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			Namenode会检查要创建的文件是否已经存在，创建者是否有权限进行操作，成功则会为文件创建一个记录，否则会让客户端抛出异常；</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			当客户端开始写入文件的时候，开发库会将文件切分成多个packets，并在内部以&quot;data queue&quot;的形式管理这些packets，并向Namenode申请新的blocks，获取用来存储replicas的合适的datanodes列表，列表的大小根据在Namenode中对replication的设置而定。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			开始以pipeline（管道）的形式将packet写入所有的replicas中。开发库把packet以流的方式写入第一个datanode，该datanode把该packet存储之后，再将其传递给在此pipeline中的下一个datanode，直到最后一个datanode，这种写数据的方式呈流水线的形式。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			最后一个datanode成功存储之后会返回一个ack packet，在pipeline里传递至客户端，在客户端的开发库内部维护着&quot;ack queue&quot;，成功收到datanode返回的ack packet后会从&quot;ack queue&quot;移除相应的packet。</div>
	</li>
	<li style="margin: 0px; padding: 0px; list-style: disc;">
		<div style="margin: 0px; padding: 0px; text-align: justify;">
			如果传输过程中，有某个datanode出现了故障，那么当前的pipeline会被关闭，出现故障的datanode会从当前的pipeline中移除，剩余的block会继续剩下的datanode中继续以pipeline的形式传输，同时Namenode会分配一个新的datanode，保持replicas设定的数量。</div>
	</li>
</ul>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	原文链接http://www.cnblogs.com/xia520pi/archive/2012/05/28/2520813.html</p>
</div>
  		  <!-- 将此标记放在您希望显示like按钮的位置 -->          
            <div class="art_like"><div class="bdlikebutton"></div></div>
          </div>
        </div>
      </div>
      <div class="pnum">
        <div class="pages mypagelist">
          <div></div>
        </div>
      </div>
      <div class="pre_next">
        <nav>
          <ul class="pager">
            <li class="previous"></li>
            <li class="next"></li>
          </ul>
        </nav>
      </div>
      <div class="well"> 
    		如果你有好的<a href="http://www.win10os.com/win10zixun" title="win10资讯">win10资讯</a>或者<a href="http://www.win10os.com/win10jiqiao" title="win10教程">win10教程</a>，以及<a href="http://www.win10os.com/win10xitong" title="win10">win10</a>相关的问题想要获得<a href="http://www.win10os.com/win10xiazai" title="win10系统下载">win10系统下载</a>的关注与报道。<br/>欢迎加入发送邮件到657025171#qq.com(#替换为@)。期待你的好消息！
    	</div>
    </div>
    <!--右侧部分-->
    <div class="col-sm-4 col-md-4">
      <script src='/plus/ad_js.php?aid=12' language='javascript'></script>
      <div class="panel panel-custom panel-custom-right">
        <div class="panel-heading">最新文章>>></div>
        <div class="panel-body">
          <ul class="all_list">
            <li><a href='/bcsj/java/42949670.html'>《RocketMq》七、Broker中心节点</a></li><li><a href='/bcsj/java/59451787.html'>《RocketMq》六、Client－Consumer消费者详解</a></li><li><a href='/bcsj/java/93478184.html'>《RocketMq》五、Client－Producer生产者详解</a></li><li><a href='/bcsj/java/16882015.html'>《RocketMq》四、Client Producer/Consumer总览</a></li><li><a href='/bcsj/java/66636302.html'>《RocketMq》三、NameServer</a></li><li><a href='/bcsj/java/91963739.html'>《RocketMq》二、存储篇</a></li><li><a href='/bcsj/java/36422446.html'>《RocketMq》一、网络传输篇</a></li><li><a href='/bcsj/java/69287988.html'>linux jar包启动脚本</a></li><li><a href='/bcsj/java/89472738.html'>nginx 反向代理oss</a></li><li><a href='/bcsj/java/43423861.html'>细粒度 自定义注解 权限控制具体实现</a></li>
          </ul>
        </div>
      </div>  
      <script src='/plus/ad_js.php?aid=14' language='javascript'></script>
      <div id="scr_cont" class="panel panel-custom panel-custom-right">
        <div class="panel-heading">相关文章>>></div>
        <div class="panel-body">
          <ul class="all_list">
            <li><a href='/bcsj/hadoop/1392.html'>Hadoop集群（第9期）_MapReduce初级案例</a></li><li><a href='/bcsj/hadoop/1383.html'>Hadoop集群（第4期）_SecureCRT使用</a></li><li><a href='/bcsj/hadoop/1384.html'>Hadoop集群（第5期）_Hadoop安装配置</a></li><li><a href='/bcsj/hadoop/1390.html'>Hadoop集群（第7期）_Eclipse开发环境设置</a></li><li><a href='/bcsj/hadoop/1391.html'>Hadoop集群（第8期）_HDFS初探之旅</a></li><li><a href='/bcsj/hadoop/905.html'>Hadoop HDFS如何配置</a></li><li><a href='/bcsj/hadoop/1361.html'>还不懂Hadoop分布式文件系统HDFS的工作原理？</a></li><li><a href='/bcsj/hadoop/1382.html'>Hadoop集群（第3期）_VSFTP安装配置</a></li><li><a href='/bcsj/hadoop/899.html'>HADOOP基本操作命令</a></li><li><a href='/bcsj/hadoop/1380.html'>Hadoop集群（第2期）_机器信息分布表</a></li>
          </ul>
          </ul>
        </div>
      </div>
      <div class="ad"></div>
    </div>
    
  </div>
  <nav class="navbar navbar-default navbar-fixed-bottom navbar-bottom-custom">
    <div class="container">
      <span class="pull-right navbar-text" id="font_smaller" onclick="changeFont('smaller')">A-</span>&nbsp;&nbsp;<span class="pull-right navbar-text" id="font_bigger" onclick="changeFont('bigger')">A+</span>
    </div>
  </nav>
  <div class="footer">
    <div class="foot">
      <br>
      一起学编程是一家纯计算机技术学习、电脑学习、IT技术学习交流型网站，一起学编程所载文章来源于网络，如果不慎侵犯了您的权益，请联系我们删除！站长QQ：657025171<br>
      <a href="/aboutus.html">关于我们</a> | <a href="/dashiji.html">大事记</a> | <a href="/jiazhiguan.html">网站价值观</a> | <a href="/contactus.html">联系我们</a> | <a href="/sitemap.xml">网站地图</a> | <a href="/copyright.html">版权声明</a><br>
      Copyright ◎ 2011 - 2018 yqxbc.com All Rights Reserved.<br>
      yqxbc.com 版权所有 京ICP备11048740号-7<br>

    </div>
  </div>
  <script src="/templets/default/js/jquery-2.1.3.js"></script>
  <script src="/templets/default/js/bootstrap.min.js"></script>
  <script src="/templets/default/js/docs.min.js"></script>
  <script src="/templets/default/js/main.js"></script>
  <script src="/templets/default/js/header.js"></script>
  <script src="/templets/default/js/article.js"></script>
  <script src="/templets/default/js/page-dir.js"></script>
  <script type="text/javascript">
    document.getElementById('count').innerHTML = document.getElementById('count_data').innerHTML;
      var img = $(".art_content p").find("img")
      $.each(img,function(index,el){
        el.style.width='100%';
      });
  </script>
  <!-- 将此代码放在适当的位置，建议在body结束前 -->
  <script id="bdlike_shell"></script>
  <script>
    var bdShare_config = {"type":"large","color":"blue","likeText":"内容很精彩","likedText":"您已顶过，谢谢！"};
    document.getElementById("bdlike_shell").src="http://bdimg.share.baidu.com/static/js/like_shell.js?t=" + Math.ceil(new Date()/3600000);
  </script>
</body>
</html>
