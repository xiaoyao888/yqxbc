<!DOCTYPE html>
<html>
<head>
  <title>Hadoop集群（第9期）_MapReduce初级案例</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords" content="Hadoop集群,MapReduce,初级案例" />
  <meta name="description" content="1、数据去重 数据去重 主要是为了掌握和利用 并行化思想 来对数据进行 有意义 的 筛选 。 统计大数据集上的数据种类个数 、 从网站日志中计算访问地 等这些看似庞杂的任务都会涉及" />
  <link href="/templets/default/css/bootstrap.min.css" rel="stylesheet">
  <link href="/templets/default/css/bootstrap-theme.min.css" rel="stylesheet">
  <link href="/templets/default/css/theme.css" rel="stylesheet">
  <link href="/templets/default/css/main.css" rel="stylesheet">
  <link href="https://cdn.bootcss.com/animate.css/3.5.2/animate.css" rel="stylesheet">
  <link href="/templets/default/css/header.css" rel="stylesheet">
</head>
<body>
  <header id="header" class="site-header">
    <div class="container" style="margin-top:0px;">
      <div class="row">
        <div class="col-sm-12 col-md-12">
          <div class="site-header-banner" style="min-height:170px;">
            <h2 class="title-site-name swing animated" id="title-site-name">鹏鹏编程网</h2>
            <div class="title-site-domain" id="title-site-domain">www.flypeng.com</div>
            <div class="title-site-memo" id="title-site-memo">常用技术，开发中遇到的坑，你想要的或许这里有。</div>
          </div>
        </div>
      </div>
    </div>
    <nav class="navbar navbar-default navbar-custom">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header navbar-header-custom">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">首页</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav nav-custom">
            <li><a href="javascript:void(0);" title="SpringCloud">SpringCloud</a></li>
            <li class="dropdown">
              <a href="/bcsj" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">编程设计<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="/bcsj/css/" title="CSS">CSS</a> </li>
                <li><a href="/bcsj/hadoop/" title="Hadoop">Hadoop</a> </li>
                <li><a href="/bcsj/ajax/" title="Ajax">Ajax</a> </li>
                <li><a href="/bcsj/js/" title="Javascript">Javascript</a> </li>
                <li><a href="/bcsj/java/" title="Java">Java</a> </li>
                <li><a href="/bcsj/jetty/" title="Jetty">Jetty</a> </li>
                <li><a href="/bcsj/python/" title="Python">Python</a> </li>
                <li><a href="/storm/" title="Storm">Storm</a> </li>
                <li><a href="/elasticsearch/" title="ElasticSearch">ElasticSearch</a> </li>
                <li><a href="/SpringBoot/" title="SpringBoot">SpringBoot</a> </li>
                <li><a href="/sublime/" title="Sublime">Sublime</a> </li>
                <li><a href="/springcloud/" title="SpringCloud">SpringCloud</a> </li>
                <li><a href="/zookeeper/" title="ZooKeeper">ZooKeeper</a> </li>
                <li><a href="/git/" title="Git">Git</a> </li>
                <li><a href="/maven/" title="Maven">Maven</a> </li>
                <li><a href="/gradle/" title="Gradle">Gradle</a> </li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="/shujuku" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">数据库 <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="/shujuku/redis/" title="redis">redis</a> </li>
                <li><a href="/shujuku/sqlserver/" title="SQL Server">SQL Server</a> </li>
                <li><a href="/shujuku/memcache/" title="Memcache">Memcache</a> </li>
                <li><a href="/shujuku/mysql/" title="MySql">MySql</a> </li>
                <li><a href="/shujuku/oracle/" title="Oracle">Oracle</a> </li>
                <li><a href="/shujuku/mangodb/" title="MangoDB">MangoDB</a> </li>
                <li><a href="/shujuku/hbase/" title="Hbase">Hbase</a> </li>
                <li><a href="/shujuku/access/" title="Access">Access</a> </li>
                <li><a href="/shujuku/db2/" title="DB2">DB2</a> </li>
              </ul>
            </li>
            <li><a href="/dnzs" title="电脑基础知识学习，计算机技术学习网站，计算机基础知识,电脑学习">电脑知识 <span class="sr-only">(current)</span></a></li>
            <li><a href="/wlzs" title="网络知识大全" class="swing animated">网络知识</a></li>
            <li><a href="http://www.win10os.com" title="windows10系统" class="">windows10</a></li>
            <li><a href="/czxt/linux" title="linux系统" class="">linux</a></li>
            <li><a href="/erweima/" target="_blank" title="二维码生成">常用工具</a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>
  </header><!-- /header -->

  <div class="modal fade" id="imgModal" tabindex="-1" role="dialog" aria-hidden="true">
	   <div class="modal-dialog">
		  <div class="modal-content">
			 <div class="modal-body">
				<div id="modal_img" ></div>
			 </div>
		  </div>
	   </div>
	</div>
  <div class="container" style="padding-left:0px;padding-right:0px">
    
    <div class="col-sm-8  col-md-8">
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="art_title">
            <div>Hadoop集群（第9期）_MapReduce初级案例</div>
            <a href="/">flypeng</a>  发布时间：1970-01-18 来源：虾皮工作室 浏览：955次
          </div>
          <div class="art_body">
            <div class="col-md-12 well bg-success" role="complementary">
              <h3>文章目录</h3>
            	<nav>
            		<ul id="rootul" class="nav bs-docs-sidenav"></ul>		
            	</nav>
            </div>
            <div id="1392" class="art_content"><h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	1、数据去重</h2>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　&nbsp;&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">数据去重</strong></span>&quot;主要是为了掌握和利用<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">并行化思想</strong></span>来对数据进行<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">有意义</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">筛选</strong></span>。<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">统计大数据集上的数据种类个数</strong></span>、<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">从网站日志中计算访问地</strong></span>等这些看似庞杂的任务都会涉及数据去重。下面就进入这个实例的MapReduce程序设计。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	1.1 实例描述</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　对数据文件中的数据进行去重。数据文件中的每行都是一个数据。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　样例<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">输入</strong></span>如下所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）file1：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-1 a</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-2 b</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">2012-3-3 c</strong></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">2012-3-4 d</strong></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">2012-3-5 a</strong></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-6 b</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-7 c</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">2012-3-3 c</strong></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）file2：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-1 b</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-2 a</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-3 b</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">2012-3-4 d</strong></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">2012-3-5 a</strong></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-6 c</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-7 d</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">2012-3-3 c</strong></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp; 样例<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">输出</strong></span>如下所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-1 a</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-1 b</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-2 a</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-2 b</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-3 b</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">2012-3-3 c</strong></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">2012-3-4 d</strong></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">2012-3-5 a</strong></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-6 b</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-6 c</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-7 c</p>
	<p style="margin: 10px auto; padding: 0px;">
		2012-3-7 d</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	1.2 设计思路</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">　　数据去重</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">最终目标</strong></span>是让<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">原始数据</strong></span>中<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">出现次数<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">超过一次</span></strong>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">数据</strong></span>在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">输出文件</strong></span>中<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">只<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">出现一次</span></strong>。</span>我们自然而然会想到将同一个数据的所有记录都交给<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">一台</strong></span>reduce</span>机器，无论这个数据出现多少次，只要在最终结果中输出一次就可以了。具体就是reduce的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">输入</strong></span>应该以<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">数据</strong></span>作为<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">key</strong></span>，而对value-list则<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">没有</strong></span>要求。当reduce接收到一个&lt;key，value-list&gt;时就<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">直接</strong></span>将key复制到输出的key中，并将value设置成<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">空值</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　在MapReduce流程中，map的输出&lt;key，value&gt;经过shuffle过程聚集成&lt;key，value-list&gt;后会交给reduce。所以从设计好的reduce输入可以反推出map的输出key应为数据，value任意。继续反推，map输出数据的key为数据，而在这个实例中每个数据代表输入文件中的一行内容，所以map阶段要完成的任务就是在采用Hadoop默认的作业输入方式之后，将value设置为key，并直接输出（输出中的value任意）。map中的结果经过shuffle过程之后交给reduce。reduce阶段不会管每个key有多少个value，它直接将输入的key复制为输出的key，并输出就可以了（输出中的value被设置成空了）。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	1.3 程序代码</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp; 程序代码如下所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.mr;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;java.io.IOException;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; text-decoration: underline;">org.apache.hadoop.io.IntWritable</span>;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.io.Text;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Job;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Mapper;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Reducer;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.util.GenericOptionsParser;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Dedup {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//map</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">将输入中的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">value</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">复制到输出数据的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">key</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">上，并直接输出</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Map&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Mapper&lt;Object,Text,Text,Text&gt;{</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">private</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">line</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text();<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span></span></span></span></span></span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">每行数据</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;map(Object key,Text value,Context context)</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException,InterruptedException{</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">line</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">=value;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">line</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">));</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//reduce</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">将输入中的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">key</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">复制到输出数据的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">key</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">上，并直接输出</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Reduce&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Reducer&lt;Text,Text,Text,Text&gt;{</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;reduce(Text key,Iterable&lt;Text&gt; values,Context context)</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException,InterruptedException{</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(key,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">));</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception{</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">这句话很关键</strong></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conf.set(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;mapred.job.tracker&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;192.168.1.2:9001&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] ioArgs=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String[]{<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;dedup_in&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;dedup_out&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">};</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; String[] otherArgs =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;GenericOptionsParser(conf, ioArgs).getRemainingArgs();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(otherArgs.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">length<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;!= 2) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">err</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Usage: Data Deduplication &lt;in&gt; &lt;out&gt;&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(2);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; Job job =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Job(conf,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Data Deduplication&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; job.setJarByClass(Dedup.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">、</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Combine</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">和</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">处理类</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; job.setMapperClass(Map.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; job.setCombinerClass(Reduce.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; job.setReducerClass(Reduce.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置输出类型</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputKeyClass(Text.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputValueClass(Text.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置输入和输出目录</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; FileInputFormat.<em style="margin: 0px; padding: 0px;">addInputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[0]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; FileOutputFormat.<em style="margin: 0px; padding: 0px;">setOutputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[1]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(job.waitForCompletion(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">true</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) ? 0 : 1);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	1.4 代码结果</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）准备测试数据</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp; 通过Eclipse下面的&quot;DFS Locations&quot;在&quot;/user/hadoop&quot;目录下创建输入文件&quot;dedup_in&quot;文件夹（<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">备注</strong></span>：&quot;dedup_out&quot;不需要创建。）如图1.4-1所示，已经成功创建。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342221148-0.png" style="margin: 0px; padding: 0px; border: 0px;" />&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<img alt="" src="/uploads/allimg/151125/1342221R5-1.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图1.4-1 创建&quot;dedup_in&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 图1.4.2 上传&quot;file*.txt&quot;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; &nbsp;然后在本地建立两个txt文件，通过Eclipse上传到&quot;/user/hadoop/dedup_in&quot;文件夹中，两个txt文件的内容如&quot;实例描述&quot;那两个文件一样。如图1.4-2所示，成功上传之后。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp; 从SecureCRT远处查看&quot;Master.Hadoop&quot;的也能证实我们上传的两个文件。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342222207-2.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 查看两个文件的内容如图1.4-3所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342225162-3.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图1.4-3 文件&quot;file*.txt&quot;内容</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）查看运行结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp; 这时我们<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">右击</strong></span>Eclipse的&quot;DFS Locations&quot;中&quot;/user/hadoop&quot;文件夹进行刷新，这时会发现多出一个&quot;dedup_out&quot;文件夹，且里面有3个文件，然后打开双其&quot;part-r-00000&quot;文件，会在Eclipse中间把内容显示出来。如图1.4-4所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/134222N22-4.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图1.4-4 运行结果</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 此时，你可以对比一下和我们之前预期的结果是否一致。</p>
<h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	2、数据排序</h2>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">数据排序</strong></span>&quot;是许多实际任务执行时要完成的第一项工作，比如<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">学生成绩评比</strong></span>、<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">数据建立索引</strong></span>等。这个实例和数据去重类似，都是<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">先</strong></span>对<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">原始数据</strong></span>进行<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">初步处理</strong></span>，为<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">进一步</strong></span>的数据操作<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">打好基础</strong></span>。下面进入这个示例。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	2.1 实例描述</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 对输入文件中数据进行排序。<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">输入文件</strong></span>中的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">每行内容</strong></span>均为一个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">数字</strong></span>，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">即一个数据</strong></span>。要求在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">输出</strong></span>中每行有<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">两个间隔</strong></span>的数字，其中，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">第一个</strong></span>代表原始数据在原始数据集中的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">位次</strong></span>，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">第二</strong></span>个代表<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">原始数据</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 样例<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">输入</strong></span>：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）file1：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		2</p>
	<p style="margin: 10px auto; padding: 0px;">
		32</p>
	<p style="margin: 10px auto; padding: 0px;">
		654</p>
	<p style="margin: 10px auto; padding: 0px;">
		32</p>
	<p style="margin: 10px auto; padding: 0px;">
		15</p>
	<p style="margin: 10px auto; padding: 0px;">
		756</p>
	<p style="margin: 10px auto; padding: 0px;">
		65223</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）file2：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		5956</p>
	<p style="margin: 10px auto; padding: 0px;">
		22</p>
	<p style="margin: 10px auto; padding: 0px;">
		650</p>
	<p style="margin: 10px auto; padding: 0px;">
		92</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">3）file3：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		26</p>
	<p style="margin: 10px auto; padding: 0px;">
		54</p>
	<p style="margin: 10px auto; padding: 0px;">
		6</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 样例<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">输出</strong></span>：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		1&nbsp;&nbsp;&nbsp; 2</p>
	<p style="margin: 10px auto; padding: 0px;">
		2&nbsp;&nbsp;&nbsp; 6</p>
	<p style="margin: 10px auto; padding: 0px;">
		3&nbsp;&nbsp;&nbsp; 15</p>
	<p style="margin: 10px auto; padding: 0px;">
		4&nbsp;&nbsp;&nbsp; 22</p>
	<p style="margin: 10px auto; padding: 0px;">
		5&nbsp;&nbsp;&nbsp; 26</p>
	<p style="margin: 10px auto; padding: 0px;">
		6&nbsp;&nbsp;&nbsp; 32</p>
	<p style="margin: 10px auto; padding: 0px;">
		7&nbsp;&nbsp;&nbsp; 32</p>
	<p style="margin: 10px auto; padding: 0px;">
		8&nbsp;&nbsp;&nbsp; 54</p>
	<p style="margin: 10px auto; padding: 0px;">
		9&nbsp;&nbsp;&nbsp; 92</p>
	<p style="margin: 10px auto; padding: 0px;">
		10&nbsp;&nbsp;&nbsp; 650</p>
	<p style="margin: 10px auto; padding: 0px;">
		11&nbsp;&nbsp;&nbsp; 654</p>
	<p style="margin: 10px auto; padding: 0px;">
		12&nbsp;&nbsp;&nbsp; 756</p>
	<p style="margin: 10px auto; padding: 0px;">
		13&nbsp;&nbsp;&nbsp; 5956</p>
	<p style="margin: 10px auto; padding: 0px;">
		14&nbsp;&nbsp;&nbsp; 65223</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	2.2 设计思路</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　这个实例<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">仅仅</strong></span>要求对<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">输入数据进行排序</strong></span>，熟悉MapReduce过程的读者会很快想到在MapReduce过程中就有排序，是否可以利用这个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">默认</strong></span>的排序，而不需要自己再实现具体的排序呢？答案是肯定的。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　但是在使用之前<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">首先</strong></span>需要<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">了解</strong></span>它的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">默认排序规则</strong></span>。它是按照<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">key</strong></span>值进行<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">排序</strong></span>的，如果key为封装int的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">IntWritable</strong></span>类型，那么MapReduce按照<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">数字大小</strong></span>对key排序，如果key为封装为String的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">Text</strong></span>类型，那么MapReduce按照<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">字典顺序</strong></span>对字符串排序。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　了解了这个细节，我们就知道应该使用封装int的IntWritable型数据结构了。也就是在map中将读入的数据转化成IntWritable型，然后作为key值输出（value任意）。reduce拿到&lt;key，value-list&gt;之后，将输入的key作为value输出，并根据<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">value-list</strong></span>中<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">元素</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">个数</strong></span>决定输出的次数。输出的key（即代码中的linenum）是一个全局变量，它统计当前key的位次。需要注意的是这个程序中<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">没有配置</strong></span>Combiner，也就是在MapReduce过程中不使用Combiner。这主要是因为使用map和reduce就已经能够完成任务了。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	2.3 程序代码</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 程序代码如下所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.mr;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;java.io.IOException;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.io.IntWritable;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.io.Text;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Job;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Mapper;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Reducer;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.util.GenericOptionsParser;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Sort {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//map</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">将输入中的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">value</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">化成</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">IntWritable</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">类型，作为输出的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">key</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Map&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">　　　　　　　　Mapper&lt;Object,Text,IntWritable,IntWritable&gt;{</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">private</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IntWritable&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">data</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IntWritable();</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;map(Object key,Text value,Context context)</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException,InterruptedException{</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String line=value.toString();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">data</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.set(Integer.<em style="margin: 0px; padding: 0px;">parseInt</em>(line));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">data</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IntWritable(1));</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//reduce</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">将输入中的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">key</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">复制到输出数据的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">key</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">上，</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">然后根据输入的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">value-list</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">中元素的个数决定</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">key</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的输出次数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">用全局</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; text-decoration: underline;">linenum</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">来代表</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">key</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的位次</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Reduce&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Reducer&lt;IntWritable,IntWritable,IntWritable,IntWritable&gt;{</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">private</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IntWritable&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">linenum</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IntWritable(1);</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;reduce(IntWritable key,Iterable&lt;IntWritable&gt; values,Context context)</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException,InterruptedException{</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">for</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">(IntWritable&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; text-decoration: underline;">val</span>:values){</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">linenum</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">, key);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">linenum</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IntWritable(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">linenum</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.get()+1);</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception{</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">这句话很关键</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conf.set(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;mapred.job.tracker&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;192.168.1.2:9001&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] ioArgs=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String[]{<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;sort_in&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;sort_out&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">};</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; String[] otherArgs =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;GenericOptionsParser(conf, ioArgs).getRemainingArgs();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(otherArgs.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">length<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;!= 2) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">err</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Usage: Data Sort &lt;in&gt; &lt;out&gt;&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(2);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; Job job =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Job(conf,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Data Sort&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; job.setJarByClass(Sort.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">和</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">处理类</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; job.setMapperClass(Map.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; job.setReducerClass(Reduce.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置输出类型</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputKeyClass(IntWritable.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputValueClass(IntWritable.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置输入和输出目录</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; FileInputFormat.<em style="margin: 0px; padding: 0px;">addInputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[0]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; FileOutputFormat.<em style="margin: 0px; padding: 0px;">setOutputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[1]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(job.waitForCompletion(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">true</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) ? 0 : 1);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	2.4 代码结果</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）准备测试数据</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 通过Eclipse下面的&quot;DFS Locations&quot;在&quot;/user/hadoop&quot;目录下创建输入文件&quot;sort_in&quot;文件夹（<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">备注</strong></span>：&quot;sort_out&quot;不需要创建。）如图2.4-1所示，已经成功创建。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342223a9-5.png" style="margin: 0px; padding: 0px; border: 0px;" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img alt="" src="/uploads/allimg/151125/1342221358-6.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图2.4-1 创建&quot;sort_in&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 图2.4.2 上传&quot;file*.txt&quot;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 然后在本地建立三个txt文件，通过Eclipse上传到&quot;/user/hadoop/sort_in&quot;文件夹中，三个txt文件的内容如&quot;实例描述&quot;那三个文件一样。如图2.4-2所示，成功上传之后。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 从SecureCRT远处查看&quot;Master.Hadoop&quot;的也能证实我们上传的三个文件。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/13422262L-7.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	查看两个文件的内容如图2.4-3所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/13422210c-8.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图2.4-3 文件&quot;file*.txt&quot;内容</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）查看运行结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 这时我们<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">右击</strong></span>Eclipse的&quot;DFS Locations&quot;中&quot;/user/hadoop&quot;文件夹进行刷新，这时会发现多出一个&quot;sort_out&quot;文件夹，且里面有3个文件，然后打开双其&quot;part-r-00000&quot;文件，会在Eclipse中间把内容显示出来。如图2.4-4所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342226155-9.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图2.4-4 运行结果</p>
<h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	3、平均成绩</h2>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; &quot;平均成绩&quot;主要目的还是在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">重温经典</strong></span>&quot;WordCount&quot;例子，可以说是在基础上的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">微变化</strong></span>版，该实例主要就是实现一个计算学生平均成绩的例子。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	3.1 实例描述</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　对输入文件中数据进行就算学生平均成绩。输入文件中的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">每行内容</strong></span>均为<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">一个学生</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">姓名</strong></span>和他相应的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">成绩</strong></span>，如果有多门学科，则每门学科为一个文件。要求在输出中每行有两个间隔的数据，其中，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">第一个</strong></span>代表学生的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">姓名</strong></span>，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">第二个</strong></span>代表其<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">平均成绩</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 样本<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">输入</strong></span>：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）math：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		张三&nbsp;&nbsp;&nbsp; 88</p>
	<p style="margin: 10px auto; padding: 0px;">
		李四&nbsp;&nbsp;&nbsp; 99</p>
	<p style="margin: 10px auto; padding: 0px;">
		王五&nbsp;&nbsp;&nbsp; 66</p>
	<p style="margin: 10px auto; padding: 0px;">
		赵六&nbsp;&nbsp;&nbsp; 77</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）china：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		张三&nbsp;&nbsp;&nbsp; 78</p>
	<p style="margin: 10px auto; padding: 0px;">
		李四&nbsp;&nbsp;&nbsp; 89</p>
	<p style="margin: 10px auto; padding: 0px;">
		王五&nbsp;&nbsp;&nbsp; 96</p>
	<p style="margin: 10px auto; padding: 0px;">
		赵六&nbsp;&nbsp;&nbsp; 67</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">3）english：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		张三&nbsp;&nbsp;&nbsp; 80</p>
	<p style="margin: 10px auto; padding: 0px;">
		李四&nbsp;&nbsp;&nbsp; 82</p>
	<p style="margin: 10px auto; padding: 0px;">
		王五&nbsp;&nbsp;&nbsp; 84</p>
	<p style="margin: 10px auto; padding: 0px;">
		赵六&nbsp;&nbsp;&nbsp; 86</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 样本<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">输出</strong></span>：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		张三&nbsp;&nbsp;&nbsp; 82</p>
	<p style="margin: 10px auto; padding: 0px;">
		李四&nbsp;&nbsp;&nbsp; 90</p>
	<p style="margin: 10px auto; padding: 0px;">
		王五&nbsp;&nbsp;&nbsp; 82</p>
	<p style="margin: 10px auto; padding: 0px;">
		赵六&nbsp;&nbsp;&nbsp; 76</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	3.2 设计思路</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 计算学生平均成绩是一个仿&quot;WordCount&quot;例子，用来重温一下开发MapReduce程序的流程。程序包括两部分的内容：Map部分和Reduce部分，分别实现了map和reduce的功能。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">Map处理</strong></span>的是一个纯文本文件，文件中存放的数据时每一行表示一个学生的姓名和他相应一科成绩。Mapper处理的数据是由InputFormat分解过的数据集，其中InputFormat的作用是将数据集切割成小数据集InputSplit，每一个InputSlit将由一个Mapper负责处理。此外，InputFormat中还提供了一个RecordReader的实现，并将一个InputSplit解析成&lt;key,value&gt;对提供给了map函数。InputFormat的默认值是TextInputFormat，它针对文本文件，按行将文本切割成InputSlit，并用LineRecordReader将InputSplit解析成&lt;key,value&gt;对，key是行在文本中的位置，value是文件中的一行。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; Map的结果会通过partion分发到Reducer，Reducer做完Reduce操作后，将通过以格式OutputFormat输出。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; Mapper最终处理的结果对&lt;key,value&gt;，会送到Reducer中进行合并，合并的时候，有相同key的键/值对则送到同一个Reducer上。Reducer是所有用户定制Reducer类地基础，它的输入是key和这个key对应的所有value的一个迭代器，同时还有Reducer的上下文。Reduce的结果由Reducer.Context的write方法输出到文件中。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	3.3 程序代码</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 程序代码如下所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.mr;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;java.io.IOException;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;java.util.Iterator;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;java.util.StringTokenizer;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.io.IntWritable;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.io.LongWritable;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.io.Text;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Job;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Mapper;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Reducer;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.input.TextInputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.output.TextOutputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.util.GenericOptionsParser;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Score {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Map&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mapper&lt;</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">LongWritable</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">, Text, Text, IntWritable&gt; {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;map(</span></span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">LongWritable</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;key, Text value, Context context)</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException, InterruptedException {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">将输入的纯文本文件的数据转化成</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">String</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String line = value.toString();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">将输入的数据首先按行进行分割</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 9pt;">StringTokenizer tokenizerArticle =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;StringTokenizer(line,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;\n&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">分别对每一行进行处理</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">while</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(tokenizerArticle.hasMoreElements()) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">每行按空格划分</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringTokenizer tokenizerLine =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;StringTokenizer(tokenizerArticle.nextToken());</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String strName = tokenizerLine.nextToken();<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">学生姓名部分</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String strScore = tokenizerLine.nextToken();<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">成绩部分</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Text name =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(strName);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;scoreInt = Integer.<em style="margin: 0px; padding: 0px;">parseInt</em>(strScore);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输出姓名和成绩</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(name,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IntWritable(scoreInt));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Reduce&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;reduce(Text key, Iterable&lt;IntWritable&gt; values,</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Context context)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException, InterruptedException {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;sum = 0;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;count = 0;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Iterator&lt;IntWritable&gt; iterator = values.iterator();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">while</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(iterator.hasNext()) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum += iterator.next().get();<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">计算总分</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; count++;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">统计总的科目数</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;average = (<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) sum / count;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span></span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">计算平均成绩</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(key,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IntWritable(average));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">这句话很关键</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conf.set(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;mapred.job.tracker&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;192.168.1.2:9001&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] ioArgs =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String[] {&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;score_in&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;score_out&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;};</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] otherArgs =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;GenericOptionsParser(conf, ioArgs).getRemainingArgs();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(otherArgs.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">length<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;!= 2) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">err</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Usage: Score Average &lt;in&gt; &lt;out&gt;&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(2);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Job job =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Job(conf,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Score Average&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setJarByClass(Score.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">、</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Combine</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">和</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">处理类</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setMapperClass(Map.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setCombinerClass(Reduce.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setReducerClass(Reduce.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置输出类型</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputKeyClass(Text.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputValueClass(IntWritable.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">将输入的数据集分割成小数据块</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; text-decoration: underline;">splites</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，提供一个</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">RecordReder</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的实现</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setInputFormatClass(TextInputFormat.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">提供一个</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">RecordWriter</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的实现，负责数据输出</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputFormatClass(TextOutputFormat.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置输入和输出目录</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileInputFormat.<em style="margin: 0px; padding: 0px;">addInputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[0]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileOutputFormat.<em style="margin: 0px; padding: 0px;">setOutputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[1]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(job.waitForCompletion(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">true</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) ? 0 : 1);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	3.4 代码结果</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）准备测试数据</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 通过Eclipse下面的&quot;DFS Locations&quot;在&quot;/user/hadoop&quot;目录下创建输入文件&quot;score_in&quot;文件夹（<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">备注</strong></span>：&quot;score_out&quot;不需要创建。）如图3.4-1所示，已经成功创建。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342225N2-10.png" style="margin: 0px; padding: 0px; border: 0px;" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<img alt="" src="/uploads/allimg/151125/1342221420-11.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图3.4-1 创建&quot;score_in&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;图3.4.2 上传三门分数</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 然后在本地建立三个txt文件，通过Eclipse上传到&quot;/user/hadoop/score_in&quot;文件夹中，三个txt文件的内容如&quot;实例描述&quot;那三个文件一样。如图3.4-2所示，成功上传之后。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">备注</strong></span>：文本文件的编码为&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">UTF-8</strong></span>&quot;，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">默认</strong></span>为&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">ANSI</strong></span>&quot;，可以<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">另存为</strong></span>时选择，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">不然中文会出现乱码</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 从SecureCRT远处查看&quot;Master.Hadoop&quot;的也能证实我们上传的三个文件。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342224048-12.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	查看三个文件的内容如图3.4-3所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342225930-13.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图3.4.3 三门成绩的内容</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）查看运行结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 这时我们<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">右击</strong></span>Eclipse的&quot;DFS Locations&quot;中&quot;/user/hadoop&quot;文件夹进行刷新，这时会发现多出一个&quot;score_out&quot;文件夹，且里面有3个文件，然后打开双其&quot;part-r-00000&quot;文件，会在Eclipse中间把内容显示出来。如图3.4-4所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342223344-14.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图3.4-4 运行结果</p>
<h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	4、单表关联</h2>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 前面的实例都是在数据上进行一些简单的处理，为进一步的操作打基础。&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">单表关联</strong></span>&quot;这个实例<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">要求</strong></span>从<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">给出的数据</strong></span>中<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">寻找</strong></span>所<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">关心的数据</strong></span>，它是对<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">原始数据</strong></span>所包含信息的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">挖掘</strong></span>。下面进入这个实例。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	4.1 实例描述</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 实例中给出<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">child-parent</strong></span>（孩子&mdash;&mdash;父母）表，要求输出<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">grandchild-grandparent</strong></span>（孙子&mdash;&mdash;爷奶）表。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 样例<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">输入</strong></span>如下所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">file：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">child&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parent</span></p>
	<p style="margin: 10px auto; padding: 0px;">
		Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Lucy</p>
	<p style="margin: 10px auto; padding: 0px;">
		Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Jack</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Lucy</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Jack</p>
	<p style="margin: 10px auto; padding: 0px;">
		Lucy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mary</p>
	<p style="margin: 10px auto; padding: 0px;">
		Lucy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ben</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jack&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alice</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jack&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Jesse</p>
	<p style="margin: 10px auto; padding: 0px;">
		Terry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alice</p>
	<p style="margin: 10px auto; padding: 0px;">
		Terry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Jesse</p>
	<p style="margin: 10px auto; padding: 0px;">
		Philip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Terry</p>
	<p style="margin: 10px auto; padding: 0px;">
		Philip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alma</p>
	<p style="margin: 10px auto; padding: 0px;">
		Mark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Terry</p>
	<p style="margin: 10px auto; padding: 0px;">
		Mark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alma</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 家族<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">树状</strong></span>关系谱：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;<a href="http://images.cnblogs.com/cnblogs_com/xia520pi/201206/201206041339478410.png" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(51, 51, 51);"><img alt="image" border="0" height="196" src="/uploads/allimg/151125/1342221045-15.png" style="margin: 0px; padding: 0px; border: 0px; display: inline; background-image: none;" title="image" width="552" /></a></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图4.2-1 家族谱</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 样例输出如下所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">file：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">grandchild&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grandparent</span></p>
	<p style="margin: 10px auto; padding: 0px;">
		Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　Alice</p>
	<p style="margin: 10px auto; padding: 0px;">
		Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　Jesse</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　Alice</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　 Jesse</p>
	<p style="margin: 10px auto; padding: 0px;">
		Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　Mary</p>
	<p style="margin: 10px auto; padding: 0px;">
		Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　Ben</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　 Mary</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　 Ben</p>
	<p style="margin: 10px auto; padding: 0px;">
		Philip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　&nbsp; Alice</p>
	<p style="margin: 10px auto; padding: 0px;">
		Philip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　Jesse</p>
	<p style="margin: 10px auto; padding: 0px;">
		Mark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　 Alice</p>
	<p style="margin: 10px auto; padding: 0px;">
		Mark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　 Jesse</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	4.2 设计思路</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 分析这个实例，显然需要进行单表连接，连接的是<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">左表</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">parent</strong></span>列和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">右表</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">child</strong></span>列，且<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">左表</strong></span>和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">右表</strong></span>是<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">同一个表</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">　　连接结果</strong></span>中<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">除去</strong></span>连接的两列就是所需要的结果&mdash;&mdash;&quot;grandchild--grandparent&quot;表。要用MapReduce解决这个实例，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">首先</strong></span>应该考虑如何实现<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">表</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">自连接</strong></span>；<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">其次</strong></span>就是<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">连接列</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">设置</strong></span>；<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">最后</strong></span>是<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">结果</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">整理</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 考虑到MapReduce的shuffle过程会将相同的key会连接在一起，所以可以将map结果的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">key</strong></span>设置成<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">待连接</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">列</strong></span>，然后列中相同的值就自然会连接在一起了。再与最开始的分析联系起来：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　要连接的是左表的parent列和右表的child列，且左表和右表是同一个表，所以在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">map阶段</strong></span>将<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">读入数据<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">分割</span></strong>成<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">child</strong></span>和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">parent</strong></span>之后，会将<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">parent</strong></span>设置成<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">key</strong></span>，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">child</strong></span>设置成<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">value</strong></span>进行输出，并作为<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">左表</strong></span>；</span>再将<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">同一对<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">child</span></strong>和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">parent</strong></span>中的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">child</strong></span>设置成<strong style="margin: 0px; padding: 0px;">key</strong></span>，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">parent</strong></span>设置成<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">value</strong></span>进行输出，作为<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">右表</strong></span>。为了<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">区分</strong></span>输出中的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">左右表</strong></span>，需要在输出的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">value</strong></span>中<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">再</strong></span>加上<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">左右表</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">信息</strong></span>，比如在value的String最开始处加上<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">字符1</strong></span>表示<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">左表</strong></span>，加上<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">字符2</strong></span>表示<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">右表</strong></span>。这样在map的结果中就形成了左表和右表，然后在shuffle过程中完成连接。reduce接收到连接的结果，其中每个key的value-list就包含了&quot;grandchild--grandparent&quot;关系。取出每个key的value-list进行解析，将<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">左表</strong></span>中的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">child</strong></span>放入一个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">数组</strong></span>，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">右表</strong></span>中的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">parent</strong></span>放入一个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">数组</strong></span>，然后对<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">两个数组求笛卡尔积</strong></span>就是最后的结果了。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	4.3 程序代码</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 程序代码如下所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.mr;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;java.io.IOException;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;java.util.*;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; text-decoration: underline;">org.apache.hadoop.io.IntWritable</span>;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.io.Text;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Job;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Mapper;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Reducer;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.util.GenericOptionsParser;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;STjoin {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">time</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;= 0;</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">/*</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp; * map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">将输出分割</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">child</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">和</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">parent</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，然后正序输出一次作为右表，</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">反序输出一次作为左表，需要注意的是在输出的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">value</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">中必须</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">加上左右表的区别标识。</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">&nbsp;&nbsp;&nbsp;&nbsp; */</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Map&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Mapper&lt;Object, Text, Text, Text&gt; {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;map(Object key, Text value, Context context)</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException, InterruptedException {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String childname =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String();<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">孩子名称</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String parentname =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String();<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">父母名称</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String relationtype =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String();<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">左右表标识</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输入的一行预处理文本</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringTokenizer itr=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;StringTokenizer(value.toString());</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] values=<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String[2];</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;i=0;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">while</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">(itr.hasMoreTokens()){</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; values[i]=itr.nextToken();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(values[0].compareTo(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;child&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) != 0) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; childname = values[0];</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parentname = values[1];</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输出左表</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relationtype =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;1&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(values[1]),&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(relationtype +</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;+&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+ childname +&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;+&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;+ parentname));</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输出右表</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relationtype =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;2&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(values[0]),&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(relationtype +</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;+&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+ childname +&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;+&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;+ parentname));</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Reduce&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Reducer&lt;Text, Text, Text, Text&gt; {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;reduce(Text key, Iterable&lt;Text&gt; values, Context context)</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException, InterruptedException {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输出表头</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(0 ==&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">time</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;">context.write(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;grandchild&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">),&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;grandparent&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">));</span></span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">time</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">++;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;grandchildnum = 0;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] grandchild =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String[10];</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;grandparentnum = 0;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] grandparent =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String[10];</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; text-decoration: underline;">Iterator</span>&nbsp;ite = values.iterator();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">while</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(ite.hasNext()) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String record = ite.next().toString();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;len = record.length();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;i = 2;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(0 == len) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">continue</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">取得左右表标识</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">char</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;relationtype = record.charAt(0);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">定义孩子和父母变量</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String childname =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String parentname =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">获取</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">value-list</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">中</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">value</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">child</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">while</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(record.charAt(i) !=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&#39;+&#39;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; childname += record.charAt(i);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i = i + 1;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">获取</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">value-list</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">中</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">value</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">parent</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">while</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(i &lt; len) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parentname += record.charAt(i);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">左表，取出</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">child</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">放入</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; text-decoration: underline;">grandchildren</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&#39;1&#39;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;== relationtype) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grandchild[grandchildnum] = childname;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grandchildnum++;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">右表<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">，取出</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">parent</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">放入</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">grandparent</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&#39;2&#39;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;== relationtype) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grandparent[grandparentnum] = parentname;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grandparentnum++;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; text-decoration: underline;">grandchild</span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">和</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">grandparent</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">数组求笛卡尔儿积</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(0 != grandchildnum &amp;&amp; 0 != grandparentnum) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">for</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;m = 0; m &lt; grandchildnum; m++) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">for</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;n = 0; n &lt; grandparentnum; n++) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输出结果</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(grandchild[m]),&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(grandparent[n]));</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">这句话很关键</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conf.set(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;mapred.job.tracker&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;192.168.1.2:9001&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] ioArgs =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String[] {&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;STjoin_in&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;STjoin_out&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;};</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] otherArgs =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;GenericOptionsParser(conf, ioArgs).getRemainingArgs();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(otherArgs.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">length<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;!= 2) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">err</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Usage: Single Table Join &lt;in&gt; &lt;out&gt;&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(2);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Job job =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Job(conf,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Single Table Join&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setJarByClass(STjoin.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">和</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">处理类</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setMapperClass(Map.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setReducerClass(Reduce.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置输出类型</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputKeyClass(Text.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputValueClass(Text.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置输入和输出目录</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileInputFormat.<em style="margin: 0px; padding: 0px;">addInputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[0]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileOutputFormat.<em style="margin: 0px; padding: 0px;">setOutputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[1]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(job.waitForCompletion(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">true</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) ? 0 : 1);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	4.4 代码结果</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）准备测试数据</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 通过Eclipse下面的&quot;DFS Locations&quot;在&quot;/user/hadoop&quot;目录下创建输入文件&quot;STjoin_in&quot;文件夹（<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">备注</strong></span>：&quot;STjoin_out&quot;不需要创建。）如图4.4-1所示，已经成功创建。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342223D9-16.png" style="margin: 0px; padding: 0px; border: 0px;" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<img alt="" src="/uploads/allimg/151125/1342223095-17.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图4.4-1 创建&quot;STjoin_in&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 图4.4.2 上传&quot;child-parent&quot;表</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 然后在本地建立一个txt文件，通过Eclipse上传到&quot;/user/hadoop/STjoin_in&quot;文件夹中，一个txt文件的内容如&quot;实例描述&quot;那个文件一样。如图4.4-2所示，成功上传之后。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 从SecureCRT远处查看&quot;Master.Hadoop&quot;的也能证实我们上传的文件，显示其内容如图4.4-3所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342221615-18.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图4.4-3 表&quot;child-parent&quot;内容</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）运行详解</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 204, 255);"><strong style="margin: 0px; padding: 0px;">（1）Map处理：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; map函数输出结果如下所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		child&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 忽略此行</p>
	<p style="margin: 10px auto; padding: 0px;">
		Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Lucy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Lucy，1+Tom+Lucy&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　&lt;Tom，2+Tom+Lucy &gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Jack&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Jack，1+Tom+Jack&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　&lt;Tom，2+Tom+Jack&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Lucy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Lucy，1+Jone+Lucy&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　&lt;Jone，2+Jone+Lucy&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Jack&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Jack，1+Jone+Jack&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　&lt;Jone，2+Jone+Jack&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Lucy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Mary，1+Lucy+Mary&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　&lt;Lucy，2+Lucy+Mary&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Lucy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ben&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Ben，1+Lucy+Ben&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　　&lt;Lucy，2+Lucy+Ben&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jack&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alice&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Alice，1+Jack+Alice&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　　　&lt;Jack，2+Jack+Alice&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Jack&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Jesse&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Jesse，1+Jack+Jesse&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　　　&lt;Jack，2+Jack+Jesse&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Terry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alice&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Alice，1+Terry+Alice&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　　　&lt;Terry，2+Terry+Alice&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Terry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Jesse&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Jesse，1+Terry+Jesse&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　　　&lt;Terry，2+Terry+Jesse&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Philip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Terry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Terry，1+Philip+Terry&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　　　&lt;Philip，2+Philip+Terry&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Philip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alma&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Alma，1+Philip+Alma&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　　　&lt;Philip，2+Philip+Alma&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Mark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Terry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Terry，1+Mark+Terry&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　　　&lt;Mark，2+Mark+Terry&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Mark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alma&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: wingdings;">&agrave;&agrave;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Alma，1+Mark+Alma&gt;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　　　&lt;Mark，2+Mark+Alma&gt;</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 204, 255);"><strong style="margin: 0px; padding: 0px;">（2）Shuffle处理</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 在shuffle过程中完成连接。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<div style="margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<table border="0" style="margin: 0px; padding: 0px; border-style: solid; border-color: silver; border-collapse: collapse; word-break: break-word;">
		<colgroup style="margin: 0px; padding: 0px;">
			<col style="margin: 0px; padding: 0px; width: 189px;" />
			<col style="margin: 0px; padding: 0px; width: 189px;" />
			<col style="margin: 0px; padding: 0px; width: 189px;" />
		</colgroup>
		<tbody style="margin: 0px; padding: 0px;" valign="top">
			<tr style="margin: 0px; padding: 0px; background: rgb(224, 224, 224);">
				<td style="margin: 0px; padding: 3px 7px; border-width: 1.5pt 0.75pt 1.5pt 1.5pt; border-style: solid; border-color: initial; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数输出</span></strong></span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-top-width: 1.5pt; border-right-width: 0.75pt; border-bottom-width: 1.5pt; border-style: solid solid solid none; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 10pt;"><strong style="margin: 0px; padding: 0px;">排序结果</strong></span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-top-width: 1.5pt; border-right-width: 1.5pt; border-bottom-width: 1.5pt; border-style: solid solid solid none; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">shuffle</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">连接</span></strong></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 1.5pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Tom+Lucy&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Tom</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Tom+Lucy&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Tom+Jack&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Tom</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Tom+Jack&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jone+Lucy&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jone</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Jone+Lucy&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jone+Jack&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jone</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Jone+Jack&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Mary</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Lucy+Mary&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Lucy+Mary&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Ben</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Lucy+Ben&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Lucy+Ben&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jack+Alice&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Jack+Alice&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jesse</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jack+Jesse&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Jack+Jesse&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Terry+Alice&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Terry+Alice&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jesse</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Terry+Jesse&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Terry+Jesse&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Philip+Terry&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Philip</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Philip+Terry&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Alma</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Philip+Alma&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Philip</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Philip+Alma&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Mark+Terry&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Mark</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Mark+Terry&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Alma</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Mark+Alma&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Mark</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Mark+Alma&gt;</span></span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 1.5pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jack+Alice&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Terry+Alice&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Alma</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Philip+Alma&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Alma</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Mark+Alma&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Ben</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Lucy+Ben&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Tom+Jack&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jone+Jack&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Jack+Alice&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Jack+Jesse&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jesse</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jack+Jesse&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jesse</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Terry+Jesse&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jone</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Jone+Lucy&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jone</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Jone+Jack&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Tom+Lucy&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jone+Lucy&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Lucy+Mary&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Lucy+Ben&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Mary</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Lucy+Mary&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Mark</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Mark+Terry&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Mark</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Mark+Alma&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Philip</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Philip+Terry&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Philip</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Philip+Alma&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Terry+Alice&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Terry+Jesse&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Philip+Terry&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Mark+Terry&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Tom</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Tom+Lucy&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Tom</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Tom+Jack&gt;</span></span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 1.5pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jack+Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Terry+Alice&nbsp;</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Philip+Alma</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Mark+Alma &gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Ben</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Lucy+Ben&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Tom+Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Jone+Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Jack+Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Jack+Jesse &gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jesse</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jack+Jesse</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Terry+Jesse &gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jone</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Jone+Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Jone+Jack&gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Tom+Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Jone+Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Lucy+Mary</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Lucy+Ben&gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Mary</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Lucy+Mary</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Mark+Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Mark+Alma&gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Philip</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Philip+Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Philip+Alma&gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Terry+Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Terry+Jesse</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Philip+Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Mark+Terry&gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Tom</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Tom+Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Tom+Jack&gt;</span></p>
				</td>
			</tr>
		</tbody>
	</table>
</div>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 204, 255);"><strong style="margin: 0px; padding: 0px;">（3）Reduce处理</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">首先</strong></span>由语句&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">0 != grandchildnum &amp;&amp; 0 != grandparentnum</strong></span>&quot;得知，只要在&quot;value-list&quot;中没有左表或者右表，则不会做处理，可以根据这条规则去除<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">无效</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">shuffle连接</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<div style="margin: 0px 0px 0px 41pt; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<table border="0" style="margin: 0px; padding: 0px; border-style: solid; border-color: silver; border-collapse: collapse; word-break: break-word;">
		<colgroup style="margin: 0px; padding: 0px;">
			<col style="margin: 0px; padding: 0px; width: 243px;" />
			<col style="margin: 0px; padding: 0px; width: 254px;" />
		</colgroup>
		<tbody style="margin: 0px; padding: 0px;" valign="top">
			<tr style="margin: 0px; padding: 0px; height: 18px; background: rgb(224, 224, 224);">
				<td style="margin: 0px; padding: 3px 7px; border-width: 1.5pt 0.75pt 1.5pt 1.5pt; border-style: solid; border-color: initial; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; color: red;">无效</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">shuffle</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">连接</span></strong></span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-top-width: 1.5pt; border-right-width: 1.5pt; border-bottom-width: 1.5pt; border-style: solid solid solid none; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; color: blue;">有效</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">shuffle</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">连接</span></strong></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px; height: 278px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 1.5pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jack+Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Terry+Alice&nbsp;</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Philip+Alma</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Mark+Alma &gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Ben</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Lucy+Ben&gt;</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jesse</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Jack+Jesse</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Terry+Jesse &gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jone</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Jone+Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Jone+Jack&gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Mary</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Lucy+Mary</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Mark+Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Mark+Alma&gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Philip</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Philip+Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Philip+Alma&gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Tom</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Tom+Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Tom+Jack&gt;</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 1.5pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Tom+Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Jone+Jack</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Jack+Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Jack+Jesse &gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">1+Tom+Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Jone+Lucy</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Lucy+Mary</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Lucy+Ben&gt;</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&lt;Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">2+Terry+Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Terry+Jesse</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Philip+Terry</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">，</span></span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Mark+Terry&gt;</span></p>
				</td>
			</tr>
		</tbody>
	</table>
</div>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 然后根据下面语句进一步对有效的shuffle连接做处理。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		// 左表，取出child放入grandchildren</p>
	<p style="margin: 10px auto; padding: 0px;">
		if (&#39;1&#39; == relationtype) {</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp; grandchild[grandchildnum] = childname;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp; grandchildnum++;</p>
	<p style="margin: 10px auto; padding: 0px;">
		}</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		// 右表，取出parent放入grandparent</p>
	<p style="margin: 10px auto; padding: 0px;">
		if (&#39;2&#39; == relationtype) {</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp; grandparent[grandparentnum] = parentname;</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp; grandparentnum++;</p>
	<p style="margin: 10px auto; padding: 0px;">
		}</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 针对一条数据进行分析：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		&lt;Jack，1+Tom+Jack，</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1+Jone+Jack，</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Jack+Alice，</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2+Jack+Jesse &gt;</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">分析结果</strong></span>：<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">左表</strong></span>用&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">字符1</strong></span>&quot;表示，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">右表</strong></span>用&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">字符2</strong></span>&quot;表示，上面的&lt;key，value-list&gt;中的&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">key</strong></span>&quot;表示<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">左表与右表</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">连接键</strong></span>。而&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">value-list</strong></span>&quot;表示<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">以&quot;key&quot;连接</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">左表与右表</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">相关数据</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 根据上面针对左表与右表不同的处理规则，取得两个数组的数据如下所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<div style="margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<table border="0" style="margin: 0px; padding: 0px; border-style: solid; border-color: silver; border-collapse: collapse; word-break: break-word;">
		<colgroup style="margin: 0px; padding: 0px;">
			<col style="margin: 0px; padding: 0px; width: 97px;" />
			<col style="margin: 0px; padding: 0px; width: 379px;" />
		</colgroup>
		<tbody style="margin: 0px; padding: 0px;" valign="top">
			<tr style="margin: 0px; padding: 0px; height: 20px;">
				<td style="margin: 0px; padding: 3px 7px; border-width: 1.5pt 0.75pt 0.75pt 1.5pt; border-style: solid; border-color: initial; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">grandchild</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-top-width: 1.5pt; border-right-width: 1.5pt; border-bottom-width: 0.75pt; border-style: solid solid solid none; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Tom</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">、</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Jone</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">（</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; color: rgb(51, 102, 255);">grandchild[grandchildnum] = childname;</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">）</span></span></p>
				</td>
			</tr>
			<tr style="margin: 0px; padding: 0px; height: 20px;">
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 0.75pt; border-bottom-width: 1.5pt; border-left-width: 1.5pt; border-style: none solid solid; border-top-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">grandparent</span></p>
				</td>
				<td style="margin: 0px; padding: 3px 7px; border-right-width: 1.5pt; border-bottom-width: 1.5pt; border-style: none solid solid none; border-top-color: silver; border-left-color: silver; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Alice</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">、</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman';">Jesse</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">（</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; color: rgb(51, 102, 255);">grandparent[grandparentnum] = parentname;</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">）</span></span></p>
				</td>
			</tr>
		</tbody>
	</table>
</div>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 然后根据下面语句进行处理。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		for (int m = 0; m &lt; grandchildnum; m++) {</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp; for (int n = 0; n &lt; grandparentnum; n++) {</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(new Text(grandchild[m]), new Text(grandparent[n]));</p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;&nbsp;&nbsp; }</p>
	<p style="margin: 10px auto; padding: 0px;">
		}</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<a href="http://images.cnblogs.com/cnblogs_com/xia520pi/201206/201206041339474440.png" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(51, 51, 51);"><img alt="image" border="0" height="116" src="/uploads/allimg/151125/1342225406-19.png" style="margin: 0px; padding: 0px; border: 0px; background-image: none;" title="image" width="244" /></a>&nbsp;&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	处理结果如下面所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<div style="margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<table border="0" style="margin: 0px; padding: 0px; border-style: solid; border-color: silver; border-collapse: collapse; word-break: break-word;">
		<colgroup style="margin: 0px; padding: 0px;">
			<col style="margin: 0px; padding: 0px; width: 199px;" />
		</colgroup>
		<tbody style="margin: 0px; padding: 0px;" valign="top">
			<tr style="margin: 0px; padding: 0px;">
				<td style="margin: 0px; padding: 3px 7px; border: 1.5pt solid; border-collapse: collapse;">
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Jesse</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alice</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">Jone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Jesse</span></p>
					<p style="margin: 10px auto; padding: 0px; text-align: justify;">
						<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 'times new roman'; font-size: 10pt;">Jone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alice</span></p>
				</td>
			</tr>
		</tbody>
	</table>
</div>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 其他的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">有效shuffle连接</strong></span>处理<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">都是如此</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">3）查看运行结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 这时我们<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">右击</strong></span>Eclipse的&quot;DFS Locations&quot;中&quot;/user/hadoop&quot;文件夹进行刷新，这时会发现多出一个&quot;STjoin_out&quot;文件夹，且里面有3个文件，然后打开双其&quot;part-r-00000&quot;文件，会在Eclipse中间把内容显示出来。如图4.4-4所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/134222NX-20.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图4.4-4 运行结果</p>
<h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	5、多表关联</h2>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">多表</strong></span>关联和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">单表</strong></span>关联<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">类似</strong></span>，它也是通过对原始数据进行一定的处理，从其中挖掘出关心的信息。下面进入这个实例。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	5.1 实例描述</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 输入是两个文件，一个代表<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">工厂表</strong></span>，包含<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">工厂名</strong></span>列和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">地址编号</strong></span>列；另一个代表<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">地址表</strong></span>，包含<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">地址名</strong></span>列和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">地址编号</strong></span>列。要求从<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">输入数据</strong></span>中找出<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">工厂名</strong></span>和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">地址名</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">对应关系</strong></span>，输出&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">工厂名&mdash;&mdash;地址名</strong></span>&quot;表。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 样例<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">输入</strong></span>如下所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）factory：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">factoryname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　addressed</strong></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		Beijing Red Star&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　1</p>
	<p style="margin: 10px auto; padding: 0px;">
		Shenzhen Thunder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　3</p>
	<p style="margin: 10px auto; padding: 0px;">
		Guangzhou Honda&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　2</p>
	<p style="margin: 10px auto; padding: 0px;">
		Beijing Rising&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　1</p>
	<p style="margin: 10px auto; padding: 0px;">
		Guangzhou Development Bank&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2</p>
	<p style="margin: 10px auto; padding: 0px;">
		Tencent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　3</p>
	<p style="margin: 10px auto; padding: 0px;">
		Back of Beijing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　 1</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）address：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">addressID&nbsp;&nbsp;&nbsp; addressname</strong></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　Beijing</p>
	<p style="margin: 10px auto; padding: 0px;">
		2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　Guangzhou</p>
	<p style="margin: 10px auto; padding: 0px;">
		3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　Shenzhen</p>
	<p style="margin: 10px auto; padding: 0px;">
		4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　Xian</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 样例<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">输出</strong></span>如下所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">factoryname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　addressname</strong></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		Back of Beijing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　&nbsp; Beijing</p>
	<p style="margin: 10px auto; padding: 0px;">
		Beijing Red Star&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　Beijing</p>
	<p style="margin: 10px auto; padding: 0px;">
		Beijing Rising&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　 Beijing</p>
	<p style="margin: 10px auto; padding: 0px;">
		Guangzhou Development Bank&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Guangzhou</p>
	<p style="margin: 10px auto; padding: 0px;">
		Guangzhou Honda&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　Guangzhou</p>
	<p style="margin: 10px auto; padding: 0px;">
		Shenzhen Thunder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　Shenzhen</p>
	<p style="margin: 10px auto; padding: 0px;">
		Tencent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　Shenzhen</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	5.2 设计思路</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 多表关联和单表关联相似，都类似于<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">数据库</strong></span>中的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">自然连接</strong></span>。相比单表关联，多表关联的左右表和连接列更加清楚。所以可以采用和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">单表</strong></span>关联的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">相同</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">处理方式</strong></span>，map识别出输入的行属于哪个表之后，对其进行分割，将<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">连接的列值</strong></span>保存在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">key</strong></span>中，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">另一列</strong></span>和左右表<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">标识</strong></span>保存在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">value</strong></span>中，然后输出。reduce拿到连接结果之后，解析value内容，根据标志将左右表内容分开存放，然后求<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">笛卡尔积</strong></span>，最后直接输出。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 这个实例的具体分析参考单表关联实例。下面给出代码。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	5.3 程序代码</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 程序代码如下所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.mr;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;java.io.IOException;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;java.util.*;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; text-decoration: underline;">org.apache.hadoop.io.IntWritable</span>;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.io.Text;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Job;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Mapper;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Reducer;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.util.GenericOptionsParser;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;MTjoin {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">time</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;= 0;</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">/*</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">在</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">中先区分输入行属于左表还是右表，然后对两列值进行分割，</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">保存连接列在</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">key</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">值，剩余列和左右表标志在</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">value</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">中，最后输出</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">&nbsp;&nbsp;&nbsp;&nbsp; */</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Map&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Mapper&lt;Object, Text, Text, Text&gt; {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;map(Object key, Text value, Context context)</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException, InterruptedException {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String line = value.toString();<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">每行文件</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String relationtype =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String();<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">左右表标识</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输入文件首行，不处理</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(line.contains(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;factoryname&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) ==&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">true</strong></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; || line.contains(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;addressed&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) ==&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">true</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">return</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输入的一行预处理文本</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringTokenizer itr =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;StringTokenizer(line);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String mapkey =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String mapvalue =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;i = 0;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">while</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(itr.hasMoreTokens()) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">先读取一个单词</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String token = itr.nextToken();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">判断该地址</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">ID</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">就把存到</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&quot;values[0]&quot;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(token.charAt(0) &gt;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&#39;0&#39;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&amp;&amp; token.charAt(0) &lt;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&#39;9&#39;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) {</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mapkey = token;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(i &gt; 0) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relationtype =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;1&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">else</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;{</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relationtype =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;2&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">continue</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">存工厂名</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mapvalue += token +&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot; &quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输出左右表</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(mapkey),&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(relationtype +&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;+&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">+ mapvalue));</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">/*</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp; * reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">解析</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输出，将</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">value</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">中数据按照左右表分别保存，</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">　　*&nbsp;</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">然后求出笛卡尔积，并输出。</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">&nbsp;&nbsp;&nbsp;&nbsp; */</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Reduce&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Reducer&lt;Text, Text, Text, Text&gt; {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;reduce(Text key, Iterable&lt;Text&gt; values, Context context)</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException, InterruptedException {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输出表头</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(0 ==&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">time</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 10pt;">context.write(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;factoryname&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">),&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;addressname&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">));</span></span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">time</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">++;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;factorynum = 0;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] factory =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String[10];</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;addressnum = 0;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[]&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; background-color: yellow;">address</span>&nbsp;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String[10];</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; text-decoration: underline;">Iterator</span>&nbsp;ite = values.iterator();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">while</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(ite.hasNext()) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String record = ite.next().toString();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;len = record.length();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;i = 2;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(0 == len) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">continue</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">取得左右表标识</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">char</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;relationtype = record.charAt(0);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">左表</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&#39;1&#39;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;== relationtype) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; factory[factorynum] = record.substring(i);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; factorynum++;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">右表</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&#39;2&#39;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;== relationtype) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; background-color: silver;">address</span>[addressnum] = record.substring(i);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; addressnum++;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">求笛卡尔积</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(0 != factorynum &amp;&amp; 0 != addressnum) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">for</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;m = 0; m &lt; factorynum; m++) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">for</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;n = 0; n &lt; addressnum; n++) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输出结果</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(factory[m]),</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text(<span style="margin: 0px; padding: 0px; line-height: 1.8; background-color: silver;">address</span>[n]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">这句话很关键</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conf.set(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;mapred.job.tracker&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;192.168.1.2:9001&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] ioArgs =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String[] {&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;MTjoin_in&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;MTjoin_out&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;};</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] otherArgs =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;GenericOptionsParser(conf, ioArgs).getRemainingArgs();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(otherArgs.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">length<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;!= 2) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">err</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Usage: Multiple Table Join &lt;in&gt; &lt;out&gt;&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(2);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Job job =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Job(conf,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Multiple Table Join&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setJarByClass(MTjoin.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">和</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">处理类</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setMapperClass(Map.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setReducerClass(Reduce.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置输出类型</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputKeyClass(Text.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputValueClass(Text.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置输入和输出目录</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileInputFormat.<em style="margin: 0px; padding: 0px;">addInputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[0]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileOutputFormat.<em style="margin: 0px; padding: 0px;">setOutputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[1]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(job.waitForCompletion(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">true</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) ? 0 : 1);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	5.4 代码结果</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）准备测试数据</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 通过Eclipse下面的&quot;DFS Locations&quot;在&quot;/user/hadoop&quot;目录下创建输入文件&quot;MTjoin_in&quot;文件夹（<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">备注</strong></span>：&quot;MTjoin_out&quot;不需要创建。）如图5.4-1所示，已经成功创建。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342223T4-21.png" style="margin: 0px; padding: 0px; border: 0px;" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<img alt="" src="/uploads/allimg/151125/1342224a0-22.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5.4-1 创建&quot;MTjoin_in&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;图5.4.2 上传两个数据表</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 然后在本地建立两个txt文件，通过Eclipse上传到&quot;/user/hadoop/MTjoin_in&quot;文件夹中，两个txt文件的内容如&quot;实例描述&quot;那两个文件一样。如图5.4-2所示，成功上传之后。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 从SecureCRT远处查看&quot;Master.Hadoop&quot;的也能证实我们上传的两个文件。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342225U5-23.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5.4.3 两个数据表的内容</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）查看运行结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 这时我们<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">右击</strong></span>Eclipse的&quot;DFS Locations&quot;中&quot;/user/hadoop&quot;文件夹进行刷新，这时会发现多出一个&quot;MTjoin_out&quot;文件夹，且里面有3个文件，然后打开双其&quot;part-r-00000&quot;文件，会在Eclipse中间把内容显示出来。如图5.4-4所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/134222L25-24.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图5.4-4 运行结果</p>
<h2 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 21px; border-radius: 4px; clear: both; line-height: 1.8; background: rgb(25, 163, 213);">
	6、倒排索引</h2>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; &quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">倒排索引</strong></span>&quot;是<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">文档检索系统</strong></span>中<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">最常用</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">数据结构</strong></span>，被广泛地应用于<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">全文搜索引擎</strong></span>。它<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">主要</strong></span>是用来<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">存储</strong></span>某个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">单词（或词组）<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;">在</span></strong>一个<strong style="margin: 0px; padding: 0px;">文档或一组文档</strong></span>中的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">存储位置</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">映射</strong></span>，即提供了一种<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">根据内容来查找文档</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">方式</strong></span>。由于不是根据文档来确定文档所包含的内容，而是进行相反的操作，因而称为倒排索引（Inverted Index）。</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.1 实例描述</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 通常情况下，倒排索引由一个单词（或词组）以及相关的文档列表组成，文档列表中的文档或者是标识文档的ID号，或者是指文档所在位置的URL，如图6.1-1所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;<a href="http://images.cnblogs.com/cnblogs_com/xia520pi/201206/201206041339489358.png" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(51, 51, 51);"><img alt="image" border="0" height="226" src="/uploads/allimg/151125/1342225558-25.png" style="margin: 0px; padding: 0px; border: 0px; display: inline; background-image: none;" title="image" width="488" /></a></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6.1-1 倒排索引结构</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 从图6.1-1可以看出，单词1出现在{文档1，文档4，文档13，&hellip;&hellip;}中，单词2出现在{文档3，文档5，文档15，&hellip;&hellip;}中，而单词3出现在{文档1，文档8，文档20，&hellip;&hellip;}中。在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">实际应用</strong></span>中，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">还需要</strong></span>给<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">每个文档</strong></span>添加一个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">权值</strong></span>，用来<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">指出</strong></span>每个文档与搜索内容的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">相关度</strong></span>，如图6.1-2所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;<a href="http://images.cnblogs.com/cnblogs_com/xia520pi/201206/201206041339495704.png" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(51, 51, 51);"><img alt="image" border="0" height="235" src="/uploads/allimg/151125/1342226216-26.png" style="margin: 0px; padding: 0px; border: 0px; display: inline; background-image: none;" title="image" width="599" /></a></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6.1-2 添加权重的倒排索引</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 最常用的是使用<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">词频</strong></span>作为<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">权重</strong></span>，即记录单词在文档中出现的次数。以英文为例，如图6.1-3所示，索引文件中的&quot;MapReduce&quot;一行表示：&quot;MapReduce&quot;这个单词在文本T0中出现过1次，T1中出现过1次，T2中出现过2次。当搜索条件为&quot;MapReduce&quot;、&quot;is&quot;、&quot;Simple&quot;时，对应的集合为：{T0，T1，T2}&cap;{T0，T1}&cap;{T0，T1}={T0，T1}，即文档T0和T1包含了所要索引的单词，而且只有T0是连续的。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;<a href="http://images.cnblogs.com/cnblogs_com/xia520pi/201206/201206041339495081.png" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(51, 51, 51);"><img alt="image" border="0" height="262" src="/uploads/allimg/151125/1342222M4-27.png" style="margin: 0px; padding: 0px; border: 0px; display: inline; width: 846px; background-image: none;" title="image" width="890" /></a></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6.1-3 倒排索引示例</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 更复杂的权重还可能要记录单词在多少个文档中出现过，以实现TF-IDF（Term Frequency-Inverse Document Frequency）算法，或者考虑单词在文档中的位置信息（单词是否出现在标题中，反映了单词在文档中的重要性）等。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 样例<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">输入</strong></span>如下所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）file1：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		MapReduce is simple</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）file2：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		MapReduce is powerful is simple</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">3）file3：</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		Hello MapReduce bye MapReduce</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 样例<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">输出</strong></span>如下所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		MapReduce&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; file1.txt:1;file2.txt:1;file3.txt:2;</p>
	<p style="margin: 10px auto; padding: 0px;">
		is&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　file1.txt:1;file2.txt:2;</p>
	<p style="margin: 10px auto; padding: 0px;">
		simple&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　&nbsp; file1.txt:1;file2.txt:1;</p>
	<p style="margin: 10px auto; padding: 0px;">
		powerful&nbsp;&nbsp;&nbsp;　　 file2.txt:1;</p>
	<p style="margin: 10px auto; padding: 0px;">
		Hello&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　 file3.txt:1;</p>
	<p style="margin: 10px auto; padding: 0px;">
		bye&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　&nbsp;&nbsp; file3.txt:1;</p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.2 设计思路</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 实现&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">倒排索引</strong></span>&quot;只要关注的信息为：<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">单词</strong></span>、<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">文档URL</strong></span>及<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">词频</strong></span>，如图3-11所示。但是在实现过程中，索引文件的格式与图6.1-3会略有所不同，以避免重写OutPutFormat类。下面根据<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">MapReduce的处理过程</strong></span>给出<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">倒排索引</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">设计思路</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）Map过程</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 首先使用默认的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">TextInputFormat</strong></span>类对<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">输入文件</strong></span>进行处理，得到文本中<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">每行</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">偏移量</strong></span>及其<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">内容</strong></span>。显然，Map过程首先必须分析输入的&lt;key,value&gt;对，得到倒排索引中需要的三个信息：单词、文档URL和词频，如图6.2-1所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;<a href="http://images.cnblogs.com/cnblogs_com/xia520pi/201206/201206041339508047.png" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(51, 51, 51);"><img alt="image" border="0" height="370" src="/uploads/allimg/151125/134222KV-28.png" style="margin: 0px; padding: 0px; border: 0px; display: inline; background-image: none;" title="image" width="741" /></a></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6.2-1 Map过程输入/输出</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　这里<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">存在</strong></span>两个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">问题</strong></span>：<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">第一</strong></span>，&lt;key,value&gt;对只能有两个值，在不使用Hadoop自定义数据类型的情况下，需要根据情况将其中<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">两个值合并</strong></span>成一个值，作为key或value值；<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(255, 102, 0);"><strong style="margin: 0px; padding: 0px;">第二</strong></span>，通过一个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">Reduce</strong></span>过程<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">无法<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">同时完成<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">词频统计</span></span></strong>和<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">生成文档列表</strong></span>，所以必须增加一个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">Combine</strong></span>过程<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">完成<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">词频统计</span></strong>。</span></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 这里讲单词和URL组成key值（如&quot;MapReduce：file1.txt&quot;），将词频作为value，这样做的好处是可以利用MapReduce框架自带的Map端排序，将<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">同一文档</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">相同单词</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">词频</strong></span>组成<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">列表</strong></span>，传递给<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">Combine</strong></span>过程，实现类似于WordCount的功能。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）Combine过程</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 经过map方法处理后，Combine过程将key值相同的value值累加，得到一个单词在文档在文档中的词频，如图6.2-2所示。<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">如果</strong></span>直接将图6.2-2所示的输出作为Reduce过程的输入，在Shuffle过程时将<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">面临一个问题</strong></span>：所有具有<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">相同单词</strong></span>的记录（由单词、URL和词频组成）应该交由同一个Reducer处理，但当前的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">key值</strong></span>无法保证这一点，所以必须<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">修改</strong></span>key值和value值。这次将<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">单词</strong></span>作为<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">key</strong></span>值，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">URL和词频组</strong></span>成<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">value</strong></span>值（如&quot;file1.txt：1&quot;）。这样做的好处是可以利用MapReduce框架默认的HashPartitioner类完成Shuffle过程，将<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">相同单词</strong></span>的<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">所有记录</strong></span>发送给<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">同一个<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">Reducer</span></strong>进行<strong style="margin: 0px; padding: 0px;">处理</strong></span>。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;<a href="http://images.cnblogs.com/cnblogs_com/xia520pi/201206/201206041339518504.png" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(51, 51, 51);"><img alt="image" border="0" height="386" src="/uploads/allimg/151125/1342225H6-29.png" style="margin: 0px; padding: 0px; border: 0px; display: inline; background-image: none;" title="image" width="668" /></a></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6.2-2 Combine过程输入/输出</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">3）Reduce过程</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 经过上述两个过程后，Reduce过程只需将相同key值的value值组合成倒排索引文件所需的格式即可，剩下的事情就可以直接交给MapReduce框架进行处理了。如图6.2-3所示。索引文件的内容除分隔符外与图6.1-3解释相同。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">4）需要解决的问题</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 本实例设计的倒排索引在<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;"><strong style="margin: 0px; padding: 0px;">文件数目</strong></span>上<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">没有限制</strong></span>，但是<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">单词文件<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">不宜过大</span></strong>（具体值与默认</span>HDFS块大小及相关配置有关），要<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">保证<span style="margin: 0px; padding: 0px; line-height: 1.8; color: fuchsia;">每个文件<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;">对应<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">一个split</span></span></span></strong>。否则，由于<strong style="margin: 0px; padding: 0px;">Reduce</strong></span>过程<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">没有进一步<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">统计词频</span></strong>，最终结</span>果<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">可能</strong></span>会<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">出现<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;">词频未统计完全</span></strong>的<strong style="margin: 0px; padding: 0px;">单词</strong></span>。可以通过<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">重写</strong></span>InputFormat类将每个文件为一个split，避免上述情况。或者<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">执行两次MapReduce</strong></span>，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">第一次</strong></span>MapReduce用于<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">统计词频</strong></span>，<span style="margin: 0px; padding: 0px; line-height: 1.8; color: blue;"><strong style="margin: 0px; padding: 0px;">第二次</strong></span>MapReduce用于<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">生成倒排索引</strong></span>。除此之外，还可以利用复合键值对等实现包含更多信息的倒排索引。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;<a href="http://images.cnblogs.com/cnblogs_com/xia520pi/201206/201206041339528961.png" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(51, 51, 51);"><img alt="image" border="0" height="364" src="/uploads/allimg/151125/1342223D7-30.png" style="margin: 0px; padding: 0px; border: 0px; display: inline; background-image: none;" title="image" width="835" /></a></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6.2-3 Reduce过程输入/输出</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.3 程序代码</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	　　程序代码如下所示：</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<blockquote style="margin: 10px 0px; padding: 5px 10px; border: 2px dotted rgb(57, 154, 178); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">package</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;com.hebut.mr;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;java.io.IOException;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;java.util.StringTokenizer;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.conf.Configuration;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.fs.Path;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; text-decoration: underline;">org.apache.hadoop.io.IntWritable</span>;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.io.Text;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Job;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Mapper;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.Reducer;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.input.FileSplit;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">import</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;org.apache.hadoop.util.GenericOptionsParser;</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;InvertedIndex {</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Map&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Mapper&lt;Object, Text, Text, Text&gt; {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">private</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">keyInfo<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text();&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span></span></span></span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">存储单词和</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">URL</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">组合</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">private</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">valueInfo<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text();&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span></span></span></span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">存储词频</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">private</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;FileSplit&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">split<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span></span></span></span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">存储</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Split</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">对象</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;map(Object key, Text value, Context context)</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException, InterruptedException {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">获得</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&lt;key,value&gt;</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">对所属的</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">FileSplit</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">对象</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">split<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;= (FileSplit) context.getInputSplit();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringTokenizer itr =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;StringTokenizer(value.toString());</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">while</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(itr.hasMoreTokens()) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">// key</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">值由单词和</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">URL</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">组成，如</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&quot;MapReduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">：</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">file1.<span style="margin: 0px; padding: 0px; line-height: 1.8; text-decoration: underline;">txt</span>&quot;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">获取文件的完整路径</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 9pt;">keyInfo.set(itr.nextToken()+&quot;:&quot;+split.getPath().toString());</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">这里为了好看，只获取文件的名称。</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85); font-size: 9pt;"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;splitIndex =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">split<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.getPath().toString().indexOf(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;file&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">keyInfo<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.set(itr.nextToken() +&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;:&quot;</span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">split<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.getPath().toString().substring(splitIndex));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">词频初始化为</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">1</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">valueInfo<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.set(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;1&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">keyInfo<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">valueInfo<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Combine&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Reducer&lt;Text, Text, Text, Text&gt; {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">private</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">info<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text();</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;reduce(Text key, Iterable&lt;Text&gt; values, Context context)</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException, InterruptedException {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">统计词频</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;sum = 0;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">for</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(Text value : values) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum += Integer.<em style="margin: 0px; padding: 0px;">parseInt</em>(value.toString());</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">int</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;splitIndex = key.toString().indexOf(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;:&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">重新设置</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">value</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">值由</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">URL</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">和词频组成</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">info<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.set(key.toString().substring(splitIndex + 1) +&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;:&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;+ sum);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">重新设置</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">key</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">值为单词</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key.set(key.toString().substring(0, splitIndex));</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(key,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">info<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Reduce&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">extends</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Reducer&lt;Text, Text, Text, Text&gt; {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">private</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">result<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Text();</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">实现</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">函数</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;reduce(Text key, Iterable&lt;Text&gt; values, Context context)</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;IOException, InterruptedException {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">生成文档列表</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String fileList =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">for</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(Text value : values) {</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fileList += value.toString() +&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;;&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">;</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">result<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.set(fileList);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.write(key,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">result<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">public</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">static</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">void</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;main(String[] args)&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">throws</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Exception {</span></span></span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Configuration conf =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Configuration();</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">这句话很关键</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conf.set(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;mapred.job.tracker&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;192.168.1.2:9001&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] ioArgs =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;String[] {&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;index_in&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;index_out&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;};</span></span></span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] otherArgs =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;GenericOptionsParser(conf, ioArgs)</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .getRemainingArgs();</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">if</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;(otherArgs.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);">length<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;!= 2) {</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 192);"><em style="margin: 0px; padding: 0px;">err</em><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">.println(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Usage: Inverted Index &lt;in&gt; &lt;out&gt;&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(2);</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Job job =&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Job(conf,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(42, 0, 255);">&quot;Inverted Index&quot;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setJarByClass(InvertedIndex.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">、</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Combine</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">和</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">处理类</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setMapperClass(Map.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setCombinerClass(Combine.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setReducerClass(Reduce.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Map</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输出类型</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setMapOutputKeyClass(Text.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setMapOutputValueClass(Text.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">Reduce</span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">输出类型</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputKeyClass(Text.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; job.setOutputValueClass(Text.<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">class</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		&nbsp;</p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(63, 127, 95);">//&nbsp;</span></span><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体;">设置输入和输出目录</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileInputFormat.<em style="margin: 0px; padding: 0px;">addInputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[0]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileOutputFormat.<em style="margin: 0px; padding: 0px;">setOutputPath</em>(job,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">new</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;Path(otherArgs[1]));</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas; color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.<em style="margin: 0px; padding: 0px;">exit</em>(job.waitForCompletion(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(127, 0, 85);"><strong style="margin: 0px; padding: 0px;">true</strong><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">) ? 0 : 1);</span></span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">&nbsp;&nbsp;&nbsp; }</span></span></p>
	<p style="margin: 10px auto; padding: 0px;">
		<span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: consolas;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: black;">}</span></span></p>
</blockquote>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<h3 style="margin: 10px 0px; padding: 6px 20px; color: rgb(255, 255, 255); font-family: 'Microsoft Yahei'; font-size: 16px; border-radius: 4px; clear: both; background: rgb(61, 188, 223);">
	6.4 代码结果</h3>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">1）准备测试数据</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 通过Eclipse下面的&quot;DFS Locations&quot;在&quot;/user/hadoop&quot;目录下创建输入文件&quot;index_in&quot;文件夹（<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">备注</strong></span>：&quot;index_out&quot;不需要创建。）如图6.4-1所示，已经成功创建。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/134222JU-31.png" style="margin: 0px; padding: 0px; border: 0px;" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img alt="" src="/uploads/allimg/151125/134222AO-32.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6.4-1 创建&quot;index_in&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 图6.4.2 上传&quot;file*.txt&quot;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 然后在本地建立三个txt文件，通过Eclipse上传到&quot;/user/hadoop/index_in&quot;文件夹中，三个txt文件的内容如&quot;实例描述&quot;那三个文件一样。如图6.4-2所示，成功上传之后。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 从SecureCRT远处查看&quot;Master.Hadoop&quot;的也能证实我们上传的三个文件。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342221326-33.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6.4.3 三个&quot;file*.txt&quot;的内容</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(51, 102, 255);"><strong style="margin: 0px; padding: 0px;">2）查看运行结果</strong></span></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;&nbsp;&nbsp; 这时我们<span style="margin: 0px; padding: 0px; line-height: 1.8; color: red;"><strong style="margin: 0px; padding: 0px;">右击</strong></span>Eclipse的&quot;DFS Locations&quot;中&quot;/user/hadoop&quot;文件夹进行刷新，这时会发现多出一个&quot;index_out&quot;文件夹，且里面有3个文件，然后打开双其&quot;part-r-00000&quot;文件，会在Eclipse中间把内容显示出来。如图6.4-4所示。</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	&nbsp;</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	<img alt="" src="/uploads/allimg/151125/1342226050-34.png" style="margin: 0px; padding: 0px; border: 0px;" /></p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px; text-align: center;">
	图6.4-4 运行结果</p>
<p style="margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px;">
	原文链接http://www.cnblogs.com/xia520pi/archive/2012/06/04/2534533.html</p>
</div>
  		  <!-- 将此标记放在您希望显示like按钮的位置 -->          
            <div class="art_like"><div class="bdlikebutton"></div></div>
          </div>
        </div>
      </div>
      <div class="pnum">
        <div class="pages mypagelist">
          <div></div>
        </div>
      </div>
      <div class="pre_next">
        <nav>
          <ul class="pager">
            <li class="previous"></li>
            <li class="next"></li>
          </ul>
        </nav>
      </div>
      <div class="well"> 
    		如果你有好的<a href="http://www.win10os.com/win10zixun" title="win10资讯">win10资讯</a>或者<a href="http://www.win10os.com/win10jiqiao" title="win10教程">win10教程</a>，以及<a href="http://www.win10os.com/win10xitong" title="win10">win10</a>相关的问题想要获得<a href="http://www.win10os.com/win10xiazai" title="win10系统下载">win10系统下载</a>的关注与报道。<br/>欢迎加入发送邮件到657025171#qq.com(#替换为@)。期待你的好消息！
    	</div>
    </div>
    <!--右侧部分-->
    <div class="col-sm-4 col-md-4">
      <script src='/plus/ad_js.php?aid=12' language='javascript'></script>
      <div class="panel panel-custom panel-custom-right">
        <div class="panel-heading">最新文章>>></div>
        <div class="panel-body">
          <ul class="all_list">
            <li><a href='/linux3' >WIN7系统优化之页面文件pagefile.sys转移</a></li><li><a href='/windows104' >Win10系统快速关机方法大全【图文演示】</a></li><li><a href='/zhanzhang/cxy19' >一个人的网站开发</a></li><li><a href='/zhanzhang/cxy20' >关于对大龄程序员的认识</a></li><li><a href='/zhanzhang/cxy21' >程序员究竟可以干多少年</a></li><li><a href='/zhanzhang/cxy22' >程序员：选择效率，还是选择质量？</a></li><li><a href='/zhanzhang/cxy24' >失败是成功之母，但这10个错误初创公司最好还是别犯</a></li><li><a href='/linux58' >Linux下如何修复Lubuntu中的Docky混合错误</a></li><li><a href='/linux59' >Linux下RabbitMQ的安装与配置</a></li><li><a href='/linux60' >linux kill 关闭进程命令</a></li>
          </ul>
        </div>
      </div>  
      <script src='/plus/ad_js.php?aid=14' language='javascript'></script>
      <div id="scr_cont" class="panel panel-custom panel-custom-right">
        <div class="panel-heading">相关文章>>></div>
        <div class="panel-body">
          <ul class="all_list">
            <li><a href='/bcsj/hadoop899' >HADOOP基本操作命令</a></li><li><a href='/bcsj/hadoop905' >Hadoop HDFS如何配置</a></li><li><a href='/bcsj/hadoop1361' >还不懂Hadoop分布式文件系统HDFS的工作原理？</a></li><li><a href='/bcsj/hadoop1379' >Hadoop集群（第1期）_CentOS安装配置</a></li><li><a href='/bcsj/hadoop1380' >Hadoop集群（第2期）_机器信息分布表</a></li><li><a href='/bcsj/hadoop1382' >Hadoop集群（第3期）_VSFTP安装配置</a></li><li><a href='/bcsj/hadoop1383' >Hadoop集群（第4期）_SecureCRT使用</a></li><li><a href='/bcsj/hadoop1384' >Hadoop集群（第5期）_Hadoop安装配置</a></li><li><a href='/bcsj/hadoop1388' >Hadoop集群（第5期副刊）_JDK和SSH无密码配置</a></li><li><a href='/bcsj/hadoop1389' >Hadoop集群（第6期）_WordCount运行详解</a></li>
          </ul>
          </ul>
        </div>
      </div>
      <div class="ad"></div>
    </div>
    
  </div>
  <nav class="navbar navbar-default navbar-fixed-bottom navbar-bottom-custom">
    <div class="container">
      <span class="pull-right navbar-text" id="font_smaller" onclick="changeFont('smaller')">A-</span>&nbsp;&nbsp;<span class="pull-right navbar-text" id="font_bigger" onclick="changeFont('bigger')">A+</span>
    </div>
  </nav>
  <div class="footer">
    <div class="foot">
      <br>
      鹏鹏编程网(原鹏鹏电脑知识网)是一家纯计算机技术学习、电脑学习、IT技术学习交流型网站，鹏鹏编程网(原鹏鹏电脑知识网)所载文章来源于网络，如果不慎侵犯了您的权益，请联系我们删除！站长QQ：657025171<br>
      <a href="/aboutus.html">关于我们</a> | <a href="/dashiji.html">大事记</a> | <a href="/jiazhiguan.html">网站价值观</a> | <a href="/contactus.html">联系我们</a> | <a href="/sitemap.xml">网站地图</a> | <a href="/copyright.html">版权声明</a><br>
      Copyright ◎ 2011 - 2016 flypeng.com All Rights Reserved.<br>
      flypeng.com 版权所有 京ICP备11048740号<br>

    </div>
  </div>
  <script src="/templets/default/js/jquery-2.1.3.js"></script>
  <script src="/templets/default/js/bootstrap.min.js"></script>
  <script src="/templets/default/js/docs.min.js"></script>
  <script src="/templets/default/js/main.js"></script>
  <script src="/templets/default/js/header.js"></script>
  <script src="/templets/default/js/article.js"></script>
  <script src="/templets/default/js/page-dir.js"></script>
  <script type="text/javascript">
    document.getElementById('count').innerHTML = document.getElementById('count_data').innerHTML;
      var img = $(".art_content p").find("img")
      $.each(img,function(index,el){
        el.style.width='100%';
      });
  </script>
  <!-- 将此代码放在适当的位置，建议在body结束前 -->
  <script id="bdlike_shell"></script>
  <script>
    var bdShare_config = {"type":"large","color":"blue","likeText":"内容很精彩","likedText":"您已顶过，谢谢！"};
    document.getElementById("bdlike_shell").src="http://bdimg.share.baidu.com/static/js/like_shell.js?t=" + Math.ceil(new Date()/3600000);
  </script>
</body>
</html>
