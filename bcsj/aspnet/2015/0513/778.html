<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>微软建议的ASP性能优化28条守则_一起学编程网_为你而生的电脑知识网站_win10系统下载_一起学编程网</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords" content="微软建议的ASP性能优化2" />
  <meta name="description" content="目录 技巧1：将经常使用的数据缓存在Web服务器上 技巧2：将经常使用的数据缓存在Application或Session对象中 技巧3：将数据和HTML缓存在Web服务器的磁盘上 技巧4：避免将非敏捷的组件缓存" />
  	<!-- Bootstrap core CSS -->
	<link href="/templets/default/css/bootstrap.min.css" rel="stylesheet">
	<!-- Bootstrap theme -->
	<link href="/templets/default/css/bootstrap-theme.min.css" rel="stylesheet">

	<!-- Custom styles for this template -->
	<link href="/templets/default/css/theme.css" rel="stylesheet">

	<!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
	<!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
	<script src="/templets/default/js/ie-emulation-modes-warning.js"></script>

	<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
	<script src="/templets/default/js/ie10-viewport-bug-workaround.js"></script>

	<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
	  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
	<script src="/templets/default/js/jquery-2.1.3.js"></script>
	<script src="/templets/default/js/bootstrap.min.js"></script>
	<script src="/templets/default/js/docs.min.js"></script>
	<link href="/templets/default/css/main.css" rel="stylesheet">
	<script src="/templets/default/js/main.js"></script>

  <script src="/templets/default/js/article.js"></script>
<!-- yqxbc.com Baidu tongji analytics -->
<script>
var _hmt = _hmt || [];
(function() {
var hm = document.createElement("script");
hm.src = "//hm.baidu.com/hm.js?01a1ff7b6ab0650920aa64bf8bfad7e2";
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();
</script>
</head>
<body>
      <nav class="navbar navbar-default">

      <div class="container" style="margin-top:0px;">

        <div class="row" style="line-height:45px;">

          学习电脑知识上一起学编程网，www.yqxbc.com！<span class="hidden-xs"><a href="javascript:void(0)" class="pull-right" onclick="alert('按Ctrl+D收藏本站')" title="win10系统">收藏本站</a></span>

        </div>

      </div>      

    </nav>

    <div class="container" style="margin-top:0px;">
      <div class="row" >

        <div class="col-sm-8 col-md-8">

            <a href="/index.html"><img src="/templets/default/images/logo.png" alt="Windows10系统下载,Win10激活,Win10教程" width="196" height="64"/></a>

        </div>
        <div class="col-sm-4 col-md-4">
        <div style="height:45px;">
        <form  method="post" id="searchFrm" role="search" action="/plus/search.php">
            <div class="input-group">
                <input type="text" class="form-control" id="keyword" name="keyword" placeholder="Search">
                <span class="input-group-btn">
                    <button type="button" class="btn btn-default" onclick="searchKey()">搜索</button>
                </span>
            </div><!-- /input-group -->
          </form>
        </div>
        </div>
      </div>
    </div>

    <nav class="navbar navbar-default navbar-custom">

      <div class="container">


<!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header navbar-header-custom">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">首页</a>
        </div>


        <!-- Collect the nav links, forms, and other content for toggling -->

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

          <ul class="nav navbar-nav nav-custom">
             <li class="dropdown">

              <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">电脑知识<span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="/dnzs" title="电脑基础知识学习，计算机技术学习网站，计算机基础知识,电脑学习">电脑知识 <span class="sr-only">(current)</span></a></li>

                <li><a href="/dngz" title="电脑故障大全，计算机故障大全">故障大全</a></li>

                <li><a href="/wlzs" title="网络知识大全">网络知识</a></li>

              </ul>

            </li>

            <li><a href="/sjzs" title="手机故障，手机知识，手机频道">手机知识</a></li>            

            <li class="dropdown">

              <a href="/czxt" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">操作系统<span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="/czxt/windows7" title="windows7系统">windows7</a></li>                

                <li><a href="/czxt/windows8" title="windows8系统">windows8</a></li>                

                <li><a href="http://www.win10os.com" title="windows10系统">windows10</a></li>                

                <li><a href="/czxt/linux" title="linux系统">linux</a></li>

              </ul>

            </li>

            
            <li class="dropdown">

              <a href="/bcsj" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">编程设计<span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="/bcsj/css" title="css">css</a></li>

                <li><a href="/bcsj/java" title="java">java</a></li>

                <li><a href="/bcsj/php" title="php">php</a></li>

                <li><a href="/bcsj/aspnet" title="aspnet">aspnet</a></li>

                <li><a href="/bcsj/js" title="javascript">javascript</a></li>

                <li><a href="/bcsj/ajax" title="ajax">ajax</a></li>

                <li><a href="/bcsj/hadoop" title="hadoop">hadoop</a></li>                

              </ul>

            </li>     

            <li class="dropdown">

              <a href="/shujuku" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">数据库 <span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="/shujuku/sqlserver" title="sql server数据库">SqlServer</a></li>

                <li><a href="/shujuku/mysql" title="MySQL数据库">MySql</a></li>                

                <li><a href="/shujuku/oracle" title="Oracle数据库">Oracle</a></li>                

                <li><a href="/shujuku/mangodb" title="MangoDB数据库">MangoDB</a></li>                

                <li><a href="/shujuku/hbase" title="HBase数据库">HBase</a></li>

                <li><a href="/shujuku/db2" title="DB2数据库">DB2</a></li>

                <li><a href="/shujuku/redis" title="Redis数据库">Redis</a></li>

              </ul>

            </li>
            <li><a href='/yunjisuan' target="_blank" title="云计算">云计算</a></li>
            <li><a href='/dashuju' target="_blank" title="大数据">大数据</a></li>
            <li><a href='/wulianwang' target="_blank" title="物联网">物联网</a></li>
            <li><a href='/main/website.html' target="_blank" title="好站推荐">好站推荐</a></li>
            <li><a href='/erweima/' target="_blank" title="二维码生成">常用工具</a></li>
          </ul>

          
        </div><!-- /.navbar-collapse -->

      </div><!-- /.container-fluid -->

    </nav>

    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">

       <div class="modal-dialog">

          <div class="modal-content">

             <div class="modal-header">

                <button type="button" class="close" data-dismiss="modal" 

                   aria-hidden="true">×

                </button>

                <h4 class="modal-title" id="myModalLabel">

                   搜索提示

                </h4>

             </div>

             <div class="modal-body">

                <div style="height:60px;line-height:60px;">

                  关键字不能小于2个字！

                </div>

             </div>

          </div><!-- /.modal-content -->

       </div><!-- /.modal-dialog -->

    </div><!-- /.modal -->
<script type="text/javascript">
  function searchKey(){
    var keyword = $("#keyword").val();
    if(keyword.length<2){
      $('#myModal').modal('show');     
      return;
    }else{
      $("#searchFrm").submit();
    }

  }
</script>
  <div class="modal fade" id="imgModal" tabindex="-1" role="dialog" aria-hidden="true">
	   <div class="modal-dialog">
		  <div class="modal-content">
			 <div class="modal-body">
				<div id="modal_img" ></div>
			 </div>
		  </div>
	   </div>
	</div>
  <div class="container" style="padding-left:0px;padding-right:0px">
    
    <div class="col-sm-8  col-md-8">
      <ol class="breadcrumb">
      当前位置：<a href='http://www.yqxbc.com/'>首页</a> > <a href='/bcsj/'>编程设计</a> > <a href='/bcsj/aspnet/'>aspnet</a> >
      </ol>
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="art_title">
            <h3>微软建议的ASP性能优化28条守则</h3>
            <a href="http://www.yqxbc.com" title="http://www.yqxbc.com">http://www.yqxbc.com</a>&nbsp;<a href="http://www.yqxbc.com">win10系统</a>  发布时间：2015-05-13 17:16 来源：一起学编程网 浏览：<span id="count"style="font-size:14px;">加载中</span>次
          </div>
          <div class="art_body">
            <div class="art_share"><div><div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script></div></div>
            <div id="778" class="art_content">目录&nbsp;<br />
技巧&nbsp;1：将经常使用的数据缓存在&nbsp;Web&nbsp;服务器上&nbsp;<br />
技巧&nbsp;2：将经常使用的数据缓存在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;对象中&nbsp;<br />
技巧&nbsp;3：将数据和&nbsp;HTML&nbsp;缓存在&nbsp;Web&nbsp;服务器的磁盘上&nbsp;<br />
技巧&nbsp;4：避免将非敏捷的组件缓存在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;对象中&nbsp;<br />
技巧&nbsp;5：不要将数据库连接缓存在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;对象中&nbsp;<br />
技巧&nbsp;6：合理地使用&nbsp;Session&nbsp;对象&nbsp;<br />
技巧&nbsp;7：将代码封装在&nbsp;COM&nbsp;对象中&nbsp;<br />
技巧&nbsp;8：迟一点获得资源，早一点释放资源&nbsp;<br />
技巧&nbsp;9：进程外执行过程以性能换取可靠性&nbsp;<br />
技巧&nbsp;10：使用显式选项&nbsp;<br />
技巧&nbsp;11：在子例程和函数中使用局部变量&nbsp;<br />
技巧&nbsp;12：将经常使用的数据复制到脚本变量中&nbsp;<br />
技巧&nbsp;13：避免重新确定数组的维数&nbsp;<br />
技巧&nbsp;14：使用响应缓冲&nbsp;<br />
技巧&nbsp;15：批处理内嵌脚本和&nbsp;Response.Write&nbsp;语句&nbsp;<br />
技巧&nbsp;16：如果页面需要很长时间才能完成，那么执行前使用&nbsp;Response.IsClientConnected&nbsp;<br />
技巧&nbsp;17：使用&nbsp;&lt;OBJECT&gt;&nbsp;标记例示对象&nbsp;<br />
技巧&nbsp;18：对于&nbsp;ADO&nbsp;和其它组件使用&nbsp;TypeLib&nbsp;绑定&nbsp;<br />
技巧&nbsp;19：利用浏览器的验证功能&nbsp;<br />
技巧&nbsp;20：避免在循环语句中使用字符串串联&nbsp;<br />
技巧&nbsp;21：启用浏览器和代理缓存&nbsp;<br />
技巧&nbsp;22：尽可能使用&nbsp;Server.Transfer&nbsp;代替&nbsp;Response.Redirect&nbsp;<br />
技巧&nbsp;23：在目录&nbsp;URL&nbsp;中使用后斜杠&nbsp;<br />
技巧&nbsp;24：避免使用服务器变量&nbsp;<br />
技巧&nbsp;25：升级到最新和最出色的&nbsp;<br />
技巧&nbsp;26：优化&nbsp;Web&nbsp;服务器&nbsp;<br />
技巧&nbsp;27：进行性能测试&nbsp;<br />
技巧&nbsp;28：阅读资源链接&nbsp;<br />
引言&nbsp;<br />
性能是一个特征。您必须预先设计性能，否则您以后就得重写应用程序。就是说，有哪些好的策略可使&nbsp;Active&nbsp;Server&nbsp;Pages&nbsp;(ASP)&nbsp;应用程序性能达到最佳？&nbsp;<br />
<br />
本文介绍了优化&nbsp;ASP&nbsp;应用程序和&nbsp;Visual&nbsp;Basic&reg;&nbsp;Scripting&nbsp;Edition&nbsp;(VBScript)&nbsp;的技巧。本文讨论了许多陷阱。本文列出的建议已经在&nbsp;http://www.microsoft.com&nbsp;和其它站点中进行了测试，效果十分显著。本文假定您已经对&nbsp;ASP&nbsp;开发，包括&nbsp;VBScript&nbsp;和/或&nbsp;JScript、ASP&nbsp;Application、ASP&nbsp;Session&nbsp;和其它&nbsp;ASP&nbsp;固有对象（Request、Response&nbsp;和&nbsp;Server）有了基本了解。&nbsp;<br />
<br />
通常，ASP&nbsp;性能主要取决于&nbsp;ASP&nbsp;代码本身以外的很多因素。我们不在一篇文章中罗列出所有的信息，在本文结尾处我们列出了与性能有关的资源。这些链接涵盖了&nbsp;ASP&nbsp;和非&nbsp;ASP&nbsp;主题，包括&nbsp;ActiveX&reg;&nbsp;数据对象&nbsp;(ADO)、组件对象模型&nbsp;(COM)、数据库和&nbsp;Internet&nbsp;Information&nbsp;Server&nbsp;(IIS)&nbsp;配置。这些都是我们喜欢的一些链接&nbsp;-&nbsp;一定要去看看。&nbsp;<br />
<br />
技巧&nbsp;1：将经常使用的数据缓存在&nbsp;Web&nbsp;服务器上&nbsp;<br />
典型的&nbsp;ASP&nbsp;页从后端数据存储中检索数据，然后将结果转换成超文本标记语言&nbsp;(HTML)。无论数据库的速度如何，从内存中检索数据总要比从后端数据存储中检索数据快得多。从本地硬盘读取数据通常也比从数据库中检索数据更快。因此，通常可以将数据缓存在&nbsp;Web&nbsp;服务器上（存储在内存或磁盘中），来提高性能。&nbsp;<br />
<br />
缓存是传统的以空间换取时间的做法。如果您缓存的内容正确，那么您可以看到性能会有显著的提高。为使缓存有效，必须保存那些经常重复使用的数据，且要重新计算这些数据需要（适度）大的开销。如果缓存的都是些陈旧的数据，就会造成内存浪费。&nbsp;<br />
<br />
不经常发生改变的数据是很好的缓存候选数据，因为您不必担心随着时间的迁移该数据与数据库同步的问题。组合框列表、引用表、DHTML&nbsp;碎片、扩展标记语言&nbsp;(XML)&nbsp;字符串、菜单项和站点配置变量（包括数据源名称&nbsp;(DSN)、Internet&nbsp;协议&nbsp;(IP)&nbsp;地址和&nbsp;Web&nbsp;路径）都是很好的缓存候选内容。注意您可以缓存数据的&ldquo;表示&rdquo;，而不缓存数据本身。如果&nbsp;ASP&nbsp;页很少更改，且缓存的开销也很大（例如，整个产品目录），则应考虑事先产生&nbsp;HTML，而不是在响应每个请求时重新显示。&nbsp;<br />
<br />
应将数据缓存在哪里，有哪些缓存策略？通常，数据缓存在&nbsp;Web&nbsp;服务器的内存或磁盘中。下两个技巧讲述了这两个方法。&nbsp;<br />
<br />
技巧&nbsp;2:&nbsp;将经常使用的数据缓存在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;对象中&nbsp;<br />
ASP&nbsp;Application&nbsp;和&nbsp;Session&nbsp;对象为将数据缓存在内存中提供了方便的容器。您可以将数据指派到&nbsp;Application&nbsp;和&nbsp;Session&nbsp;对象中，这些数据在&nbsp;HTTP&nbsp;调用之间保留在内存中。Session&nbsp;数据是按每个用户分别存储的，而&nbsp;Application&nbsp;数据则在所有用户之间共享。&nbsp;<br />
<br />
什么时候将数据装载到&nbsp;Application&nbsp;或&nbsp;Session&nbsp;中呢？通常，数据是在启动&nbsp;Application&nbsp;或&nbsp;Session&nbsp;时装载。要在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;启动过程中装载数据，应将适当的代码分别添加到&nbsp;Application_OnStart()&nbsp;或&nbsp;Session_OnStart()&nbsp;中。这些函数应在&nbsp;Global.asa&nbsp;中，如果没有，则可以添加这些函数。还可以在第一次需要时装载该数据。为此，在&nbsp;ASP&nbsp;页中添加一些代码（或编写一个可重复使用的脚本函数），以检查数据是否存在，如果不存在，就装载数据。这是一个传统的性能技术，称为&ldquo;惰性计算&rdquo;&nbsp;-&nbsp;在您知道需要某一个值以前不计算该值。例如：&nbsp;<br />
<br />
&lt;%<br />
Function&nbsp;GetEmploymentStatusList<br />
Dim&nbsp;d<br />
d&nbsp;=&nbsp;Application(?EmploymentStatusList?)<br />
If&nbsp;d&nbsp;=&nbsp;??&nbsp;Then<br />
&#39;&nbsp;FetchEmploymentStatusList&nbsp;function&nbsp;(not&nbsp;shown)<br />
&#39;&nbsp;fetches&nbsp;data&nbsp;from&nbsp;DB,&nbsp;returns&nbsp;an&nbsp;Array<br />
d&nbsp;=&nbsp;FetchEmploymentStatusList()<br />
Application(?EmploymentStatusList?)&nbsp;=&nbsp;d<br />
End&nbsp;If<br />
GetEmploymentStatusList&nbsp;=&nbsp;d<br />
End&nbsp;Function<br />
%&gt;<br />
<br />
可以为所需要的每个数据块编写类似的函数。&nbsp;<br />
<br />
应以什么格式存储数据？可以存储任何变体类型，因为所有脚本变量都是变体型。例如，您可以存储字符串、整数或数组。通常，您将以这些变量类型之一存储&nbsp;ADO&nbsp;记录集的内容。要从&nbsp;ADO&nbsp;记录集获取数据，您可以手工将数据复制到&nbsp;VBScript&nbsp;变量，一次一个字段。使用一个&nbsp;ADO&nbsp;记录集持久函数&nbsp;GetRows()、GetString()&nbsp;或&nbsp;Save()(ADO&nbsp;2.5)，可加快速度且更容易一些。其详细情况已超出本文所讨论的范围，但下面给出了一个函数举例，说明使用&nbsp;GetRows()&nbsp;返回记录集数据的一个数组：&nbsp;<br />
<br />
&#39;&nbsp;Get&nbsp;Recordset,&nbsp;return&nbsp;as&nbsp;an&nbsp;Array<br />
Function&nbsp;FetchEmploymentStatusList<br />
Dim&nbsp;rs&nbsp;<br />
Set&nbsp;rs&nbsp;=&nbsp;CreateObject(?ADODB.Recordset?)<br />
rs.Open&nbsp;?select&nbsp;StatusName,&nbsp;StatusID&nbsp;from&nbsp;EmployeeStatus?,&nbsp;_<br />
?dsn=employees;uid=sa;pwd=;?<br />
FetchEmploymentStatusList&nbsp;=&nbsp;rs.GetRows()&nbsp;?&nbsp;Return&nbsp;data&nbsp;as&nbsp;an&nbsp;Array<br />
rs.Close<br />
Set&nbsp;rs&nbsp;=&nbsp;Nothing<br />
End&nbsp;Function<br />
<br />
对上面举例做更进一步改进，可以将&nbsp;HTML&nbsp;缓存为列表，而不是数组。下面是简单的示例：&nbsp;<br />
<br />
&#39;&nbsp;Get&nbsp;Recordset,&nbsp;return&nbsp;as&nbsp;HTML&nbsp;Option&nbsp;list<br />
Function&nbsp;FetchEmploymentStatusList<br />
Dim&nbsp;rs,&nbsp;fldName,&nbsp;s<br />
Set&nbsp;rs&nbsp;=&nbsp;CreateObject(?ADODB.Recordset?)<br />
rs.Open&nbsp;?select&nbsp;StatusName,&nbsp;StatusID&nbsp;from&nbsp;EmployeeStatus?,&nbsp;_<br />
?dsn=employees;uid=sa;pwd=;?<br />
s&nbsp;=&nbsp;?&lt;select&nbsp;name=??EmploymentStatus??&gt;?&nbsp;&amp;&nbsp;vbCrLf<br />
Set&nbsp;fldName&nbsp;=&nbsp;rs.Fields(?StatusName?)&nbsp;&#39;&nbsp;ADO&nbsp;Field&nbsp;Binding<br />
Do&nbsp;Until&nbsp;rs.EOF<br />
&#39;&nbsp;Next&nbsp;line&nbsp;violates&nbsp;Don&#39;t&nbsp;Do&nbsp;String&nbsp;Concats,<br />
&#39;&nbsp;but&nbsp;it&#39;s&nbsp;OK&nbsp;because&nbsp;we&nbsp;are&nbsp;building&nbsp;a&nbsp;cache<br />
s&nbsp;=&nbsp;s&nbsp;&amp;&nbsp;?&nbsp;&lt;option&gt;?&nbsp;&amp;&nbsp;fldName&nbsp;&amp;&nbsp;?&lt;/option&gt;?&nbsp;&amp;&nbsp;vbCrLf<br />
rs.MoveNext<br />
Loop<br />
s&nbsp;=&nbsp;s&nbsp;&amp;&nbsp;?&lt;/select&gt;?&nbsp;&amp;&nbsp;vbCrLf<br />
rs.Close<br />
Set&nbsp;rs&nbsp;=&nbsp;Nothing&nbsp;&#39;&nbsp;See&nbsp;Release&nbsp;Early<br />
FetchEmploymentStatusList&nbsp;=&nbsp;s&nbsp;&#39;&nbsp;Return&nbsp;data&nbsp;as&nbsp;a&nbsp;String<br />
End&nbsp;Function<br />
<br />
在适当的条件下，可以将&nbsp;ADO&nbsp;记录集本身缓存在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;作用域中。有两个警告：&nbsp;<br />
<br />
必须将&nbsp;ADO&nbsp;标记为自由线程&nbsp;<br />
必须使用断开连接的记录集。&nbsp;<br />
如果不能保证满足这两个要求，则不要缓存&nbsp;ADO&nbsp;记录集。在下面的&ldquo;非敏捷组件&rdquo;和&ldquo;不要缓存连接&rdquo;技巧中，我们将讨论将&nbsp;COM&nbsp;对象存储在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;作用域中的危险性。&nbsp;<br />
<br />
当您将数据存储在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;作用域时，数据将保留在那里，直到您以编程方式改变它、Session&nbsp;过期或&nbsp;Web&nbsp;应用程序重新启动为止。如果数据需要更新怎么办？要手工强制对&nbsp;Application&nbsp;数据进行更新，您可以访问只有管理员才可访问的&nbsp;ASP&nbsp;页来更新数据。或者，您可以通过函数定期自动刷新数据。下面例子存储带有缓存数据的时间戳，并隔一段时间后刷新数据。&nbsp;<br />
<br />
&lt;%<br />
&#39;&nbsp;error&nbsp;handing&nbsp;not&nbsp;shown...<br />
Const&nbsp;UPDATE_INTERVAL&nbsp;=&nbsp;300&nbsp;&#39;&nbsp;Refresh&nbsp;interval,&nbsp;in&nbsp;seconds<br />
<br />
&#39;&nbsp;Function&nbsp;to&nbsp;return&nbsp;the&nbsp;employment&nbsp;status&nbsp;list<br />
Function&nbsp;GetEmploymentStatusList<br />
UpdateEmploymentStatus<br />
GetEmploymentStatusList&nbsp;=&nbsp;Application(?EmploymentStatusList?)<br />
End&nbsp;Function<br />
<br />
&#39;&nbsp;Periodically&nbsp;update&nbsp;the&nbsp;cached&nbsp;data<br />
Sub&nbsp;UpdateEmploymentStatusList<br />
Dim&nbsp;d,&nbsp;strLastUpdate<br />
strLastUpdate&nbsp;=&nbsp;Application(?LastUpdate?)<br />
If&nbsp;(strLastUpdate&nbsp;=&nbsp;??)&nbsp;Or&nbsp;_<br />
(UPDATE_INTERVAL&nbsp;&lt;&nbsp;DateDiff(?s?,&nbsp;strLastUpdate,&nbsp;Now))&nbsp;Then<br />
<br />
&#39;&nbsp;Note:&nbsp;two&nbsp;or&nbsp;more&nbsp;calls&nbsp;might&nbsp;get&nbsp;in&nbsp;here.&nbsp;This&nbsp;is&nbsp;okay&nbsp;and&nbsp;will&nbsp;simply<br />
&#39;&nbsp;result&nbsp;in&nbsp;a&nbsp;few&nbsp;unnecessary&nbsp;fetches&nbsp;(there&nbsp;is&nbsp;a&nbsp;workaround&nbsp;for&nbsp;this)<br />
<br />
&#39;&nbsp;FetchEmploymentStatusList&nbsp;function&nbsp;(not&nbsp;shown)<br />
&#39;&nbsp;fetches&nbsp;data&nbsp;from&nbsp;DB,&nbsp;returns&nbsp;an&nbsp;Array<br />
d&nbsp;=&nbsp;FetchEmploymentStatusList()<br />
<br />
&#39;&nbsp;Update&nbsp;the&nbsp;Application&nbsp;object.&nbsp;Use&nbsp;Application.Lock()<br />
&#39;&nbsp;to&nbsp;ensure&nbsp;consistent&nbsp;data<br />
Application.Lock<br />
Application(?EmploymentStatusList?)&nbsp;=&nbsp;Events<br />
Application(?LastUpdate?)&nbsp;=&nbsp;CStr(Now)<br />
Application.Unlock<br />
End&nbsp;If<br />
End&nbsp;Sub<br />
<br />
请参见&nbsp;World&#39;s&nbsp;Fastest&nbsp;ListBox&nbsp;with&nbsp;Application&nbsp;Data，上面还有一个例子。&nbsp;<br />
<br />
要知道在&nbsp;Session&nbsp;或&nbsp;Application&nbsp;对象中缓存大的数组不是一个好的做法。在访问数组的任何元素之前，脚本语言的语法要求必须临时复制整个数组。例如，如果将由字符串组成的有&nbsp;100,000&nbsp;个元素的数组（该数组将美国邮政编码映射到当地的气象站）缓存在&nbsp;Application&nbsp;对象中，ASP&nbsp;必须先将所有的&nbsp;100,000&nbsp;个气象站复制到临时数组中，然后才能提取一个字符串。在这种情况下，用自定义方法建立一个自定义组件来存储气象站&nbsp;-&nbsp;或使用一个词典组件会更好。&nbsp;<br />
<br />
再警告大家一下，不要将婴儿与洗澡水一起倒掉：数组能快速查寻和存储在内存中是邻近的关键数据对。索引一个词典比索引一个数组要慢得多。应针对您的实际情况，选择提供最佳性能的数据结构。&nbsp;<br />
<br />
技巧&nbsp;3：将数据和&nbsp;HTML&nbsp;缓存在&nbsp;Web&nbsp;服务器的磁盘上&nbsp;<br />
有时，数据可能太多，无法都缓存在内存中。&ldquo;太多&rdquo;只是一个说法，这要看您想消耗多少内存，以及需缓存的项目数和检索这些项目的频率。在任何情况下，如果数据太多而无法都缓存在内存中，则考虑将数据以文本或&nbsp;XML&nbsp;文件缓存在&nbsp;Web&nbsp;服务器的硬盘上。可以同时将数据缓存在磁盘和内存中，为您的站点建立最适宜的缓存策略。&nbsp;<br />
<br />
注意当测量单个&nbsp;ASP&nbsp;页的性能时，检索磁盘上的数据可能不一定要比从数据库检索数据更快。但缓存会降低数据库和网络上的负载。在高负载的情况下，这样做可大大改善总体吞吐量。当缓存开销很大的查询结果（如多表联接或复合存储过程）或大的结果集时，这是非常有效的。与往常一样，要测试一下几种方案的优劣。&nbsp;<br />
<br />
ASP&nbsp;和&nbsp;COM&nbsp;提供一些建立基于磁盘的缓存方案的工具。ADO&nbsp;记录集&nbsp;Save()&nbsp;和&nbsp;Open()&nbsp;函数保存和装载磁盘中的记录集。可以使用这些方法重新编写上面&nbsp;Application&nbsp;数据缓存技巧中的代码示例，用文件的&nbsp;Save()&nbsp;代替写到&nbsp;Application&nbsp;对象中的代码。&nbsp;<br />
<br />
有一些其它组件可以用于文件：&nbsp;<br />
<br />
Scripting.FileSystemObject&nbsp;可使您创建、读和写文件。&nbsp;<br />
与&nbsp;Internet&nbsp;Explorer&nbsp;一起提供的&nbsp;Microsoft&reg;&nbsp;XML&nbsp;解析器&nbsp;(MSXML)&nbsp;支持保存和装载&nbsp;XML&nbsp;文档。&nbsp;<br />
LookupTable&nbsp;对象（例如，用在&nbsp;MSN&nbsp;上）是从磁盘装载简单列表的最好选择。&nbsp;<br />
最后，应考虑将数据的表示缓存在磁盘上，而不是数据本身。预先转换的&nbsp;HTML&nbsp;可以用&nbsp;.htm&nbsp;或&nbsp;.asp&nbsp;文件存储在磁盘上，超级链接可以直接指向这些文件。可以使用商用工具，如&nbsp;XBuilder，或&nbsp;Microsoft&reg;&nbsp;SQL&nbsp;Server&trade;&nbsp;Internet&nbsp;发布功能将产生&nbsp;HTML&nbsp;的过程自动化。或者，您可以将&nbsp;HTML&nbsp;代码片断放在&nbsp;.asp&nbsp;文件中。还可以使用&nbsp;FileSystemObject&nbsp;从磁盘读取&nbsp;HTML&nbsp;文件，或使用&nbsp;XML&nbsp;尽早转换。&nbsp;<br />
<br />
技巧&nbsp;4：避免将非敏捷的组件缓存在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;对象中&nbsp;<br />
尽管将数据缓存在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;对象中是一个好的做法，但缓存&nbsp;COM&nbsp;对象却有严重的陷阱。通常，人们倾向于将经常使用的&nbsp;COM&nbsp;对象缓存到&nbsp;Application&nbsp;或&nbsp;Session&nbsp;对象中。很遗憾，许多&nbsp;COM&nbsp;对象（包括所有以&nbsp;Visual&nbsp;Basic&nbsp;6.0&nbsp;或更低版本编写的对象）当存储在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;对象时，会引起严重的瓶颈。&nbsp;<br />
<br />
具体来讲，当任何不敏捷的组件缓存在&nbsp;Session&nbsp;或&nbsp;Application&nbsp;对象时，将引起性能瓶颈。敏捷的组件是被标记为&nbsp;ThreadingModel=Both&nbsp;的组件，它聚集&nbsp;Free-threaded&nbsp;marshaler&nbsp;(FTM)；或被标记为&nbsp;ThreadingModel=Neutral&nbsp;的组件。（Neutral&nbsp;模型是&nbsp;Windows&reg;&nbsp;2000&nbsp;和&nbsp;COM+&nbsp;的新增模型。）&nbsp;下列组件不是敏捷的：&nbsp;<br />
<br />
自由线程的组件（除非它们聚集&nbsp;FTM）。&nbsp;<br />
单元线程组件。&nbsp;<br />
单线程组件。&nbsp;<br />
配置的组件（Microsoft&nbsp;Transaction&nbsp;Server&nbsp;(MTS)/COM+&nbsp;库和服务器程序包/应用程序）不是敏捷的，除非它们是&nbsp;Neutral&nbsp;线程。单元线程组件和其它非敏捷的组件在页作用域内是最适合的（即，它们在单个&nbsp;ASP&nbsp;页上创建和销毁）。&nbsp;<br />
<br />
在&nbsp;IIS&nbsp;4.0&nbsp;中，被标记为&nbsp;ThreadingModel=Both&nbsp;的组件被认为是敏捷的。在&nbsp;IIS&nbsp;5.0&nbsp;中，只有这一点还不够。组件必须不仅被标记&nbsp;Both，还必须聚集&nbsp;FTM。有关敏捷性的文章讲述了如何使以&nbsp;Active&nbsp;Template&nbsp;Library&nbsp;编写的&nbsp;C++&nbsp;组件聚集&nbsp;FTM。要注意如果组件缓存界面指针，那么那些指针本身必须是敏捷的，或必须存储在&nbsp;COM&nbsp;共用界面表&nbsp;(GIT)&nbsp;中。如果您不能重新编译&nbsp;Both&nbsp;线程组件以聚集&nbsp;FTM，那么您可以将组件标记为&nbsp;ThreadingModel=Neutral。或者，如果您不想让&nbsp;IIS&nbsp;执行敏捷性检查（因此，您可以允许非敏捷的组件存储在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;作用域中），您可以在配置数据库中将&nbsp;AspTrackThreadingModel&nbsp;设置为&nbsp;True。不建议更改&nbsp;AspTrackThreadingModel。&nbsp;<br />
<br />
如果您想将以&nbsp;Server.CreateObject&nbsp;创建的非敏捷的组件存储在&nbsp;Application&nbsp;对象中，IIS&nbsp;5.0&nbsp;将出现一个错误。您可以在&nbsp;Global.asa&nbsp;中使用&nbsp;&lt;object&nbsp;runat=server&nbsp;scope=application&nbsp;...&gt;&nbsp;避免这一错误，但不建议这样做，因为这会导致汇集和串行化，关于这一点将在下面讲述。&nbsp;<br />
<br />
如果您缓存非敏捷的组件会出现什么毛病？缓存在&nbsp;Session&nbsp;对象中的非敏捷的组件将&nbsp;Session&nbsp;锁定于&nbsp;ASP&nbsp;工作者线程。ASP&nbsp;维护一个工作者线程池来处理请求。通常情况下，一个新请求总是由第一个可用的工作者线程来处理。如果&nbsp;Session&nbsp;被锁定于一个线程，那么请求必须等到其相关的线程可用为止。这里有一个类比，也许会有所帮助：您去一家超级市场，挑选了一些商品，并在&nbsp;#_3&nbsp;收款台付款。其后，每当您在那家超级市场为商品付款时，您总是必须在&nbsp;#_3&nbsp;收款台付款，即使其它收款台前排队的人较少或者没有人排队，也是如此。&nbsp;<br />
<br />
将非敏捷的组件存储在&nbsp;Application&nbsp;作用域对性能的影响甚至更坏。ASP&nbsp;必须创建一个特殊的线程运行存储在&nbsp;Application&nbsp;作用域中的非敏捷组件。这会有两个结果：所有调用都必须汇集到此线程，且所有调用都排成长队。&ldquo;汇集&rdquo;的意思是参数必须存储在内存的共享区域；执行一个开销很大的到特殊线程的上下文切换；执行组件的方法；将结果汇集到共享区域；执行另一个开销很大的上下文切换，将控制返回到原始的线程。&ldquo;串行化&rdquo;意思是指每次只运行一个方法。两个不同的&nbsp;ASP&nbsp;工作者线程不能同时在共享组件上执行多个方法。这样就杜绝了并发性，特别是在多处理器计算机上。更糟的是，所有非敏捷的&nbsp;Application&nbsp;作用域的组件共享一个线程（主机&nbsp;STA），因此串行化的影响甚至更显著。&nbsp;<br />
<br />
如之奈何？下面是一些一般的规则。如果您使用&nbsp;Visual&nbsp;Basic&nbsp;(6.0)&nbsp;或更早版本编写对象，那么不要将它们缓存在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;对象中。如果您不知道对象的线程模型，不要缓存它。不要缓存非敏捷的对象，而应在每个页面创建和释放它们。对象直接在&nbsp;ASP&nbsp;工作者线程上运行，因此没有汇集或串行化。如果&nbsp;COM&nbsp;对象在&nbsp;IIS&nbsp;服务器上运行，且如果它们不花长时间初始化和删除，性能尚可。注意单线程对象不应该这样使用。小心&nbsp;-&nbsp;VB&nbsp;可创建单线程对象！如果您必须这样使用单线程对象（如&nbsp;Microsoft&nbsp;Excel&nbsp;电子表格），别指望会有很高的吞吐量。&nbsp;<br />
<br />
当&nbsp;ADO&nbsp;被标记为自由线程，ADO&nbsp;记录集可以安全地缓存。要将&nbsp;ADO&nbsp;标记为自由线程，使用&nbsp;Makfre15.bat&nbsp;文件，该文件通常位于目录&nbsp;\\\\Program&nbsp;Files\\Common\\System\\ADO&nbsp;中。&nbsp;<br />
<br />
警告&nbsp;如果您使用&nbsp;Microsoft&nbsp;Access&nbsp;作为数据库，不应将&nbsp;ADO&nbsp;标记为自由线程的。ADO&nbsp;记录集也必须切断连接。一般来说，如果您不能控制站点中的&nbsp;ADO&nbsp;配置（例如，您是一个独立的软件厂商&nbsp;[ISV]，向管理他们自己的配置客户销售&nbsp;Web&nbsp;应用程序），最好不要缓存记录集。&nbsp;<br />
<br />
词典组件也是敏捷的对象。LookupTable&nbsp;从数据文件中装载其数据，可用于组合框数据和配置信息。Duwamish&nbsp;Books&nbsp;中的&nbsp;PageCache&nbsp;对象可提供词典语法，Caprock&nbsp;Dictionary&nbsp;也可提供。这些对象或其派生对象可以构成有效缓存策略的基础。注意&nbsp;Scripting.Dictionary&nbsp;对象不是敏捷的，不应该存储在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;作用域中。&nbsp;<br />
<br />
技巧&nbsp;5：不要将数据库连接缓存在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;对象中&nbsp;<br />
缓存&nbsp;ADO&nbsp;连接通常是很糟糕的策略。如果一个&nbsp;Connection&nbsp;对象存储在&nbsp;Application&nbsp;对象中，并在所有的页面中使用，那么所有页面将争抢这一连接。如果&nbsp;Connection&nbsp;对象存储在&nbsp;ASP&nbsp;Session&nbsp;对象中，那么将为每个用户创建数据库连接。这就会使连接池的优势荡然无存，并给&nbsp;Web&nbsp;服务器和数据库带来不必要的压力。&nbsp;<br />
<br />
可以不缓存数据库连接，而是在使用&nbsp;ADO&nbsp;的每个&nbsp;ASP&nbsp;页面中创建和删除&nbsp;ADO&nbsp;对象。这是很有效的，因为&nbsp;IIS&nbsp;内嵌了数据库连接池。更准确地说，IIS&nbsp;自动启用&nbsp;OLEDB&nbsp;和&nbsp;ODBC&nbsp;连接池。这就能确保在每个页面上创建和删除连接将是有效的。&nbsp;<br />
<br />
因为连接的记录集存储一个到数据库连接的引用，所以您不应将连接的记录集缓存在&nbsp;Application&nbsp;或&nbsp;Session&nbsp;对象中。但是，您可以安全地缓存断开连接的记录集，它们不保存到其数据连接的引用。要断开记录集连接，执行下面的两个步骤：&nbsp;<br />
<br />
Set&nbsp;rs&nbsp;=&nbsp;Server.CreateObject(?ADODB.RecordSet?)<br />
rs.CursorLocation&nbsp;=&nbsp;adUseClient&nbsp;&#39;&nbsp;step&nbsp;1<br />
<br />
&#39;&nbsp;Populate&nbsp;the&nbsp;recordset&nbsp;with&nbsp;data<br />
rs.Open&nbsp;strQuery,&nbsp;strProv<br />
<br />
&#39;&nbsp;Now&nbsp;disconnect&nbsp;the&nbsp;recordset&nbsp;from&nbsp;the&nbsp;data&nbsp;provider&nbsp;and&nbsp;data&nbsp;source<br />
rs.ActiveConnection&nbsp;=&nbsp;Nothing&nbsp;&#39;&nbsp;step&nbsp;2<br />
<br />
<br />
有关连接池的更详细信息，可以在&nbsp;ADO&nbsp;和&nbsp;SQL&nbsp;Server&nbsp;参考资料中找到。&nbsp;<br />
<br />
技巧&nbsp;6：合理地使用&nbsp;Session&nbsp;对象&nbsp;<br />
既然我们已经讨论了缓存在&nbsp;Application&nbsp;和&nbsp;Session&nbsp;中的优点，现在开始讨论避免使用&nbsp;Session&nbsp;对象的问题。正如下面所讨论的，当与忙的站点一起使用时，Session&nbsp;有几个缺点。&ldquo;忙&rdquo;的意思一般是指一秒钟要求几百页面或成千上万同时用户的站点。这个技巧对于必须水平扩展的站点&nbsp;-&nbsp;即，那些利用多台服务器以处理负载或实现容错的站点&nbsp;-&nbsp;甚至更重要。对于较小的站点，诸如&nbsp;Intranet&nbsp;站点，要想实现&nbsp;Session&nbsp;带来的方，必然增大系统开销。&nbsp;<br />
<br />
简言之，ASP&nbsp;自动为每个访问&nbsp;Web&nbsp;服务器的用户创建一个&nbsp;Session。每个&nbsp;Session&nbsp;大约需要&nbsp;10&nbsp;KB&nbsp;的内存开销（最主要的是数据存储在&nbsp;Session&nbsp;中），这就使所有的请求都减慢。在配置的超时时段（通常是&nbsp;20&nbsp;分钟）结束以前，Session&nbsp;一直保留有效。&nbsp;<br />
<br />
Session&nbsp;的最大的问题不是性能，而是可扩展性。Session&nbsp;不能跨越几台&nbsp;Web&nbsp;服务器，一旦在一台服务器上创建&nbsp;Session，其数据就留在那儿。这就意味着如果您在一个&nbsp;Web&nbsp;服务器群使用&nbsp;Session，您必须设计一个策略，将每个用户请求始终发到用户&nbsp;Session&nbsp;所在的那台服务器上。这被称为将用户&ldquo;粘&rdquo;在&nbsp;Web&nbsp;服务器上。术语&ldquo;粘性会话&rdquo;就是从这里派生而来的。如果&nbsp;Web&nbsp;服务器崩溃，被&ldquo;粘住的&rdquo;用户将丢失他们的会话状态，因为会话不是粘到磁盘上。&nbsp;<br />
<br />
实现粘性会话的策略包括硬件和软件解决方案。诸如&nbsp;Windows&nbsp;2000&nbsp;Advanced&nbsp;Server&nbsp;中的网络负载平衡和&nbsp;Cisco&nbsp;的&nbsp;Local&nbsp;Director&nbsp;之类的解决方案都可以实现粘性会话，代价是要损失一定程度的可扩展性。这些解决方案是不完善的。不建议此时部署您自己的软件解决方案（我们过去常常使用&nbsp;ISAPI&nbsp;筛选器和&nbsp;URL&nbsp;转换等等）。&nbsp;<br />
<br />
Application&nbsp;对象也不跨越多台服务器，如果您必须跨越&nbsp;Web&nbsp;服务器群共享和更新&nbsp;Application&nbsp;数据，您必须使用后端数据库。但是，只读&nbsp;Application&nbsp;数据在&nbsp;Web&nbsp;服务器群中仍是有用的。&nbsp;<br />
<br />
如果只是因为要增加运行时间（处理故障转移和服务器维护），大多数关键任务站点至少需部署两台&nbsp;Web&nbsp;服务器。因此，在设计关键任务应用程序时，必须实现&ldquo;粘性会话&rdquo;，或干脆避免使用&nbsp;Session，以及任何其它将用户状态存储在单个&nbsp;Web&nbsp;服务器上的状态管理技术。&nbsp;<br />
<br />
如果您不使用&nbsp;Session，一定要将它们关闭。您可以通过&nbsp;Internet&nbsp;Services&nbsp;Manager，为应用程序执行此操作（参见&nbsp;ISM&nbsp;文档）。如果您决定使用&nbsp;Session，您可以采用一些方法减轻它们对性能的影响。&nbsp;<br />
<br />
您可以将不需要&nbsp;Session&nbsp;的内容（如帮助屏幕，访问者区域等等）移到另一个关闭了&nbsp;Session&nbsp;的&nbsp;ASP&nbsp;应用程序中。您可以逐页提示&nbsp;ASP，您不再需要该页面上的&nbsp;Session&nbsp;对象，使用以下放在&nbsp;ASP&nbsp;页面最上面的指令：&nbsp;<br />
<br />
&lt;%&nbsp;@EnableSessionState=False&nbsp;%&gt;<br />
<br />
使用这一指令有一个很好的理由是，这些&nbsp;Session&nbsp;在框架集方面存在一个有意思的问题。ASP&nbsp;保证任何时候&nbsp;Session&nbsp;只有一个请求执行。这样就确保如果浏览器为一个用户请求多个页面，一次只有一个&nbsp;ASP&nbsp;请求接触&nbsp;Session，这样就避免了当访问&nbsp;Session&nbsp;对象时发生的多线程问题。很遗憾，一个框架集中的所有页面将以串行方式显示，一个接一个，而不是同时显示。用户可能必须等候很长时间，才能看到所有的框架。该故事的寓意：如果某些框架集页面不依靠&nbsp;Session，一定要使用&nbsp;@EnableSessionState=False&nbsp;指令告诉&nbsp;ASP。&nbsp;<br />
<br />
有许多管理&nbsp;Session&nbsp;状态的方法，可替代&nbsp;Session&nbsp;对象的使用。对于少量的状态（少于&nbsp;4&nbsp;KB），我们通常建议使用&nbsp;Cookies、QueryString&nbsp;变量和隐式变量。对于更大数据量，如购物小车，后端数据库是最适合的选择。有关&nbsp;Web&nbsp;服务器群中状态管理技术的文章很多。有关详细信息，请参见&nbsp;Session&nbsp;状态参考资料。&nbsp;<br />
<br />
技巧&nbsp;7:&nbsp;将代码封装在&nbsp;COM&nbsp;对象中&nbsp;<br />
如果您有许多&nbsp;VBScript&nbsp;或&nbsp;JScript，您可以经常将代码移到编译的&nbsp;COM&nbsp;对象中，从而可改善性能。编译的代码通常比解释的代码运行得更快。编译的&nbsp;COM&nbsp;对象可以通过&ldquo;早绑定&rdquo;访问其它&nbsp;COM&nbsp;对象，与脚本使用的&ldquo;晚绑定&rdquo;相比，&ldquo;早绑定&rdquo;是调用&nbsp;COM&nbsp;对象的更有效方法。&nbsp;<br />
<br />
将代码封装在&nbsp;COM&nbsp;对象中还有一些优点（除性能之外）：&nbsp;<br />
<br />
COM&nbsp;对象有利于将表示逻辑与业务逻辑分开。&nbsp;<br />
COM&nbsp;对象可以保证代码重复使用。&nbsp;<br />
许多开发人员发现以&nbsp;VB、C++&nbsp;或&nbsp;Visual&nbsp;J++&nbsp;编写的代码比&nbsp;ASP&nbsp;更容易调试。&nbsp;<br />
COM&nbsp;对象也有缺点，包括初始开发时间和需要不同的程序设计技巧。注意封装少量的&nbsp;ASP&nbsp;可能引起性能下降，而不会得到性能改进。这种情况通常在少量的&nbsp;ASP&nbsp;代码被封装进&nbsp;COM&nbsp;对象时发生。在这种情况下，创建和调用&nbsp;COM&nbsp;对象的系统开销超过了编译的代码的优点。应反复地试验，以确定什么样的&nbsp;ASP&nbsp;脚本和&nbsp;COM&nbsp;对象代码的组合产生最好的性能。注意，与&nbsp;Microsoft&nbsp;Windows&nbsp;NT&reg;&nbsp;4.0/IIS&nbsp;4.0&nbsp;相比，Windows&nbsp;2000/IIS&nbsp;5.0&nbsp;中在脚本和&nbsp;ADO&nbsp;性能方面有了很大的改进。因此，随着&nbsp;IIS&nbsp;5.0&nbsp;的推出，编译代码比&nbsp;ASP&nbsp;代码的性能优势有所降低。&nbsp;<br />
<br />
有关在&nbsp;ASP&nbsp;中使用&nbsp;COM&nbsp;的优点和缺点的详细讨论，参见&nbsp;ASP&nbsp;Component&nbsp;Guidelines&nbsp;and&nbsp;Programming&nbsp;Distributed&nbsp;Applications&nbsp;with&nbsp;and&nbsp;Microsoft&nbsp;Visual&nbsp;Basic&nbsp;6.0。如果您部署&nbsp;COM&nbsp;组件，以负荷对它们进行测试特别重要。事实上，理所当然应对所有的&nbsp;ASP&nbsp;应用程序进行负荷测试。&nbsp;<br />
<br />
技巧&nbsp;8：迟一点获得资源，早一点释放资源&nbsp;<br />
这里是一个小技巧供您参考。一般来说，最好迟一点获得资源，早一点释放资源。这适用于&nbsp;COM&nbsp;对象以及文件句柄和其它资源。&nbsp;<br />
<br />
这种优化方法主要用于&nbsp;ADO&nbsp;连接和记录集。当您使用完记录集，比方说在显示一个表及其数据之后，应立即释放它，而不是等到页面结束时再释放。将&nbsp;VBScript&nbsp;变量设置为&nbsp;Nothing&nbsp;是最好的做法。不要让记录集超出作用域之外。而且，要释放任何相关的&nbsp;Command&nbsp;或&nbsp;Connection&nbsp;对象（在将记录集或连接设置为&nbsp;=&nbsp;Nothing&nbsp;之前，不要忘记调用&nbsp;Close()）。这会缩短数据库必须为您准备资源的时间，并尽快释放数据库到连接池的连接。&nbsp;<br />
<br />
技巧&nbsp;9：进程外执行过程以性能换取可靠性&nbsp;<br />
ASP&nbsp;和&nbsp;MTS/COM+&nbsp;两者都有配置选项，可使您兼顾可靠性和性能。当建立和部署应用程序时，应知道如何兼顾两者的性能。&nbsp;<br />
<br />
ASP&nbsp;选项<br />
可以配置&nbsp;ASP&nbsp;应用程序，以便以三种方法之一运行。在&nbsp;IIS&nbsp;5.0&nbsp;中，引入了&ldquo;隔离级&rdquo;这一术语以说明这些选项。这三个隔离级分别是低级、中级和高级：&nbsp;<br />
<br />
低级隔离。这在&nbsp;IIS&nbsp;的所有版本中都得到支持，且是最快的。它在&nbsp;Inetinfo.exe&nbsp;中运行&nbsp;ASP，Inetinfo.exe&nbsp;是主要&nbsp;IIS&nbsp;进程。如果&nbsp;ASP&nbsp;应用程序崩溃，IIS&nbsp;也会崩溃。（要在&nbsp;IIS&nbsp;4.0&nbsp;下重新启动&nbsp;IIS，Web&nbsp;站点管理员应使用诸如&nbsp;InetMon&nbsp;之类的工具监视站点，如果服务器发生故障，应启用批处理文件以重新启动服务器。IIS&nbsp;5.0&nbsp;引入了可靠的重新启动，该方法可使发生故障的服务器自动重新启动。）&nbsp;<br />
中级隔离。IIS&nbsp;5.0&nbsp;引入了这个新的级别，它被称为进程外级别，因为&nbsp;ASP&nbsp;在&nbsp;IIS&nbsp;进程之外运行。在中级隔离中，被配置作为中级隔离运行的所有&nbsp;ASP&nbsp;应用程序都共享一个进程空间。这就减少了在一台服务器运行多个进程外&nbsp;ASP&nbsp;应用程序所需要的进程数量。中级隔离是&nbsp;IIS&nbsp;5.0&nbsp;中的默认隔离级别。&nbsp;<br />
高级隔离。在&nbsp;IIS&nbsp;4.0&nbsp;和&nbsp;IIS&nbsp;5.0&nbsp;中支持这一级别，高级隔离也是进程外的。如果&nbsp;ASP&nbsp;崩溃，Web&nbsp;服务器并不会崩溃。下次&nbsp;ASP&nbsp;请求时，ASP&nbsp;应用程序就会自动重新启动。在高级隔离中，配置作为高级隔离运行的每个&nbsp;ASP&nbsp;应用程序都在其自有进程空间中运行。这样做可保护&nbsp;ASP&nbsp;应用程序彼此之间不相互干扰。其缺点是它要求每个&nbsp;ASP&nbsp;应用程序都要有一个单独的进程。当在一台服务器上必须运行许多应用程序时，系统开销就会大大增加。&nbsp;<br />
哪个选项最好的呢？在&nbsp;IIS&nbsp;4.0&nbsp;中，进程外运行将显著降低性能。在&nbsp;IIS&nbsp;5.0&nbsp;中，做了许多改进，将进程外运行&nbsp;ASP&nbsp;应用程序所产生的开销降到最低限度。事实上，在绝大多数测试中，IIS&nbsp;5.0&nbsp;中的&nbsp;ASP&nbsp;进程外应用程序比&nbsp;IIS&nbsp;4.0&nbsp;中的进程内应用程序运行得更快。不管怎样，在两个平台上，进程内（低隔离级）性能最佳。但是，如果访问率相对较低或最大吞吐量较低，低隔离级的优势不太明显。因此，在您每一&nbsp;Web&nbsp;服务器每秒钟需要数百或成千上万页面时，才会觉得有必要设置低隔离级。与往常一样，应对多种配置进行测试，确定您要采取哪一种折衷方案。&nbsp;<br />
<br />
注意&nbsp;当您运行&nbsp;ASP&nbsp;进程外应用程序时（中级或高级隔离），它们在&nbsp;NT4&nbsp;中的&nbsp;MTS&nbsp;和在&nbsp;Windows&nbsp;2000&nbsp;中的&nbsp;COM+&nbsp;中运行。即，在&nbsp;NT4&nbsp;中它们在&nbsp;Mtx.exe&nbsp;中运行；而在&nbsp;Windows&nbsp;2000&nbsp;中，它们在&nbsp;DllHost.exe&nbsp;中运行。您可以在任务管理器中看到这些进程在运行。您还可以看到&nbsp;IIS&nbsp;如何为进程外&nbsp;ASP&nbsp;应用程序配置&nbsp;MTS&nbsp;程序包或&nbsp;COM+&nbsp;应用程序。&nbsp;<br />
<br />
COM&nbsp;选项<br />
COM&nbsp;组件也有三种配置选项，虽然与&nbsp;ASP&nbsp;选项不完全类似。COM&nbsp;组件可以是&ldquo;未配置的&rdquo;、配置为库应用程序或配置为服务器应用程序。&ldquo;未配置的&rdquo;意思是指组件没有注册&nbsp;COM+。组件将在调用程序的进程空间运行，那就是说，它们是&ldquo;进程内的&rdquo;。库应用程序也是进程内的，但使用&nbsp;COM+&nbsp;的服务，包括安全、事务和上下文支持。服务器应用程序被配置为在它们自有的进程空间内运行。&nbsp;<br />
<br />
您可以看到未配置的组件比库应用程序略有一些优势。库应用程序比服务器应用程序的性能优点更大。这是因为库应用程序与&nbsp;ASP&nbsp;在同一进程内运行，而服务器应用程序在它们的自有进程内运行。进程间的调用比进程内调用开销更大。而且，当在进程之间传递诸如记录集之类的数据时，必须在两个进程之间复制所有的数据。&nbsp;<br />
<br />
陷阱！当使用&nbsp;COM&nbsp;服务器应用程序时，如果您在&nbsp;ASP&nbsp;和&nbsp;COM&nbsp;之间传递对象，要确保对象执行&ldquo;按值汇集&rdquo;或&nbsp;MBV。执行&nbsp;MBV&nbsp;的对象将它们自己从一个进程复制到另一个进程。这比下面一种方法好，采用这种方法时，对象仍在创建者的进程中，另外一个进程反复地调用创建进程以使用该对象。切断连接的&nbsp;ADO&nbsp;记录集将&ldquo;按值汇集&rdquo;，连接的记录集则不然。Scripting.Dictionary&nbsp;不执行&nbsp;MBV，且不在进程之间传递。最后，VB&nbsp;程序员请注意：MBV&nbsp;不通过传递参数&nbsp;ByVal&nbsp;获得。MBV&nbsp;由原始的组件作者执行。&nbsp;<br />
<br />
怎么办？<br />
如果让我们建议一个兼顾性能与可靠性的合理配置，它们应是如下的配置：&nbsp;<br />
<br />
在&nbsp;IIS&nbsp;4.0&nbsp;中，使用&nbsp;ASP&nbsp;低隔离级别，使用&nbsp;MTS&nbsp;服务器程序包。&nbsp;<br />
在&nbsp;IIS&nbsp;5.0&nbsp;上，使用&nbsp;ASP&nbsp;的中隔离级，并使用&nbsp;COM+&nbsp;库应用程序。&nbsp;<br />
这些是非常一般的原则，主机服务公司一般情况下以中或高隔离级运行&nbsp;ASP，而单用途的&nbsp;Web&nbsp;服务器可以以低隔离级运行。衡量各种利弊，并自己决定哪个配置更能符合您的需要。&nbsp;<br />
<br />
技巧&nbsp;10：使用显式选项&nbsp;<br />
在&nbsp;.asp&nbsp;文件中应使用&nbsp;Option&nbsp;Explicit。此指令放在&nbsp;.asp&nbsp;文件的最上面，它强制开发人员声明要使用到的所有变量。许多程序员认为这种方法对于调试应用程序很有帮助，因为这种方法避免了键错变量名和误建新变量的可能性（例如，将&nbsp;MyXMLString=)&nbsp;错写成&nbsp;MyXLMString=...。&nbsp;<br />
<br />
更重要的一点也许是，声明的变量比未声明的变量速度更快。由此，脚本在运行时每次用到未声明的变量时，按名称引用它。另一方面，声明的变量是有顺序的，要么以编译时间，要么以运行时间。以后，声明的变量都按此顺序引用。因为&nbsp;Option&nbsp;Explicit&nbsp;强制变量声明，它能确保声明所有变量，因此访问的速度也很快。&nbsp;<br />
<br />
技巧&nbsp;11：在子例程和函数中使用局部变量&nbsp;<br />
局部变量是那些在子例程和函数内声明的变量。在函数或子例程内，局部变量访问比全局变量访问更快。局部变量的使用也会使代码更清晰，因此应尽量使用局部变量。&nbsp;<br />
<br />
技巧&nbsp;12：将经常使用的数据复制到脚本变量中&nbsp;<br />
当访问&nbsp;ASP&nbsp;中的&nbsp;COM&nbsp;对象时，应将经常使用的对象数据复制到脚本变量中。这样做可减少&nbsp;COM&nbsp;方法调用，因为&nbsp;COM&nbsp;方法调用与访问脚本变量相比，开销相对较大。当访问&nbsp;Collection&nbsp;和&nbsp;Dictionary&nbsp;对象时，这种技术也会减少开销很大的查找。&nbsp;<br />
<br />
一般来说，如果您打算不止一次访问对象数据，那么就应将数据放到脚本变量中。这种优化的主要目标是&nbsp;Request&nbsp;变量（Form&nbsp;和&nbsp;QueryString&nbsp;变量）。例如，您的站点可传递一个名为&nbsp;UserID&nbsp;的&nbsp;QueryString&nbsp;变量。假设此&nbsp;UserID&nbsp;在特定页面上被引用&nbsp;12&nbsp;次。可以无须调用&nbsp;Request(?UserID?)&nbsp;12&nbsp;次，而是在&nbsp;ASP&nbsp;页面最上面将&nbsp;UserID&nbsp;指派到一个变量。然后在该页面自始至终使用该变量。这样就省去了&nbsp;11&nbsp;次&nbsp;COM&nbsp;方法调用。&nbsp;<br />
<br />
实际上，访问&nbsp;COM&nbsp;属性或方法的开销并没有那么大。下面举一个例子，说明某相当常见的代码（从语法上讲）：&nbsp;<br />
<br />
Foo.bar.blah.baz&nbsp;=&nbsp;Foo.bar.blah.qaz(1)<br />
If&nbsp;Foo.bar.blah.zaq&nbsp;=&nbsp;Foo.bar.blah.abc&nbsp;Then&nbsp;&#39;&nbsp;...<br />
<br />
当此代码运行时，下面是发生的情况：&nbsp;<br />
<br />
变量&nbsp;Foo&nbsp;被解析为全局对象。&nbsp;<br />
变量&nbsp;bar&nbsp;被解析为&nbsp;Foo&nbsp;的成员。这实际就是一次&nbsp;COM&nbsp;方法调用。&nbsp;<br />
变量&nbsp;blah&nbsp;被解析为&nbsp;Foo.bar&nbsp;的成员。这又是一次&nbsp;COM&nbsp;方法调用。&nbsp;<br />
变量&nbsp;qaz&nbsp;被解析为&nbsp;foo.bar.blah&nbsp;的成员。没有错，这还是一次&nbsp;COM&nbsp;方法调用。&nbsp;<br />
调用&nbsp;Foo.bar.blah.quaz(1)。再一次&nbsp;COM&nbsp;方法调用。懂了吗？&nbsp;<br />
再次执行步骤&nbsp;1&nbsp;至步骤&nbsp;3&nbsp;以解析&nbsp;baz。系统并不知道调用&nbsp;qaz&nbsp;是否改变对象模型，因此必须再次执行步骤&nbsp;1&nbsp;至&nbsp;3&nbsp;以解析&nbsp;baz。&nbsp;<br />
将&nbsp;baz&nbsp;解析为&nbsp;Foo.bar.blah&nbsp;的成员。赋予属性。&nbsp;<br />
再次执行步骤&nbsp;1&nbsp;至步骤&nbsp;3&nbsp;以解析&nbsp;zaq。&nbsp;<br />
再次执行步骤&nbsp;1&nbsp;至步骤&nbsp;3&nbsp;以解析&nbsp;abc。&nbsp;<br />
正如您可看到的，效率相当差（且慢）。以&nbsp;VBScript&nbsp;写此代码的快速方法是：&nbsp;<br />
<br />
Set&nbsp;myobj&nbsp;=&nbsp;Foo.bar.blah&nbsp;&#39;&nbsp;do&nbsp;the&nbsp;resolution&nbsp;of&nbsp;blah&nbsp;ONCE<br />
Myobj.baz&nbsp;=&nbsp;myobj.qaz(1)<br />
If&nbsp;Myobj.zaq&nbsp;=&nbsp;Myobj.abc&nbsp;Then&nbsp;&#39;...<br />
<br />
如果您使用&nbsp;VBScript&nbsp;5.0&nbsp;或更高版本，您可以使用&nbsp;With&nbsp;语句写此代码：&nbsp;<br />
<br />
With&nbsp;Foo.bar.blah<br />
.baz&nbsp;=&nbsp;.qaz(1)<br />
If&nbsp;.zaq&nbsp;=&nbsp;.abc&nbsp;Then&nbsp;&#39;...<br />
...<br />
End&nbsp;With<br />
<br />
注意此技巧也适用于&nbsp;VB&nbsp;程序设计。&nbsp;<br />
<br />
技巧&nbsp;13：避免重新确定数组的维数&nbsp;<br />
应尽量避免&nbsp;Redim&nbsp;数组。就性能而言，如果计算机的物理内存大小有限，最好将数组的初始维数设置为其最不利的情况&nbsp;-&nbsp;或将维数设置为其最佳的情况，然后再按需要重新确定维数。这并非意味着，如果知道您不需要内存时，就随便分配几兆字节的内存。&nbsp;<br />
<br />
下面的代码给您显示使用&nbsp;Dim&nbsp;和&nbsp;Redim&nbsp;不当的情形。&nbsp;<br />
<br />
&lt;%&nbsp;<br />
Dim&nbsp;MyArray()<br />
Redim&nbsp;MyArray(2)<br />
MyArray(0)&nbsp;=&nbsp;?hello?<br />
MyArray(1)&nbsp;=&nbsp;?good-bye?<br />
MyArray(2)&nbsp;=&nbsp;?farewell?<br />
...<br />
&#39;&nbsp;some&nbsp;other&nbsp;code&nbsp;where&nbsp;you&nbsp;end&nbsp;up&nbsp;needing&nbsp;more&nbsp;space&nbsp;happens,&nbsp;then&nbsp;...<br />
Redim&nbsp;Preserve&nbsp;MyArray(5)<br />
MyArray(3)&nbsp;=&nbsp;?more&nbsp;stuff?<br />
MyArray(4)&nbsp;=&nbsp;?even&nbsp;more&nbsp;stuff?<br />
MyArray(5)&nbsp;=&nbsp;?yet&nbsp;more&nbsp;stuff?<br />
%&gt;<br />
<br />
最好一开始就将数组的初始大小&nbsp;Dim&nbsp;正确（在本例中，是&nbsp;5）比&nbsp;Redim&nbsp;数组使其更大好得多。您可能浪费一些内存（如果您没有使用所有的元素），但获得的好处是速度变得更快。&nbsp;<br />
<br />
技巧&nbsp;14：使用响应缓冲&nbsp;<br />
您可以通过启用&ldquo;响应缓冲&rdquo;，将要输出的一整页缓冲起来。这样就将写到浏览器的量减到最少，从而改善总体性能。每个写操作都会产生很大的系统开销（在&nbsp;IIS&nbsp;中以及在通过网络发送的数据量方面），因此写操作越少越好。由于其启动慢且使用&nbsp;Nagling&nbsp;算法（用来减轻网络塞车情况），TCP/IP&nbsp;在发送一些大的数据块时比必须发送许多小的数据块时的效率高得多。&nbsp;<br />
<br />
有两个方法启用响应缓冲。第一种，您可以使用&nbsp;Internet&nbsp;Services&nbsp;Manager&nbsp;为整个应用程序启用响应缓冲。我们建议采用这种方法，在&nbsp;IIS&nbsp;4.0&nbsp;和&nbsp;IIS&nbsp;5.0&nbsp;中默认为新的&nbsp;ASP&nbsp;应用程序启用响应缓冲。第二种，可以在每个&nbsp;ASP&nbsp;页面的接近顶端的地方加入下面的代码行，从而启用响应缓冲：&nbsp;<br />
<br />
&lt;%&nbsp;Response.Buffer&nbsp;=&nbsp;True&nbsp;%&gt;<br />
<br />
此代码行必须在任何响应数据被写到浏览器之前执行（即，在任何&nbsp;HTML&nbsp;出现在&nbsp;ASP&nbsp;脚本之前以及在使用&nbsp;Response.Cookies&nbsp;集合设置任何&nbsp;Cookies&nbsp;之前）。一般来说，最好为整个应用程序启用响应缓冲。这样，您就不必在每个页面最上面写入上述的代码行。&nbsp;<br />
<br />
Response.Flush<br />
关于响应缓冲有一个常见的抱怨，就是用户感觉到&nbsp;ASP&nbsp;页面的响应速度很慢（即使整个响应时间得到改进），因为他们必须等到整个页面生成，然后他们才能看到东西。对于运行时间长的页面，您可以设置&nbsp;Response.Buffer&nbsp;=&nbsp;False，禁用响应缓冲。但是，一个更好的策略是利用&nbsp;Response.Flush&nbsp;方法。这种方法将&nbsp;ASP&nbsp;转换的所有&nbsp;HTML&nbsp;送到浏览器。例如，在转换&nbsp;1,000&nbsp;行的表的前&nbsp;100&nbsp;行之后，ASP&nbsp;可以调用&nbsp;Response.Flush，强制将转换的结果送到浏览器，这样可使用户在其余的行准备好之前看到头&nbsp;100&nbsp;行。这种技术可以将响应缓冲与浏览器逐渐显示数据完美地结合在一起。&nbsp;<br />
<br />
（注意在上面的&nbsp;1,000&nbsp;行表的举例中，许多浏览器在它们看到关闭&nbsp;&lt;/table&gt;&nbsp;标记之前不会开始显示表。检查您的目标浏览器是否支持。为避免这种情况，将表分成多个具有较少行的表，并在每个表之后调用&nbsp;Response.Flush。较新版本的&nbsp;Internet&nbsp;Explorer&nbsp;在表完全下载之前就开始显示表，如果您指定表列宽，显示速度就会特别快，这样做可避免强制&nbsp;Internet&nbsp;Explorer&nbsp;通过测量每个单元格的内容宽度来计算列宽。）&nbsp;<br />
<br />
另一个关于响应缓冲的常见的抱怨是，当产生非常大的页面时，将占用许多服务器内存。撇开产生大页面的方法不谈，这种问题也可通过巧妙使用&nbsp;Response.Flush&nbsp;来加以解决。&nbsp;<br />
<br />
技巧&nbsp;15：批处理内嵌脚本和&nbsp;Response.Write&nbsp;语句&nbsp;<br />
VBScript&nbsp;语法&nbsp;&lt;%&nbsp;=&nbsp;expression&nbsp;%&gt;&nbsp;将&ldquo;expression&rdquo;的值写到&nbsp;ASP&nbsp;输出流中。如果响应缓冲未启用，那么执行其中的每一条语句，都会以许多小的数据包通过网络将数据写到浏览器中。这样速度很慢。而且穿插执行少量的脚本和&nbsp;HTML，将引起脚本引擎和&nbsp;HTML&nbsp;之间的切换，从而降低性能。因此，使用下面的技巧：使用&nbsp;Response.Write&nbsp;调用代替捆绑紧密的内嵌表达式。例如，在下面的示例中，在每一行的每一字段对响应流有一次写操作，每一行在&nbsp;VBScript&nbsp;和&nbsp;HTML&nbsp;之间有许多切换：&nbsp;<br />
<br />
&lt;table&gt;<br />
&lt;%&nbsp;For&nbsp;Each&nbsp;fld&nbsp;in&nbsp;rs.Fields&nbsp;%&gt;<br />
&lt;th&gt;&lt;%&nbsp;=&nbsp;fld.Name&nbsp;%&gt;&lt;/th&gt;<br />
&lt;%<br />
Next&nbsp;<br />
While&nbsp;Not&nbsp;rs.EOF<br />
%&gt;<br />
&lt;tr&gt;<br />
&lt;%&nbsp;For&nbsp;Each&nbsp;fld&nbsp;in&nbsp;rs.Fields&nbsp;%&gt;<br />
&lt;td&gt;&lt;%&nbsp;=&nbsp;fld.Value&nbsp;%&gt;&lt;/td&gt;<br />
&lt;%&nbsp;Next&nbsp;<br />
&lt;/tr&gt;<br />
&lt;%&nbsp;rs.MoveNext&nbsp;<br />
Wend&nbsp;%&gt;<br />
&lt;/table&gt;<br />
<br />
下面的代码更有效，每一行对响应流有一次写操作。所有的代码都包含在一个&nbsp;VBScript&nbsp;块内：&nbsp;<br />
<br />
&lt;table&gt;<br />
&lt;%<br />
For&nbsp;each&nbsp;fld&nbsp;in&nbsp;rs.Fields<br />
Response.Write&nbsp;(?&lt;th&gt;?&nbsp;&amp;&nbsp;fld.Name&nbsp;&amp;&nbsp;?&lt;/th&gt;?&nbsp;&amp;&nbsp;vbCrLf)<br />
Next<br />
While&nbsp;Not&nbsp;rs.EOF<br />
Response.Write&nbsp;(?&lt;tr&gt;?)<br />
For&nbsp;Each&nbsp;fld&nbsp;in&nbsp;rs.Fields&nbsp;%&gt;<br />
Response.Write(?&lt;td&gt;?&nbsp;&amp;&nbsp;fld.Value&nbsp;&amp;&nbsp;?&lt;/td&gt;?&nbsp;&amp;&nbsp;vbCrLf)<br />
Next<br />
Response.Write&nbsp;?&lt;/tr&gt;?<br />
Wend<br />
%&gt;<br />
&lt;/table&gt;<br />
<br />
当禁用响应缓冲时，这一技巧的效果特别大。最好启用响应缓冲，然后看批处理&nbsp;Response.Write&nbsp;是否有助于提高性能。&nbsp;<br />
<br />
（在这一特定举例中，建立表主体的嵌套循环&nbsp;(While&nbsp;Not&nbsp;rs.EOF...)&nbsp;可以用仔细构建的&nbsp;GetString&nbsp;调用来替代。）&nbsp;<br />
<br />
技巧&nbsp;16：如果页面需要很长时间才能完成，那么执行前使用&nbsp;Response.IsClientConnected&nbsp;<br />
如果用户性急，他们可能会在您开始执行他们的请求之前，就会放弃&nbsp;ASP&nbsp;页面。如果他们单击刷新或移到服务器上的另一个页面，在&nbsp;ASP&nbsp;请求队列的末尾就有一个新的请求等候，在队列的中间有一个断开连接的请求。当服务器的负载很高时（因此请求队列就会很长，响应时间也会相应地变长），就会经常发生这种情况，这样只能使情况变得更糟。如果用户不再连接，执行&nbsp;ASP&nbsp;页面（特别是慢的、大的&nbsp;ASP&nbsp;页面）已没有任何意义。您可以使用&nbsp;Response.IsClientConnected&nbsp;属性检查这一情况。如果它返回&nbsp;False，则应调用&nbsp;Response.End&nbsp;并放弃页的其余部分。事实上，IIS&nbsp;5.0&nbsp;已将这一做法编为程序&nbsp;-&nbsp;每当&nbsp;ASP&nbsp;即将执行新请求时，它就会检查请求在队列中已等候了多长时间。如果已经在那里等候了多于&nbsp;3&nbsp;秒钟，ASP&nbsp;将检查客户机是否仍处于连接状态，如果没有连接，就立即终止请求。您可以在配置数据库中使用&nbsp;AspQueueConnectionTestTime&nbsp;设置将超时时间由&nbsp;3&nbsp;秒调整为其它值。&nbsp;<br />
<br />
如果页面要花很长时间才能执行完，也可以不时地检查&nbsp;Response.IsClientConnected。当启用了响应缓冲时，最好不时地执行&nbsp;Response.Flush，以用户知道，正在发生什么事。&nbsp;<br />
<br />
注意&nbsp;在&nbsp;IIS&nbsp;4.0&nbsp;上，除非先执行了&nbsp;Response.Write，否则&nbsp;Response.IsClientConnected&nbsp;就不能正常工作。如果启用了缓冲，您也必须执行&nbsp;Response.Flush。在&nbsp;IIS&nbsp;5.0&nbsp;上，却没有必要这样做，-&nbsp;Response.IsClientConnected&nbsp;工作正常。在任何情况下，Response.IsClientConnected&nbsp;都会有一些开销，因此只有在一个操作至少要花（比方说）&nbsp;500&nbsp;毫秒（如果您想维持每秒钟数十页的吞吐量，这是一个很长的时间）才使用它。经验表明，不要每次重复执行紧密循环时都调用它，如显示表的许多行时&nbsp;-&nbsp;每隔二十或五十行调用一次可能比较合适。&nbsp;<br />
<br />
技巧&nbsp;17：使用&nbsp;&lt;OBJECT&gt;&nbsp;标记例示对象&nbsp;<br />
如果要引用不在所有代码路径（特别是服务器或应用程序作用域的对象）中使用的对象，使用&nbsp;Global.asa&nbsp;中&nbsp;&lt;object&nbsp;runat=server&nbsp;id=objname&gt;&nbsp;标记声明它们，而不使用&nbsp;Server.CreateObject&nbsp;方法。Server.CreateObject&nbsp;能立即创建对象。如果以后不再使用该对象，您就浪费了资源。&lt;object&nbsp;id=objname&gt;&nbsp;标记声明&nbsp;objname，但在其方法或属性第一次使用以前，不会创建&nbsp;objname。&nbsp;<br />
<br />
这又是一个惰性计算的例子。&nbsp;<br />
<br />
技巧&nbsp;18：对于&nbsp;ADO&nbsp;和其它组件使用&nbsp;TypeLib&nbsp;声明&nbsp;<br />
当使用&nbsp;ADO&nbsp;时，开发人员经常加入&nbsp;adovbs.txt，以访问&nbsp;ADO&nbsp;的各种常量。在要使用常量的每个页面中必须包含此文件。此常量文件相当大，给每个&nbsp;ASP&nbsp;页面的编译时间和脚本大小增加了许多系统开销。&nbsp;<br />
<br />
IIS&nbsp;5.0&nbsp;引入了绑定到组件类型库的功能。这可使您引用类型库一次，并将其用在每个&nbsp;ASP&nbsp;页面上。每个页面不会产生编译常量文件的开销，且组件开发人员不必建立&nbsp;VBScript#_include&nbsp;文件以在&nbsp;ASP&nbsp;上使用。&nbsp;<br />
<br />
要访问&nbsp;ADO&nbsp;TypeLib，将下面一条语句放在&nbsp;Global.asa&nbsp;中。&nbsp;<br />
<br />
&lt;!--&nbsp;METADATA&nbsp;NAME=?Microsoft&nbsp;ActiveX&nbsp;Data&nbsp;Objects&nbsp;2.5&nbsp;Library?&nbsp;<br />
TYPE=?TypeLib?&nbsp;UUID=?{00000205-0000-0010-8000-00AA006D2EA4}?&nbsp;--&gt;<br />
<br />
或&nbsp;<br />
<br />
&lt;!--&nbsp;METADATA&nbsp;TYPE=?TypeLib?&nbsp;<br />
FILE=?C:\\Program&nbsp;Files\\Common&nbsp;Files\\system\\ado\\msado15.dll?&nbsp;--&gt;<br />
<br />
技巧&nbsp;19:&nbsp;利用浏览器的验证功能&nbsp;<br />
现今的浏览器对一些高级功能如&nbsp;XML、DHTML、Java&nbsp;小程序和远程数据服务提供支持。尽可能使用这些功能。所有这些技术都可以执行客户机端验证和数据缓存，免去了到&nbsp;Web&nbsp;服务器的往返。如果您在运行一个智能浏览器，那么浏览器就能为您进行一些验证（例如，在执行&nbsp;POST&nbsp;之前，检查信用卡校验和是否有效）。尽可能使用这一功能。通过减少客户-服务器之间的往返，可降低&nbsp;Web&nbsp;服务器上的负载，并能减少网络通信量（虽然发送到浏览器的第一个页面可能比较大）以及服务器访问的任何后端资源。此外，用户不必像住常一样读取新页，从而用户的感觉会好一些。这样做并不意味着您可以不进行服务器端验证&nbsp;-&nbsp;您还应始终进行服务器端验证。这可以防止由于某种原因（如黑客，或浏览器不运行客户机端验证例程）客户机产生错误的数据。&nbsp;<br />
<br />
人们已经进行了大量的工作，开发&ldquo;独立于浏览器&rdquo;的&nbsp;HTML。正是由于这种忧虑，开发人员不愿再使用流行的浏览器功能，但这些功能本可以改善性能。对于一些真正的高性能站点，必须关心浏览器&ldquo;访问&rdquo;问题，一个好的策略是优化页面，使其适应流行的浏览器。使用浏览器功能组件，可以在&nbsp;ASP&nbsp;中方便地检测到浏览器功能。Microsoft&nbsp;FrontPage&nbsp;等工具有助于设计适合于浏览器和指定&nbsp;HTML&nbsp;版本的代码。参见&nbsp;When&nbsp;is&nbsp;Better&nbsp;Worse？Weighing&nbsp;the&nbsp;Technology&nbsp;Trade-Offs，以了解更进一步的讨论。&nbsp;<br />
<br />
技巧&nbsp;20：避免在循环语句中使用字符串串联&nbsp;<br />
许多人在循环语句中建立一个字符串，如下所示：&nbsp;<br />
<br />
s&nbsp;=&nbsp;?&lt;table&gt;?&nbsp;&amp;&nbsp;vbCrLf<br />
For&nbsp;Each&nbsp;fld&nbsp;in&nbsp;rs.Fields<br />
s&nbsp;=&nbsp;s&nbsp;&amp;&nbsp;?&nbsp;&lt;th&gt;?&nbsp;&amp;&nbsp;fld.Name&nbsp;&amp;&nbsp;?&lt;/th&gt;&nbsp;?<br />
Next<br />
<br />
While&nbsp;Not&nbsp;rs.EOF<br />
s&nbsp;=&nbsp;s&nbsp;&amp;&nbsp;vbCrLf&nbsp;&amp;&nbsp;?&nbsp;&lt;tr&gt;?<br />
For&nbsp;Each&nbsp;fld&nbsp;in&nbsp;rs.Fields<br />
s&nbsp;=&nbsp;s&nbsp;&amp;&nbsp;?&nbsp;&lt;td&gt;?&nbsp;&amp;&nbsp;fld.Value&nbsp;&amp;&nbsp;?&lt;/td&gt;&nbsp;?<br />
Next<br />
s&nbsp;=&nbsp;s&nbsp;&amp;&nbsp;?&nbsp;&lt;/tr&gt;?<br />
rs.MoveNext<br />
Wend<br />
<br />
s&nbsp;=&nbsp;s&nbsp;&amp;&nbsp;vbCrLf&nbsp;&amp;&nbsp;?&lt;/table&gt;?&nbsp;&amp;&nbsp;vbCrLf<br />
Response.Write&nbsp;s<br />
<br />
<br />
采用这种方法会出现一些问题。第一个问题是反复串联字符串需要花两次方的时间，更通俗地说，运行这种循环语句所花的时间与记录数乘以字段数所得值的平方成正比。举一个更简单的例子，就可以更清楚地说明这一问题。&nbsp;<br />
<br />
s&nbsp;=&nbsp;??<br />
For&nbsp;i&nbsp;=&nbsp;Asc(?A?)&nbsp;to&nbsp;Asc(?Z?)<br />
s&nbsp;=&nbsp;s&nbsp;&amp;&nbsp;Chr(i)<br />
Next<br />
<br />
<br />
在第一次迭代中，您获得了一个字符的字符串&nbsp;?A?。在第二次迭代中，VBScript&nbsp;必须重新分配字符串并将两个字符&nbsp;(?AB?)&nbsp;复制到&nbsp;s&nbsp;中。在第三次迭代中，它还必须再次重新分配&nbsp;s&nbsp;并将三个字符复制到&nbsp;s&nbsp;中。在&nbsp;N&nbsp;次（第&nbsp;26&nbsp;次）迭代中，它必须重新分配并将&nbsp;N&nbsp;个字符复制到&nbsp;s&nbsp;中。总共就是&nbsp;1+2+3+...+N，即&nbsp;N*(N+1)/2&nbsp;次复制。&nbsp;<br />
<br />
在上面的记录集举例中，如果有&nbsp;100&nbsp;个记录和&nbsp;5&nbsp;个字段，内循环将执行&nbsp;100*5&nbsp;=&nbsp;500&nbsp;次，所有的复制和重新分配所花的时间与&nbsp;500*500&nbsp;=&nbsp;250,000&nbsp;成正比。这对于中等大小的记录集来说复制操作太多了。&nbsp;<br />
<br />
在本例中，代码可以用&nbsp;Response.Write()&nbsp;或内嵌脚本&nbsp;(&lt;%&nbsp;=&nbsp;fld.Value&nbsp;%&gt;)&nbsp;替代字符串串联来改进。如果启用了响应缓冲的话（应该的），这样做就会更快，因为&nbsp;Response.Write&nbsp;只将数据附加到响应缓冲的末尾。并不涉及重新分配，因此效率很高。&nbsp;<br />
<br />
在将&nbsp;ADO&nbsp;记录集转换为&nbsp;HTML&nbsp;表的特定情况下，应考虑使用&nbsp;GetRows&nbsp;或&nbsp;GetString。&nbsp;<br />
<br />
如果在&nbsp;JScript&nbsp;中串联字符串，特别建议使用&nbsp;+=&nbsp;运算符，即，使用&nbsp;s&nbsp;+=&nbsp;?某字符串?，而不使用&nbsp;s&nbsp;=&nbsp;s&nbsp;+&nbsp;?某字符串?。&nbsp;<br />
<br />
技巧&nbsp;21：启用浏览器和代理缓存&nbsp;<br />
在默认情况下，ASP&nbsp;禁止在浏览器和代理中进行缓存。这是有意义的，因为就实质而言&nbsp;ASP&nbsp;页面是动态的，上面有随时间不断变化的潜在信息。如果页面不要求在每个视图上进行刷新，您应启用浏览器和代理缓存。这可使浏览器和代理在一定的时间内使用页面的&ldquo;缓存&rdquo;副本，您可以控制时间的长短。缓存可以大大减轻服务器上的负载，缩短用户的等待时间。&nbsp;<br />
<br />
哪一种动态页面可作为要缓存的页面呢？下面举一些例子：&nbsp;<br />
<br />
天气预报页面，在此页面上，每隔&nbsp;5&nbsp;分钟更新一次天气预报。&nbsp;<br />
列出新闻条目或新闻稿的主页，它一天更新两次。&nbsp;<br />
共同基金业绩列表，在此列表中，基本统计信息每隔几小时更新一次。&nbsp;<br />
注意，在使用浏览器或代理缓存的情况下，Web&nbsp;服务器上记录的访问次数减少了。如果您想准确地测量所有页面视图或张帖公布，您就不希望使用浏览器和代理缓存。&nbsp;<br />
<br />
浏览器缓存由&nbsp;HTTP&ldquo;过期&rdquo;报头控制，该报头由&nbsp;Web&nbsp;服务器发送给浏览器。ASP&nbsp;提供两个简单的机制发送此报头。要设置页面使其过多少分钟后到期，则应设置&nbsp;Response.Expires&nbsp;属性。下面的例子告诉浏览器内容在&nbsp;10&nbsp;分钟内过期：&nbsp;<br />
<br />
&lt;%&nbsp;Response.Expires&nbsp;=&nbsp;10&nbsp;%&gt;&nbsp;<br />
<br />
若将&nbsp;Response.Expires&nbsp;设置为负数或&nbsp;0，则禁用缓存。一定要使用大的负数，如&nbsp;-1000（略多于一天），以避免服务器和浏览器时钟之间的不匹配。第二个属性&nbsp;Response.ExpiresAbsolute&nbsp;将使您设置内容过期的具体时间：&nbsp;<br />
<br />
&lt;%&nbsp;Response.ExpiresAbsolute&nbsp;=&nbsp;#May&nbsp;31,2001&nbsp;13:30:15#&nbsp;%&gt;<br />
<br />
您可以不使用&nbsp;Response&nbsp;对象设置过期时间，而将&nbsp;&lt;META&gt;&nbsp;标记写进&nbsp;HTML，通常写在&nbsp;HTML&nbsp;文件的&nbsp;&lt;HEAD&gt;&nbsp;部分。一些浏览器将遵照此指令，而代理则不然。&nbsp;<br />
<br />
&lt;META&nbsp;HTTP-EQUIV=?Expires?&nbsp;VALUE=?May&nbsp;31,2001&nbsp;13:30:15?&gt;<br />
<br />
最后，您可以使用&nbsp;Response.CacheControl&nbsp;属性，指示其内容是否可以让&nbsp;HTTP&nbsp;代理缓存。若将此属性设置为&ldquo;Public&rdquo;，代理就可以缓存此内容。&nbsp;<br />
<br />
&lt;%&nbsp;Response.CacheControl&nbsp;=&nbsp;?Public?&nbsp;%&gt;<br />
<br />
在默认情况下，此属性被设置为&ldquo;Private&rdquo;。注意，对于显示某用户特定数据的页面，不应启用代理缓存，因为代理可能给用户提供属于其他用户的页面。&nbsp;<br />
<br />
技巧&nbsp;22：尽可能使用&nbsp;Server.Transfer&nbsp;代替&nbsp;Response.Redirect&nbsp;<br />
Response.Redirect&nbsp;让浏览器请求另一个页面。此函数常用来将用户重定向到一个登录或错误页面。因为重定向强制请求新页面，结果是浏览器必须到&nbsp;Web&nbsp;服务器往返两次，且&nbsp;Web&nbsp;服务器必须多处理一个请求。IIS&nbsp;5.0&nbsp;引入了一个新的函数&nbsp;Server.Transfer，它将执行转移到同一台服务器上的另一个&nbsp;ASP&nbsp;页。这样就避免多余的浏览器-Web-服务器的往返，从而改善了总体系统性能以及缩短了用户的响应时间。检查&ldquo;重定向&rdquo;中的&ldquo;新的方向&rdquo;，上面应该是&nbsp;Server.Transfer&nbsp;和&nbsp;Server.Execute。&nbsp;<br />
<br />
另请参见&nbsp;Leveraging&nbsp;ASP&nbsp;in&nbsp;IIS&nbsp;5.0，了解&nbsp;IIS&nbsp;5.0&nbsp;和&nbsp;ASP&nbsp;3.0&nbsp;新功能的完整列表。&nbsp;<br />
<br />
技巧&nbsp;23：在目录&nbsp;URL&nbsp;中使用后斜杠&nbsp;<br />
一个相关的技巧是确保在指向目录的&nbsp;URL&nbsp;中使用后斜杠&nbsp;(/)。如果您省略了后斜杠，浏览器就会向服务器发出请求，只是为了告诉服务器，它在请求目录。浏览器就会发出第二个请求，将斜杠附加到&nbsp;URL&nbsp;后面，只有此后，服务器才能以该目录的默认文档或目录列表（如果没有默认文档且启用了目录浏览的话）响应。附加斜杠可省去第一个、无用的住返。为便于用户阅读，可以省略显示名称中的后斜杠。&nbsp;<br />
<br />
例如，写：&nbsp;<br />
<br />
&lt;a&nbsp;href=?http://msdn.microsoft.com/workshop/?&nbsp;title=?MSDN&nbsp;Web<br />
Workshop?&gt;http://msdn.microsoft.com/workshop&lt;/a&gt;<br />
<br />
这也适用于指向&nbsp;Web&nbsp;站点上主页的&nbsp;URL：使用下面的：&lt;a&nbsp;href=?http://msdn.microsoft.com/?&gt;，而不使用&nbsp;&lt;a&nbsp;href=?http://msdn.microsoft.com?&gt;。&nbsp;<br />
<br />
技巧&nbsp;24：避免使用服务器变量&nbsp;<br />
访问服务器变量会使&nbsp;Web&nbsp;站点向服务器发出一个特殊请求，并收集所有服务器变量，而不只是您请求的那个变量。这种情况类似于，在发霉的阁楼上，在一个文件夹中查找某个文件。当您想要找那个文件时，您必须去阁楼上，先找到文件夹，然后才能找到这份文件。当您请求服务器变量时，发生的情况是一样的&nbsp;-&nbsp;您第一次请求服务器变量时，就会使性能受到影响。后面的对其它服务器变量的请求，则不会对性能产生影响。&nbsp;<br />
<br />
决不要访问非限定的&nbsp;Request&nbsp;对象（例如，Request(&quot;Data&quot;)）。对于不在&nbsp;Request.Cookies、Request.Form、Request.QueryString&nbsp;或&nbsp;Request.ClientCertificate&nbsp;中的项目，则隐式调用&nbsp;Request.ServerVariables。Request.ServerVariables&nbsp;集合比其它集合慢得多。&nbsp;<br />
<br />
技巧&nbsp;25：升级到最新和最出色的&nbsp;<br />
系统组件是恒定的，我们建议您将它们升级到最新和最好的配置。最好升级到&nbsp;Windows&nbsp;2000（因此，也应升级到&nbsp;IIS&nbsp;5.0、ADO&nbsp;2.5、MSXML&nbsp;2.5、Internet&nbsp;Explorer&nbsp;5.0、VBScript&nbsp;5.1&nbsp;和&nbsp;JScript&nbsp;5.1）。在多处理器计算机上，实施&nbsp;IIS&nbsp;5.0&nbsp;和&nbsp;ADO&nbsp;2.5&nbsp;可显著改善性能。在&nbsp;Windows&nbsp;2000&nbsp;下，ASP&nbsp;可以很好地扩展到四个处理器或更多，而在&nbsp;IIS&nbsp;4.0&nbsp;下，ASP&nbsp;的扩展性不能超出两个处理器。在应用程序中使用的脚本代码和&nbsp;ADO&nbsp;越多，升级到&nbsp;Windows&nbsp;2000&nbsp;之后，性能的改善就会越多。&nbsp;<br />
<br />
如果目前还不能升级到&nbsp;Windows&nbsp;2000，您可以升级到&nbsp;SQL&nbsp;Server、ADO、VBScript&nbsp;和&nbsp;JScript、MSXML、Internet&nbsp;Explorer&nbsp;和&nbsp;NT&nbsp;4&nbsp;Service&nbsp;Packs&nbsp;的最新版本。它们均可提高性能和可靠性。&nbsp;<br />
<br />
技巧&nbsp;26：优化&nbsp;Web&nbsp;服务器&nbsp;<br />
有多种&nbsp;IIS&nbsp;优化参数可以改善站点性能。例如，对于&nbsp;IIS&nbsp;4.0，我们常常发现，增加&nbsp;ASP&nbsp;ProcessorThreadMax&nbsp;参数（参见&nbsp;IIS&nbsp;文档）可以显著改善性能，特别是在倾向于等待后端资源（如数据库）或其它中间产品（如屏幕刷）的站点上。在&nbsp;IIS&nbsp;5.0&nbsp;中，您可能发现启用&nbsp;ASP&nbsp;Thread&nbsp;Gating&nbsp;比查找一个&nbsp;AspProcessorThreadMax&nbsp;最佳设置效率更高，这一点现在已为大家所熟知。&nbsp;<br />
<br />
有关较好的参考资料，参见下面的优化&nbsp;IIS。&nbsp;<br />
<br />
最佳的配置设置取决于（其中一些因素）应用程序代码、运行所在的系统硬件和客户机工作负荷。找到最佳设置的唯一方法是进行性能测试，这是我们在下一个技巧中所要讨论的。&nbsp;<br />
<br />
技巧&nbsp;27：进行性能测试&nbsp;<br />
正如我们在前面已经讲过，性能是一个特征。如果您想要改善站点的性能，那么就制定一个性能目标，然后逐步改进，直到达到目标为止。不要，就不进行任何性能测试。通常，在项目结束时，再作必需的结构调整已经为时太晚，您的客户将为此感到失望。将性能测试作为您日常测试的一部分来进行。可以对单个组件分别进行性能测试，如针对&nbsp;ASP&nbsp;页或&nbsp;COM&nbsp;对象，或将站点作为一个整体来测试。&nbsp;<br />
<br />
许多人使用单个浏览器请求页面，来测试&nbsp;Web&nbsp;站点的性能。这样做就会给您一个感觉，即站点的响应能力很好，但这样做实际上并不能告诉您在负载条件下站点的性能如何。&nbsp;<br />
<br />
一般情况下，要想准确地测试性能，您需要一个专门的测试环境。此环境应包括硬件，其处理器速度、处理器数量、内存、磁盘、网络配置等方面与生产环境的硬件相似。其次，您必须指定客户机的工作负荷：有多少同时的用户，他们发出请求的频率，他们点击页面的类型等等。如果您没有站点实际使用情况的数据，您必须估计一下使用的情况。最后，您需要一个可以模拟预期客户机工作负荷的工具。有了这些工具，您就可以开始回答诸如&ldquo;如果我有&nbsp;N&nbsp;个同时的用户，那么需要多少服务器？&rdquo;之类的问题。您还可以找出出现瓶颈的原因，并以此为目标进行优化。&nbsp;<br />
<br />
下面列出了一些好的&nbsp;Web&nbsp;负载测试工具。我们特别推荐&nbsp;Microsoft&nbsp;Web&nbsp;Application&nbsp;Stress&nbsp;(WAS)&nbsp;工具包。WAS&nbsp;可使您记录测试脚本，然后模拟数百或成千上万个用户访问&nbsp;Web&nbsp;服务器。WAS&nbsp;报告很多统计信息，包括每秒钟的请求数，响应时间分布情况和错误计数。WAS&nbsp;有丰富的客户机界面和基于&nbsp;Web&nbsp;的界面两种，Web&nbsp;界面可使您进行远程测试。&nbsp;<br />
<br />
一定要阅读&nbsp;IIS&nbsp;5.0&nbsp;Tuning&nbsp;Guide。&nbsp;<br />
<br />
技巧&nbsp;28：阅读资源链接&nbsp;<br />
下面是一些与性能有关的出色的资源链接。如果您想了解有关信息，请阅读&nbsp;Developing&nbsp;Scalable&nbsp;Web&nbsp;Applications。&nbsp;<br />
<br />
资源<br />
优化&nbsp;ASP&nbsp;脚本<br />
<br />
优化&nbsp;IIS<br />
<br />
ADO&nbsp;和&nbsp;SQL&nbsp;Server<br />
<br />
ASP&nbsp;组件和线程模型&nbsp;<br />
<br />
词典组件<br />
<br />
会话状态<br />
<br />
性能和可扩展性&nbsp;<br />
<br />
工具<br />
<br />
书目<br />
<br />
ASP&nbsp;Web&nbsp;站点<br />
<br />
ASP&nbsp;样式<br />
<br />
XML<br />
<br />
优化&nbsp;ASP&nbsp;脚本&nbsp;<br />
Developing&nbsp;Scalable&nbsp;Web&nbsp;Applications&nbsp;<br />
<br />
Got&nbsp;Any&nbsp;Cache?&nbsp;Nancy&nbsp;Winnick&nbsp;Cluts&nbsp;著&nbsp;<br />
<br />
Maximizing&nbsp;the&nbsp;Performance&nbsp;of&nbsp;Your&nbsp;Active&nbsp;Server&nbsp;Pages，Nancy&nbsp;Winnick&nbsp;Cluts&nbsp;著&nbsp;<br />
<br />
15&nbsp;Seconds:&nbsp;Performance&nbsp;Section&nbsp;<br />
<br />
Enhancing&nbsp;Performance&nbsp;in&nbsp;ASP&nbsp;-&nbsp;Part&nbsp;I，Wayne&nbsp;Plourde&nbsp;著&nbsp;<br />
<br />
When&nbsp;is&nbsp;Better&nbsp;Worse?&nbsp;Weighing&nbsp;the&nbsp;Technology&nbsp;Trade-Offs，Nancy&nbsp;Winnick&nbsp;Cluts&nbsp;著&nbsp;<br />
<br />
Speed&nbsp;and&nbsp;Optimization&nbsp;Resources，Charles&nbsp;Carroll&nbsp;著&nbsp;<br />
<br />
优化&nbsp;IIS&nbsp;<br />
The&nbsp;Art&nbsp;and&nbsp;Science&nbsp;of&nbsp;Web&nbsp;Server&nbsp;Tuning&nbsp;with&nbsp;Internet&nbsp;Information&nbsp;Services&nbsp;5.0&nbsp;<br />
<br />
Leveraging&nbsp;ASP&nbsp;in&nbsp;IIS&nbsp;5.0，J.D.&nbsp;Meier&nbsp;著&nbsp;<br />
<br />
Tuning&nbsp;IIS&nbsp;4.0&nbsp;for&nbsp;High&nbsp;Volume&nbsp;Sites，Michael&nbsp;Stephenson&nbsp;著&nbsp;<br />
<br />
Tuning&nbsp;Internet&nbsp;Information&nbsp;Server&nbsp;Performance，Mike&nbsp;Moore&nbsp;著&nbsp;<br />
<br />
Navigating&nbsp;the&nbsp;Maze&nbsp;of&nbsp;Settings&nbsp;for&nbsp;Web&nbsp;Server&nbsp;Performance&nbsp;Optimization，Todd&nbsp;Wanke&nbsp;著&nbsp;<br />
<br />
Managing&nbsp;Internet&nbsp;Information&nbsp;Server&nbsp;4.0&nbsp;for&nbsp;Performance，Hans&nbsp;Hugli&nbsp;著&nbsp;<br />
<br />
ADO&nbsp;和&nbsp;SQL&nbsp;Server&nbsp;<br />
Top&nbsp;Ten&nbsp;Tips:&nbsp;Accessing&nbsp;SQL&nbsp;Through&nbsp;ADO&nbsp;and&nbsp;ASP，J.D.&nbsp;Meier&nbsp;著&nbsp;<br />
<br />
Improve&nbsp;the&nbsp;Performance&nbsp;of&nbsp;your&nbsp;MDAC&nbsp;Application，Suresh&nbsp;Kannan&nbsp;著&nbsp;<br />
<br />
Pooling&nbsp;in&nbsp;the&nbsp;Microsoft&nbsp;Data&nbsp;Access&nbsp;Components，Leland&nbsp;Ahlbeck&nbsp;和&nbsp;Don&nbsp;Willits&nbsp;合著&nbsp;<br />
<br />
SQL&nbsp;Server:&nbsp;Performance&nbsp;Benchmarks&nbsp;and&nbsp;Guides&nbsp;<br />
<br />
Improving&nbsp;the&nbsp;Performance&nbsp;of&nbsp;Data&nbsp;Access&nbsp;Components&nbsp;with&nbsp;IIS&nbsp;4.0，Leland&nbsp;Ahlbeck&nbsp;著&nbsp;<br />
<br />
Microsoft&nbsp;Data&nbsp;Access&nbsp;Components&nbsp;(MDAC)&nbsp;and&nbsp;ActiveX&nbsp;Data&nbsp;Objects&nbsp;(ADO)&nbsp;Performance&nbsp;Tips，Leland&nbsp;Ahlbeck&nbsp;著&nbsp;<br />
<br />
Microsoft&nbsp;SQL&nbsp;Server&nbsp;7.0&nbsp;Practical&nbsp;Performance&nbsp;Tuning&nbsp;and&nbsp;Optimization&nbsp;-&nbsp;The&nbsp;Server&nbsp;Perspective，Damien&nbsp;Lindauer&nbsp;著&nbsp;<br />
<br />
Microsoft&nbsp;SQL&nbsp;Server&nbsp;7.0&nbsp;Practical&nbsp;Performance&nbsp;Tuning&nbsp;and&nbsp;Optimization&nbsp;-&nbsp;The&nbsp;Application&nbsp;Perspective，Damien&nbsp;Lindauer&nbsp;著&nbsp;<br />
<br />
Accessing&nbsp;Recordsets&nbsp;over&nbsp;the&nbsp;Internet，Dino&nbsp;Esposito&nbsp;著&nbsp;<br />
<br />
ASP&nbsp;组件和线程模型&nbsp;<br />
ASP&nbsp;Component&nbsp;Guidelines，J.D.&nbsp;Meier&nbsp;著&nbsp;<br />
<br />
Q243548:&nbsp;INFO:&nbsp;Design&nbsp;Guidelines&nbsp;for&nbsp;VB&nbsp;Components&nbsp;under&nbsp;ASP&nbsp;<br />
<br />
Threading&nbsp;Models&nbsp;Explained，Nancy&nbsp;Winnick&nbsp;Cluts&nbsp;著&nbsp;<br />
<br />
So&nbsp;Happy&nbsp;Together?&nbsp;Using&nbsp;ActiveX&nbsp;components&nbsp;with&nbsp;Active&nbsp;Server&nbsp;Pages，Nancy&nbsp;Winnick&nbsp;Cluts&nbsp;著&nbsp;<br />
<br />
Developing&nbsp;Active&nbsp;Server&nbsp;Components&nbsp;with&nbsp;ATL，George&nbsp;Reilly&nbsp;著&nbsp;<br />
<br />
Agility&nbsp;in&nbsp;Server&nbsp;Components，Neil&nbsp;Allain&nbsp;著&nbsp;<br />
<br />
Building&nbsp;High-Performance&nbsp;Middle-Tier&nbsp;Components&nbsp;with&nbsp;C++，Jon&nbsp;Flanders&nbsp;著&nbsp;<br />
<br />
Active&nbsp;Server&nbsp;Pages&nbsp;and&nbsp;COM&nbsp;Apartments，Don&nbsp;Box&nbsp;著&nbsp;<br />
<br />
House&nbsp;of&nbsp;COM:&nbsp;Active&nbsp;Server&nbsp;Pages，Don&nbsp;Box&nbsp;著&nbsp;<br />
<br />
House&nbsp;of&nbsp;COM:&nbsp;Contexts，Don&nbsp;Box&nbsp;著&nbsp;<br />
<br />
House&nbsp;of&nbsp;COM:&nbsp;Performance&nbsp;Trade-offs&nbsp;of&nbsp;the&nbsp;Windows&nbsp;2000&nbsp;Component&nbsp;Execution&nbsp;Environment，Don&nbsp;Box&nbsp;著&nbsp;<br />
<br />
Building&nbsp;COM&nbsp;Components&nbsp;That&nbsp;Take&nbsp;Full&nbsp;Advantage&nbsp;of&nbsp;Visual&nbsp;Basic&nbsp;and&nbsp;Scripting，Ivo&nbsp;Salmre&nbsp;著&nbsp;<br />
<br />
Component&nbsp;Design&nbsp;Principles&nbsp;for&nbsp;MTS&nbsp;<br />
<br />
词典组件&nbsp;<br />
Creating&nbsp;a&nbsp;Page&nbsp;Cache&nbsp;Object，Robert&nbsp;Coleridge&nbsp;著&nbsp;<br />
<br />
Abridging&nbsp;the&nbsp;Dictionary&nbsp;Object:&nbsp;The&nbsp;ASP&nbsp;Team&nbsp;Creates&nbsp;a&nbsp;Lookup-Table&nbsp;Object，Robert&nbsp;Carter&nbsp;著&nbsp;<br />
<br />
Caprock&nbsp;Dictionary&nbsp;<br />
<br />
Site&nbsp;Server&nbsp;Commerce&nbsp;Edition&nbsp;includes&nbsp;a&nbsp;dictionary&nbsp;component&nbsp;<br />
<br />
会话状态&nbsp;<br />
Q175167:&nbsp;HOWTO:&nbsp;Persisting&nbsp;Values&nbsp;Without&nbsp;Sessions&nbsp;<br />
<br />
Q157906:&nbsp;HOWTO:&nbsp;How&nbsp;To&nbsp;Maintain&nbsp;State&nbsp;Across&nbsp;Pages&nbsp;with&nbsp;VBScript&nbsp;<br />
<br />
XML-based&nbsp;Persistence&nbsp;Behaviors&nbsp;Fix&nbsp;Web&nbsp;Farm&nbsp;Headaches，Aaron&nbsp;Skonnard&nbsp;著&nbsp;<br />
<br />
House&nbsp;of&nbsp;COM:&nbsp;Stateless&nbsp;Programming，Don&nbsp;Box&nbsp;著&nbsp;<br />
<br />
性能和扩展性&nbsp;<br />
Blueprint&nbsp;for&nbsp;Building&nbsp;Web&nbsp;Sites&nbsp;Using&nbsp;the&nbsp;Microsoft&nbsp;Windows&nbsp;DNA&nbsp;Platform&nbsp;<br />
<br />
Server&nbsp;Performance&nbsp;and&nbsp;Scalability&nbsp;Killers，George&nbsp;Reilly&nbsp;著&nbsp;<br />
<br />
Microsoft&nbsp;Visual&nbsp;Studio&nbsp;Scalability&nbsp;Center&nbsp;<br />
<br />
Fitch&nbsp;&amp;&nbsp;Mather&nbsp;Stocks&nbsp;2000&nbsp;<br />
<br />
Tuning&nbsp;the&nbsp;FMStocks&nbsp;Application&nbsp;<br />
<br />
High-Performance&nbsp;Visual&nbsp;Basic&nbsp;Apps，Ken&nbsp;Spencer&nbsp;著&nbsp;<br />
<br />
Duwamish&nbsp;Books，Phase&nbsp;4&nbsp;<br />
<br />
Top&nbsp;Windows&nbsp;DNA&nbsp;Performance&nbsp;Mistakes&nbsp;and&nbsp;How&nbsp;to&nbsp;Prevent&nbsp;Them，Gary&nbsp;Geiger&nbsp;和&nbsp;Jon&nbsp;Pulsipher&nbsp;合著&nbsp;<br />
<br />
Building&nbsp;from&nbsp;Static&nbsp;HTML&nbsp;to&nbsp;High-Performance&nbsp;Web-Farms，Shawn&nbsp;Bice&nbsp;著&nbsp;<br />
<br />
工具&nbsp;<br />
Microsoft&nbsp;Web&nbsp;Application&nbsp;Stress&nbsp;Tool&nbsp;<br />
<br />
I&nbsp;Can&#39;t&nbsp;Stress&nbsp;It&nbsp;Enough&nbsp;--&nbsp;Load&nbsp;Test&nbsp;Your&nbsp;ASP&nbsp;Application，J.D.&nbsp;Meier&nbsp;著&nbsp;<br />
<br />
Windows&nbsp;DNA&nbsp;Performance&nbsp;Kit&nbsp;<br />
<br />
Monitoring&nbsp;Events&nbsp;in&nbsp;Distributed&nbsp;Applications&nbsp;Using&nbsp;Visual&nbsp;Studio&nbsp;Analyzer，Mai-lan&nbsp;Tomsen&nbsp;著&nbsp;<br />
<br />
书目&nbsp;<br />
Professional&nbsp;Active&nbsp;Server&nbsp;Pages&nbsp;3.0，Wrox&nbsp;Press（特别是第&nbsp;26&nbsp;章：Optimizing&nbsp;ASP&nbsp;Performance，George&nbsp;Reilly&nbsp;和&nbsp;Matthew&nbsp;Gibbs&nbsp;合著）。&nbsp;<br />
<br />
Microsoft&nbsp;Internet&nbsp;Information&nbsp;Services&nbsp;5.0&nbsp;Resource&nbsp;Guide（与&nbsp;Windows&nbsp;2000&nbsp;Server&nbsp;Resource&nbsp;Kit&nbsp;在一起），Microsoft&nbsp;Press。&nbsp;<br />
<br />
Microsoft&nbsp;Internet&nbsp;Information&nbsp;Server&nbsp;Resource&nbsp;Kit（用于&nbsp;IIS&nbsp;4.0），Microsoft&nbsp;Press。&nbsp;<br />
<br />
Programming&nbsp;Distributed&nbsp;Applications&nbsp;with&nbsp;COM&nbsp;and&nbsp;Microsoft&nbsp;Visual&nbsp;Basic&nbsp;6.0，Ted&nbsp;Pattison&nbsp;著，Microsoft&nbsp;Press。&nbsp;<br />
<br />
Effective&nbsp;COM，Don&nbsp;Box、Keith&nbsp;Brown、Tim&nbsp;Ewald&nbsp;和&nbsp;Chris&nbsp;Sells&nbsp;合著；Addison-Wesley。&nbsp;<br />
<br />
Developing&nbsp;Web&nbsp;Usability:&nbsp;The&nbsp;Practice&nbsp;of&nbsp;Simplicity，Jakob&nbsp;Nielsen&nbsp;著，New&nbsp;Riders。&nbsp;<br />
<br />
ASP&nbsp;Web&nbsp;站点&nbsp;<br />
Microsoft&nbsp;TechNet&nbsp;for&nbsp;IIS&nbsp;<br />
<br />
LearnASP.com&nbsp;<br />
<br />
4GuysFromRolla.com&nbsp;<br />
<br />
15Seconds.com&nbsp;<br />
<br />
AspToday.com&nbsp;<br />
<br />
Asp101.com&nbsp;<br />
<br />
AspLists.com。许多专业的邮件列表包括：&nbsp;<br />
<br />
Fast&nbsp;Code!&nbsp;<br />
ASP&nbsp;Advanced&nbsp;<br />
Not&nbsp;NewbieState&nbsp;Management&nbsp;<br />
Scalability&nbsp;<br />
Visual&nbsp;Basic&nbsp;Components&nbsp;<br />
XML&nbsp;<br />
C++/ATL&nbsp;Component&nbsp;Building&nbsp;<br />
UseIt.com:&nbsp;Web&nbsp;可用性&nbsp;<br />
<br />
ASP&nbsp;样式&nbsp;<br />
ASP&nbsp;Best&nbsp;Practices，George&nbsp;Reilly&nbsp;著&nbsp;<br />
<br />
ASP&nbsp;Quick&nbsp;Lessons，Charles&nbsp;Carroll&nbsp;著&nbsp;<br />
<br />
Planning&nbsp;for&nbsp;ASP，John&nbsp;Meade&nbsp;著&nbsp;<br />
<br />
ASP&nbsp;Guidelines，J.D.&nbsp;Meier&nbsp;著&nbsp;<br />
<br />
XML&nbsp;<br />
Inside&nbsp;XML&nbsp;Performance，Chris&nbsp;Lovett&nbsp;著&nbsp;<br />
<br />
Inside&nbsp;MSXML3&nbsp;Performance，Chris&nbsp;Lovett&nbsp;著</div>
  		  <!-- 将此标记放在您希望显示like按钮的位置 -->          
            <div class="art_like"><div class="bdlikebutton"></div></div>
          </div>
        </div>
      </div>
      <div class="pnum">
        <div class="pages mypagelist">
          <div></div>
        </div>
      </div>
      <div class="pre_next">
        <nav>
          <ul class="pager">
            <li class="previous">上一篇：<a href='/bcsj/aspnet/2015/0513/777.html'>ASP中Split函数的实例</a> </li>
            <li class="next">下一篇：<a href='/bcsj/aspnet/2015/0513/779.html'>实例演练ASP+XML编程</a> </li>
          </ul>
        </nav>
      </div>
      <div class="well"> 
    		如果你有好的<a href="http://www.win10os.com/win10zixun" title="win10资讯">win10资讯</a>或者<a href="http://www.win10os.com/win10jiqiao" title="win10教程">win10教程</a>，以及<a href="http://www.win10os.com/win10xitong" title="win10">win10</a>相关的问题想要获得<a href="http://www.win10os.com/win10xiazai" title="win10系统下载">win10系统下载</a>的关注与报道。<br/>欢迎加入发送邮件到657025171#qq.com(#替换为@)。期待你的好消息！
    	</div>  
      <div class="row">
        
          
        
      </div>
    </div>
    <!--右侧部分-->
    <div class="col-sm-4 col-md-4">
      <script src='/plus/ad_js.php?aid=12' language='javascript'></script>
      <div class="panel panel-custom panel-custom-right">
        <div class="panel-heading">最新文章>>></div>
        <div class="panel-body">
          <ul class="all_list">
            <li><a href="/bcsj/aspnet/2015/0515/806.html" >ASP下实现多条件模糊查询SQL语句</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/805.html" >ASP网站漏洞及入侵防范方法</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/804.html" >如何动态创建网页的RSS内容摘要</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/803.html" >ASP动态网页开发中的WEB打印代码大全</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/802.html" >VS2010快捷键</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/801.html" >获得当前带参数的页面地址</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/800.html" >Global.asa文件用法详解</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/799.html" >替换DISTINCT查找重复记录的方法</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/798.html" >用XMLHTTP解析图片地址并保存</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/797.html" >ASP小偷中可控制删除文本html标签的函数</a><span>05.15</span></li>
 
          </ul>
        </div>
      </div>  
      <script src='/plus/ad_js.php?aid=14' language='javascript'></script>
      <div id="scr_cont" class="panel panel-custom panel-custom-right">
        <div class="panel-heading">相关热门>>></div>
        <div class="panel-body">
          <ul class="all_list">
            <li><a href="/bcsj/aspnet/2015/0515/802.html" >VS2010快捷键</a><span>70</span></li>
<li><a href="/bcsj/aspnet/2015/0515/804.html" >如何动态创建网页的RSS内容摘要</a><span>61</span></li>
<li><a href="/bcsj/aspnet/2015/0515/806.html" >ASP下实现多条件模糊查询SQL语句</a><span>54</span></li>
<li><a href="/bcsj/aspnet/2015/0305/176.html" >ASP实现可显隐的树型菜单</a><span>49</span></li>
<li><a href="/bcsj/aspnet/2015/0515/801.html" >获得当前带参数的页面地址</a><span>49</span></li>
<li><a href="/bcsj/aspnet/2015/0515/799.html" >替换DISTINCT查找重复记录的方法</a><span>48</span></li>
<li><a href="/bcsj/aspnet/2015/0515/805.html" >ASP网站漏洞及入侵防范方法</a><span>47</span></li>
<li><a href="/bcsj/aspnet/2015/0513/779.html" >实例演练ASP+XML编程</a><span>36</span></li>
<li><a href="/bcsj/aspnet/2015/0513/789.html" >重新安装IIS的方法</a><span>36</span></li>
<li><a href="/bcsj/aspnet/2015/0515/798.html" >用XMLHTTP解析图片地址并保存</a><span>36</span></li>
 
          </ul>
          </ul>
        </div>
      </div>
      <script src='/plus/ad_js.php?aid=15' language='javascript'></script>
    </div>
    
  </div>
  <nav class="navbar navbar-default navbar-fixed-bottom navbar-bottom-custom">
    <div class="container">
      <span class="pull-right navbar-text" id="font_smaller" onclick="changeFont('smaller')">A-</span>&nbsp;&nbsp;<span class="pull-right navbar-text" id="font_bigger" onclick="changeFont('bigger')">A+</span>
    </div>
  </nav>
  <div class="footer">
  <div class="container">
    <div class="foot">
      <br/>
                一起学编程网是一家纯计算机技术学习、电脑学习、IT技术学习交流型网站，一起学编程网站所载文章来源于网络，如果不慎侵犯了您的权益，请联系我们删除！站长QQ：657025171<br/>
               <a href="/aboutus.html">关于我们</a> | <a href="/dashiji.html">大事记</a> | <a href="/jiazhiguan.html">网站价值观</a> | <a href="/contactus.html">联系我们</a> | <a href="/submenu.html">网站地图</a> | <a href="/copyright.html">版权声明</a> | <a href="/changwei.html">长尾关键词</a> <br/>
              Copyright ◎ 2011 - 2017 yqxbc.com All Rights Reserved.<br/>yqxbc.com 版权所有  <a href="http://www.miit.gov.cn/n11293472/index.html" target="_blank">京ICP备11048740号</a><br/>
        
    </div>
  </div>
</div> 
  <span id="count_data" style="display:none">
    <script src="/plus/count.php?view=yes&aid=778&mid=1" type='text/javascript' language="javascript">
    </script>
  </span>
  <script type="text/javascript">
    document.getElementById('count').innerHTML = document.getElementById('count_data').innerHTML;
  </script>
    <script>
      var img = $(".art_content p").find("img")
      $.each(img,function(index,el){
        el.style.width='100%';
      });
    </script>

  <!-- 将此代码放在适当的位置，建议在body结束前 -->
  <script id="bdlike_shell"></script>
  <script>

  var bdShare_config = {

  	"type":"large",

  	"color":"blue",

  	"likeText":"内容很精彩",

  	"likedText":"您已顶过，谢谢！"

  };

  document.getElementById("bdlike_shell").src="http://bdimg.share.baidu.com/static/js/like_shell.js?t=" + Math.ceil(new Date()/3600000);

  </script>
</body>
</html>