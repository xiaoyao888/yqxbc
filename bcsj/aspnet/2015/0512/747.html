<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>ASP中实现分页显示的七种武器_一起学编程网_为你而生的电脑知识网站_win10系统下载_一起学编程网</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords" content="ASP中实现分页显示的七种" />
  <meta name="description" content="在微软的ASP编程体系中，ADO对象的建立，使得从网页访问数据库成为一件易事，特别是ADO的Recordset对象使得控制数据的输出显示更为方便、自由。而在VisualInterDev6.0(以下简称VI6.0)中，由" />
  	<!-- Bootstrap core CSS -->
	<link href="/templets/default/css/bootstrap.min.css" rel="stylesheet">
	<!-- Bootstrap theme -->
	<link href="/templets/default/css/bootstrap-theme.min.css" rel="stylesheet">

	<!-- Custom styles for this template -->
	<link href="/templets/default/css/theme.css" rel="stylesheet">

	<!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
	<!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
	<script src="/templets/default/js/ie-emulation-modes-warning.js"></script>

	<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
	<script src="/templets/default/js/ie10-viewport-bug-workaround.js"></script>

	<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
	  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
	<script src="/templets/default/js/jquery-2.1.3.js"></script>
	<script src="/templets/default/js/bootstrap.min.js"></script>
	<script src="/templets/default/js/docs.min.js"></script>
	<link href="/templets/default/css/main.css" rel="stylesheet">
	<script src="/templets/default/js/main.js"></script>

  <script src="/templets/default/js/article.js"></script>
<!-- zftb.cn Baidu tongji analytics -->
<script>
var _hmt = _hmt || [];
(function() {
var hm = document.createElement("script");
hm.src = "//hm.baidu.com/hm.js?01a1ff7b6ab0650920aa64bf8bfad7e2";
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();
</script>
</head>
<body>
      <nav class="navbar navbar-default">

      <div class="container" style="margin-top:0px;">

        <div class="row" style="line-height:45px;">

          学习电脑知识上一起学编程网，www.zftb.cn！<span class="hidden-xs"><a href="javascript:void(0)" class="pull-right" onclick="alert('按Ctrl+D收藏本站')" title="win10系统">收藏本站</a></span>

        </div>

      </div>      

    </nav>

    <div class="container" style="margin-top:0px;">
      <div class="row" >

        <div class="col-sm-8 col-md-8">

            <a href="/index.html"><img src="/templets/default/images/logo.png" alt="Windows10系统下载,Win10激活,Win10教程" width="196" height="64"/></a>

        </div>
        <div class="col-sm-4 col-md-4">
        <div style="height:45px;">
        <form  method="post" id="searchFrm" role="search" action="/plus/search.php">
            <div class="input-group">
                <input type="text" class="form-control" id="keyword" name="keyword" placeholder="Search">
                <span class="input-group-btn">
                    <button type="button" class="btn btn-default" onclick="searchKey()">搜索</button>
                </span>
            </div><!-- /input-group -->
          </form>
        </div>
        </div>
      </div>
    </div>

    <nav class="navbar navbar-default navbar-custom">

      <div class="container">


<!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header navbar-header-custom">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">首页</a>
        </div>


        <!-- Collect the nav links, forms, and other content for toggling -->

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

          <ul class="nav navbar-nav nav-custom">
             <li class="dropdown">

              <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">电脑知识<span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="/dnzs" title="电脑基础知识学习，计算机技术学习网站，计算机基础知识,电脑学习">电脑知识 <span class="sr-only">(current)</span></a></li>

                <li><a href="/wlzs" title="网络知识大全">网络知识</a></li>

              </ul>

            </li>



            <li class="dropdown">

              <a href="/czxt" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">操作系统<span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="http://www.win10os.com" title="windows10系统">windows10</a></li>                

                <li><a href="/czxt/linux" title="linux系统">linux</a></li>

              </ul>

            </li>

            
            <li class="dropdown">

              <a href="/bcsj" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">编程设计<span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="/bcsj/css" title="css">css</a></li>

                <li><a href="/bcsj/java" title="java">java</a></li>

                <li><a href="/bcsj/php" title="php">php</a></li>

                <li><a href="/bcsj/aspnet" title="aspnet">aspnet</a></li>

                <li><a href="/bcsj/js" title="javascript">javascript</a></li>

                <li><a href="/bcsj/ajax" title="ajax">ajax</a></li>

                <li><a href="/bcsj/hadoop" title="hadoop">hadoop</a></li>                

              </ul>

            </li>     

            <li class="dropdown">

              <a href="/shujuku" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">数据库 <span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="/shujuku/sqlserver" title="sql server数据库">SqlServer</a></li>

                <li><a href="/shujuku/mysql" title="MySQL数据库">MySql</a></li>                

                <li><a href="/shujuku/oracle" title="Oracle数据库">Oracle</a></li>                

                <li><a href="/shujuku/mangodb" title="MangoDB数据库">MangoDB</a></li>                

                <li><a href="/shujuku/hbase" title="HBase数据库">HBase</a></li>

                <li><a href="/shujuku/db2" title="DB2数据库">DB2</a></li>

                <li><a href="/shujuku/redis" title="Redis数据库">Redis</a></li>

              </ul>

            </li>


            <li><a href='/tools/json.html' target="_blank" title="二维码生成">常用工具</a></li>
          </ul>

          
        </div><!-- /.navbar-collapse -->

      </div><!-- /.container-fluid -->

    </nav>

    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">

       <div class="modal-dialog">

          <div class="modal-content">

             <div class="modal-header">

                <button type="button" class="close" data-dismiss="modal" 

                   aria-hidden="true">×

                </button>

                <h4 class="modal-title" id="myModalLabel">

                   搜索提示

                </h4>

             </div>

             <div class="modal-body">

                <div style="height:60px;line-height:60px;">

                  关键字不能小于2个字！

                </div>

             </div>

          </div><!-- /.modal-content -->

       </div><!-- /.modal-dialog -->

    </div><!-- /.modal -->
<script type="text/javascript">
  function searchKey(){
    var keyword = $("#keyword").val();
    if(keyword.length<2){
      $('#myModal').modal('show');     
      return;
    }else{
      $("#searchFrm").submit();
    }

  }
</script>
  <div class="modal fade" id="imgModal" tabindex="-1" role="dialog" aria-hidden="true">
	   <div class="modal-dialog">
		  <div class="modal-content">
			 <div class="modal-body">
				<div id="modal_img" ></div>
			 </div>
		  </div>
	   </div>
	</div>
  <div class="container" style="padding-left:0px;padding-right:0px">
    
    <div class="col-sm-8  col-md-8">
      <ol class="breadcrumb">
      当前位置：<a href='http://www.zftb.cn/'>首页</a> > <a href='/bcsj/'>编程设计</a> > <a href='/bcsj/aspnet/'>aspnet</a> >
      </ol>
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="art_title">
            <h3>ASP中实现分页显示的七种武器</h3>
            <a href="http://www.zftb.cn" title="http://www.zftb.cn">http://www.zftb.cn</a>&nbsp;  发布时间：2015-05-12 09:15 来源：一起学编程网 浏览：<span id="count"style="font-size:14px;">加载中</span>次
          </div>
          <div class="art_body">
            <div class="art_share"><div><div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script></div></div>
            <div id="747" class="art_content">&nbsp;&nbsp;&nbsp;&nbsp;在微软的ASP编程体系中，ADO对象的建立，使得从网页访问数据库成为一件易事，特别是ADO的Recordset对象使得控制数据的输出显示更为方便、自由。而在Visual&nbsp;InterDev6.0(以下简称VI6.0)中，由于Script&nbsp;Object&nbsp;Model（以下简称SOM）、Design-Time&nbsp;Control(以下简称DTC)以及Data&nbsp;Environment&nbsp;Object&nbsp;Model(以下简称DEOM)等对象模型的引入，使网页对数据库的访问设计显得更为方便。&nbsp;<br />
<br />
　　因为主题方面的原因，关于数据库的连接，下文只给出代码和简要注释，而把重点放在如何利用Recordset对象（或控件）实现数据记录的分页显示方面。根据我的理解，分页显示的关键就在于对ADO的Recordset对象或DTC（设计时控件）的Recordset控件的属性和方法的熟练把握上。&nbsp;<br />
<br />
　　这七种分页显示的武器概括起来说分四类：&nbsp;<br />
<br />
　　第一、二种我暂取名叫&ldquo;纯ASP法&rdquo;，这也是国内的ASP网站上用得最多的方法，它们的区别仅在实现技巧的不同。这两种方法的实现最易理解，用到的对象概念也最少，对开发环境的要求也最低（只要记事本就行）。可以说，这两种方法的实质还是CGI的编程思想，只是在程序中引入了ADO对象而已。&nbsp;<br />
<br />
　　第四、五种暂取名叫&ldquo;SOM的DHTML法&rdquo;。这两种方法要求在VI6.0的环境下，利用微软提出的脚本对象模型（Script&nbsp;Object&nbsp;Model）和DHTML中Table对象的与数据库绑定的新特性（许多书和文章只介绍了DHTML的CSS特性在样式设计中的运用而忽略介绍其数据绑定特性），实现在客户端控制翻页。但它要求用户的浏览器必须是支持DHTML，如：Microsoft&nbsp;Internet&nbsp;Explorer&nbsp;4.0及以上的版本。&nbsp;<br />
<br />
　　第六种暂取名叫&ldquo;SOM服务器端法&rdquo;。要求在VI6.0的环境下开发，它利用微软提出的脚本对象模型（Script&nbsp;Object&nbsp;Model）中的几个DTC控件：Recordset、PageObject、Grid等在服务器端(客户端)实现翻页控制。这是一种激动人心的、全新的编程方法，它把网页看成对象(这种对象模型和传统的DOM----document&nbsp;object&nbsp;model是有区别的：DOM只能控制客户端，而SOM可控制服务器端和客户端)，它真正实现了网页的面向对象编程。但遗憾的是，也许是我个人能力有限，这种技术我个人认为还不是很成熟，比如，与浏览器的结合还不是很好，这将在后文详细说明。&nbsp;<br />
<br />
　　第七种暂取名叫&ldquo;DEOM法&rdquo;。它也是利用了VI6.0中建立的数据环境对象模型（Data&nbsp;Environment&nbsp;Object&nbsp;Model）建立Recordset对象。这也是在网页编程上比较少见的新方法，与SOM模型相比，自有它的优点，这将在后文详述。&nbsp;<br />
<br />
　　在后面所举的所有例子源代码，都可以直接拷贝使用，你甚至可以不懂其原理，只要把其中的粗斜体字部分换成相应自己的数据库名或字段名就可以了。&nbsp;<br />
<br />
　　在开始详细介绍各种分页方法前，让我们先创建一个数据库：用Office97中的access自创一个Employee.mdb，其中建一个表emp，只设三个字段：emp&nbsp;ID，last&nbsp;name和first&nbsp;name。为什么这么简单，是因为我们关心的是怎样处理recordset的结果。&nbsp;<br />
<br />
　　第一种：参数直接代入法<br />
<br />
　　这种方法是用手工建立Recordset对象，利用其pagesize（每页指定显示记录数），pagecount（总页码数）和absolutepage（当前页码数）属性来控制分页的输出。分页采用＜href＞直接带页码参数的方法来控制翻页。网页的名字为emp1.asp。源代码如下：&nbsp;<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				＜%//建立与employee.mdb数据库的连接。&nbsp;<br />
				Set&nbsp;conn&nbsp;=&nbsp;Server.CreateObject(&quot;ADODB.Connection&quot;)&nbsp;<br />
				conn.Open&nbsp;&quot;driver={Microsoft&nbsp;Access&nbsp;Driver&nbsp;(*.mdb)};dbq=employee.mdb&quot;&nbsp;<br />
				//建立emp表的Recordset对象实例rs。&nbsp;<br />
				Set&nbsp;rs&nbsp;=&nbsp;Server.CreateObject(&quot;ADODB.Recordset&quot;)&nbsp;<br />
				rs.Open&nbsp;&quot;emp&quot;,&nbsp;conn,&nbsp;3&nbsp;<br />
				PageSize&nbsp;=&nbsp;10&nbsp;//pagesize属性指定了每页要显示的记录条数&nbsp;<br />
				Page&nbsp;=&nbsp;CLng(Request(&quot;Page&quot;))&nbsp;&rsquo;string型转化为long型&nbsp;<br />
				If&nbsp;Page&nbsp;＜&nbsp;1&nbsp;Then&nbsp;Page&nbsp;=&nbsp;1&nbsp;<br />
				If&nbsp;Page&nbsp;＞&nbsp;rs.PageCount&nbsp;Then&nbsp;Page&nbsp;=&nbsp;rs.PageCount&nbsp;<br />
				If&nbsp;Page&nbsp;＜＞&nbsp;1&nbsp;Then&nbsp;<br />
				　Response.Write&nbsp;&quot;＜A&nbsp;HREF=emp1.asp?Page=1＞第一页＜/A＞?&quot;&nbsp;<br />
				　Response.Write&nbsp;&quot;＜A&nbsp;HREF=emp1.asp?Page=&quot;&nbsp;&amp;&nbsp;(Page-1)&nbsp;&amp;&nbsp;&quot;＞上一页＜/A＞?&quot;&nbsp;<br />
				End&nbsp;If&nbsp;<br />
				If&nbsp;Page&nbsp;＜＞&nbsp;rs.PageCount&nbsp;Then&nbsp;<br />
				　Response.Write&nbsp;&quot;＜A&nbsp;HREF=emp1.asp?Page=&quot;&nbsp;&amp;&nbsp;(Page+1)&nbsp;&amp;&nbsp;&quot;＞下一页＜/A＞?&quot;&nbsp;<br />
				　Response.Write&nbsp;&quot;＜A&nbsp;HREF=emp1.asp?Page=&quot;&amp;rs.PageCount&nbsp;&amp;&nbsp;&quot;＞最后一页＜/A＞?&quot;&nbsp;<br />
				End&nbsp;If&nbsp;<br />
				Response.write&quot;页码：&quot;&nbsp;&amp;&nbsp;Page&nbsp;&amp;&nbsp;&quot;/&quot;&nbsp;&amp;&nbsp;rs.PageCount&nbsp;&amp;&nbsp;&quot;＜/font＞&quot;&nbsp;<br />
				//每一页的显示&nbsp;<br />
				//显示表头&nbsp;<br />
				Response.Write&nbsp;&quot;＜CENTER＞＜TABLE&nbsp;BORDER=1＞&quot;&nbsp;<br />
				Response.WRITE&nbsp;&quot;＜TR＞＜TD＞&quot;&nbsp;&amp;&nbsp;rs.Fields(&quot;emp&nbsp;ID&quot;).Name&nbsp;&amp;&nbsp;&quot;＜/TD＞&quot;&nbsp;<br />
				Response.WRITE&nbsp;&quot;＜TD＞&quot;&nbsp;&amp;&nbsp;rs.Fields(&quot;last&nbsp;name&quot;).Name&nbsp;&amp;&nbsp;&quot;＜/TD＞&quot;&nbsp;<br />
				Response.WRITE&nbsp;&quot;＜TD＞&quot;&nbsp;&amp;&nbsp;rs.Fields(&quot;first&nbsp;name&quot;).Name&nbsp;&amp;&nbsp;&quot;＜/TD＞＜/TR＞&quot;&nbsp;<br />
				//循环显示每条记录&nbsp;<br />
				rs.AbsolutePage&nbsp;=&nbsp;Page&nbsp;//把页码赋给absolutepage属性从而知当前页的首条记录号&nbsp;<br />
				For&nbsp;iPage&nbsp;=&nbsp;1&nbsp;To&nbsp;rs.PageSize&nbsp;//&nbsp;<br />
				Response.WRITE&nbsp;&quot;＜TR＞＜TD＞&quot;&nbsp;&amp;&nbsp;rs.Fields(&quot;emp&nbsp;ID&quot;).Value&nbsp;&amp;&nbsp;&quot;＜/TD＞&quot;&nbsp;<br />
				Response.WRITE&nbsp;&quot;＜TD＞&quot;&nbsp;&amp;&nbsp;rs.Fields(&quot;first&nbsp;name&quot;).Value&nbsp;&amp;&nbsp;&quot;＜/TD＞&quot;&nbsp;<br />
				Response.WRITE&nbsp;&quot;＜TD＞&quot;&nbsp;&amp;&nbsp;rs.Fields(&quot;last&nbsp;name&quot;).Value&nbsp;&amp;&nbsp;&quot;＜/TD＞＜/TR＞&quot;&nbsp;<br />
				rs.MoveNext&nbsp;<br />
				If&nbsp;rs.EOF&nbsp;Then&nbsp;Exit&nbsp;For&nbsp;<br />
				Next&nbsp;<br />
				Response.Write&nbsp;&quot;＜/TABLE＞＜/CENTER＞&quot;%＞</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　第二种：表单传送参数法&nbsp;<br />
<br />
　　这种方法在创建Recordset对象时与第一种相同，只是在翻页控制时，采用＜input＞和case语句配合来实现翻页。网页的名字为:emp2.asp。此方法在编程逻辑上有个缺点：就是在按过&ldquo;上页&rdquo;或&ldquo;下页&rdquo;钮后，再在浏览器上按刷新按钮时，会自动翻页。源代码如下：&nbsp;<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				if&nbsp;Pagenum&nbsp;=&nbsp;&quot;&quot;&nbsp;Then&nbsp;Pagenum&nbsp;=&nbsp;1&nbsp;//从第一页开始显示&nbsp;<br />
				//建立数据库连接和Recordset对象实例rs。&nbsp;<br />
				与第一种方法相同，此处略过。&nbsp;<br />
				RS.Pagesize&nbsp;=&nbsp;10&nbsp;&rsquo;&nbsp;设置一页中显示的记录条数为10条&nbsp;<br />
				//&nbsp;确定翻页的动作&nbsp;<br />
				Select&nbsp;Case&nbsp;Request(&quot;NAV&quot;)&nbsp;<br />
				Case&nbsp;&quot;&quot;&nbsp;<br />
				　session(&quot;Pagenum&quot;)&nbsp;=&nbsp;1&nbsp;<br />
				case&nbsp;&quot;First&quot;&nbsp;&rsquo;&nbsp;First&nbsp;Record&nbsp;<br />
				　session(&quot;Pagenum&quot;)&nbsp;=&nbsp;1&nbsp;<br />
				case&nbsp;&quot;Prev&quot;&nbsp;&rsquo;&nbsp;Previous&nbsp;Record&nbsp;<br />
				　if&nbsp;session(&quot;Pagenum&quot;)&nbsp;＞&nbsp;1&nbsp;then&nbsp;<br />
				　　session(&quot;Pagenum&quot;)&nbsp;=&nbsp;session(&quot;Pagenum&quot;)&nbsp;-&nbsp;1&nbsp;<br />
				　End&nbsp;If&nbsp;<br />
				case&nbsp;&quot;Next&quot;&nbsp;&rsquo;&nbsp;Next&nbsp;Record&nbsp;<br />
				　if&nbsp;session(&quot;Pagenum&quot;)＜&nbsp;RS.PageCount&nbsp;then&nbsp;<br />
				　　session(&quot;Pagenum&quot;)&nbsp;=&nbsp;session(&quot;Pagenum&quot;)&nbsp;+&nbsp;1&nbsp;<br />
				　End&nbsp;if&nbsp;<br />
				case&nbsp;&quot;Last&quot;&nbsp;&rsquo;&nbsp;Last&nbsp;Record&nbsp;<br />
				　session(&quot;Pagenum&quot;)&nbsp;=&nbsp;RS.PageCount&nbsp;<br />
				End&nbsp;Select&nbsp;<br />
				RS.Absolutepage&nbsp;=&nbsp;Clng(session(&quot;Pagenum&quot;))&nbsp;//确定当前页的第一条记录号&nbsp;<br />
				//&nbsp;显示当前页&nbsp;<br />
				同第一种方法，此处略过。&nbsp;<br />
				//&nbsp;Nav&nbsp;翻页按钮设置&nbsp;<br />
				＜form&nbsp;method=&quot;GET&quot;&nbsp;action=&quot;emp2.asp&quot;＞&nbsp;<br />
				＜input&nbsp;type=&quot;submit&quot;&nbsp;name=&quot;NAV&quot;&nbsp;Value=&quot;首页&quot;＞&nbsp;<br />
				＜input&nbsp;type=&quot;submit&quot;&nbsp;value=&quot;上页&quot;&nbsp;name=&quot;NAV&quot;＞&nbsp;<br />
				＜input&nbsp;type=&quot;submit&quot;&nbsp;value=&quot;下页&quot;&nbsp;name=&quot;NAV&quot;＞&nbsp;<br />
				＜input&nbsp;type=&quot;submit&quot;&nbsp;value=&quot;末页&quot;&nbsp;name=&quot;NAV&quot;＞＜/form＞</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　第三种：用Grid控件设计分页&nbsp;<br />
<br />
　　所有的方法中，这种方法最容易。你只需拖DTC中的Recordset控件和Grid控件到asp网页中就行了。而且，你还能选择是在服务器平台还是在客户端平台控制翻页。缺点就是你必须用它给定的格式显示，而不能自己自由控制表格的显示格式。&nbsp;<br />
<br />
　　方法如下：&nbsp;<br />
<br />
　　在VI6.0中建一个工程emp.vip。再在工程中添加一个asp网页：emp3.asp。&nbsp;<br />
<br />
　　第一步：选VI6.0菜单条上的&ldquo;add&nbsp;data&nbsp;connect&hellip;&rdquo;，按开发工具的导航提示，你就可以很容易地建立与Employee.mdb数据库的连接。从DTC工具栏中拖一个Recordset控件到网页中，并设置其属性。具体如图：&nbsp;<br />
<br />
　　当你拖控件到网页中时，VI6.0会自动提示你&ldquo;是否使用Scripting&nbsp;object&nbsp;model&rdquo;，按yes。&nbsp;<br />
<br />
　　第三步：从DTC工具栏中拖一个Grid控件到网页中，然后单击鼠标右键，设置其属性，如：选在第二步中创建的Recordset控件名，选择emp表中的字段，每页显示多少条记录以及显示格式等。非常简单方便，只要照着导航提示做就行了。<br />
<br />
　　第四种：DHTML法一。&nbsp;<br />
<br />
　　数据记录显示在一个HTML表中。它利用DHTML中表的数据绑定特性来控制记录的分页显示。缺点就是你的翻页方法将被限制为一种特定的方式：只能&ldquo;上页&rdquo;和&ldquo;下页&rdquo;而不能&ldquo;首页&rdquo;和&ldquo;末页&rdquo;。由于是在客户端控制翻页，所以，这种和第五种方法是速度最快的，但遗憾的是它只能在支持DHTML的浏览器上使用。&nbsp;<br />
<br />
　　在DHTML中，＜TABLE＞的DATASRC属性可使表格绑定到一个数据源，另一个属性DATAPAGESIZE可指定一页一次显示的记录数。&nbsp;<br />
<br />
　　我们来看下面的例子：&nbsp;<br />
<br />
　　第一步：拖Recordset控件到新建的网页emp4.htm中，设置其属性，方法同第三种，此处略。&nbsp;<br />
<br />
　　第二步：输入下面的代码：&nbsp;<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				＜TABLE&nbsp;ID=&quot;Table1&quot;&nbsp;DATASRC=&quot;#Recordset1_RDS&quot;&nbsp;DATAPAGESIZE=5＞&nbsp;//假定前面设定Recordset控件名为Recordset1。每页显示5条记录。&nbsp;<br />
				＜THEAD＞&nbsp;<br />
				＜TH&nbsp;ALIGN=&quot;left&quot;&nbsp;WIDTH=150＞Emp&nbsp;ID＜/TH＞&nbsp;//输出表头&nbsp;<br />
				＜TH&nbsp;ALIGN=&quot;left&quot;&nbsp;WIDTH=200＞Last&nbsp;Name＜/TH＞&nbsp;<br />
				＜TH&nbsp;ALIGN=&quot;left&quot;&nbsp;WIDTH=200＞First&nbsp;Name＜/TH＞&nbsp;<br />
				＜/THEAD＞&nbsp;<br />
				＜TR＞&nbsp;<br />
				＜TD＞＜DIV&nbsp;DATAFLD=&quot;Emp&nbsp;ID&quot;＞＜/DIV＞＜/TD＞&nbsp;//输出表内容&nbsp;<br />
				＜TD＞＜DIV&nbsp;DATAFLD=&quot;Last&nbsp;Name&quot;＞＜/DIV＞＜/TD＞&nbsp;<br />
				＜TD＞＜DIV&nbsp;DATAFLD=&quot;First&nbsp;Name&quot;＞＜/DIV＞＜/TD＞&nbsp;<br />
				＜/TR＞&nbsp;<br />
				＜/TABLE＞</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　第三步：然后,增加一对DTCs&nbsp;Button按钮控件来做翻页导航，一个命名为&ldquo;btnPrevious&rdquo;（上一页），一个命名为&ldquo;btnNext&rdquo;（下一页）。它们相应的脚本如下：&nbsp;<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				＜SCRIPT&nbsp;LANGUAGE=VBScript＞&nbsp;<br />
				Function&nbsp;btnPrevious_onclick()&nbsp;<br />
				Table1.previousPage()&nbsp;<br />
				End&nbsp;Function&nbsp;<br />
				Function&nbsp;btnNext_onclick()&nbsp;<br />
				Table1.nextPage()&nbsp;<br />
				End&nbsp;Function&nbsp;<br />
				＜/SCRIPT＞</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
第五种：DHTML法二<br />
<br />
　　这种方法是对第四种方法的完善。采用手工编写脚本的方法，使我们能做&ldquo;首页&rdquo;，&ldquo;末页&rdquo;翻页导航按钮，并能确定每条记录的位置（记录号）。由于篇幅的关系，我在下面只介绍一个具体例子，并给出简要说明。其它关于DHTML和Recordset控件的一些属性和方法请读者自行参照相关书籍。这里需要提请注意的是，Recordset控件与第一、二种方法中介绍的ADO的Recordset对象有些不同：Recordset控件没有直接给出pagesize和pagecount等属性，需要用下面介绍的方法来计算。&nbsp;<br />
<br />
　　第一步：拖Recordset控件到新建的网页emp5.htm中，名字为Recordset1，设置其属性，方法同第三种，此处略。&nbsp;<br />
<br />
　　第二步：定义三个全局变量和编写Recordset1的ondatasetcomplete（数据设置完成时）脚本。<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				Dim&nbsp;gCurrentPageNumber&nbsp;//当前页号&nbsp;<br />
				Dim&nbsp;gMaxPageNumber&nbsp;//最大页数&nbsp;<br />
				Dim&nbsp;gRecordsPerPage&nbsp;//每页显示记录数&nbsp;<br />
				gRecordsPerPage&nbsp;=&nbsp;5&nbsp;//&nbsp;设置每页显示记录数为5条记录。&nbsp;<br />
				Function&nbsp;Recordset1_ondatasetcomplete()&nbsp;<br />
				totalRecordCount&nbsp;=&nbsp;Recordset1.getCount()&nbsp;//总的记录条数&nbsp;<br />
				gMaxPageNumber&nbsp;=&nbsp;Int(totalRecordCount&nbsp;/&nbsp;gRecordsPerPage)&nbsp;//获得最大页数&nbsp;<br />
				If&nbsp;(totalRecordCount&nbsp;Mod&nbsp;gRecordsPerPage)&nbsp;＞&nbsp;0&nbsp;then&nbsp;<br />
				gMaxPageNumber&nbsp;=&nbsp;gMaxPageNumber&nbsp;+&nbsp;1&nbsp;<br />
				End&nbsp;If&nbsp;<br />
				End&nbsp;Function</td>
		</tr>
	</tbody>
</table>
&nbsp;<br />
<br />
　　第三步：创建翻页导航按钮。&nbsp;<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				Function&nbsp;btnFirst_onclick()&nbsp;&rsquo;&nbsp;翻到首页&nbsp;<br />
				　gCurrentPageNumber&nbsp;=&nbsp;1&nbsp;<br />
				　DisplayData()&nbsp;<br />
				End&nbsp;Function&nbsp;<br />
				Function&nbsp;btnPrevious_onclick()&nbsp;&rsquo;&nbsp;翻到上一页&nbsp;<br />
				　if&nbsp;gCurrentPageNumber&nbsp;＞&nbsp;1&nbsp;Then&nbsp;<br />
				　　gCurrentPageNumber&nbsp;=&nbsp;gCurrentPageNumber&nbsp;-&nbsp;1&nbsp;<br />
				　　DisplayData()&nbsp;<br />
				　End&nbsp;If&nbsp;<br />
				End&nbsp;Function&nbsp;<br />
				Function&nbsp;btnNext_onclick()&nbsp;&rsquo;&nbsp;翻到下一页&nbsp;<br />
				　if&nbsp;gCurrentPageNumber&nbsp;＜&nbsp;gMaxPageNumber&nbsp;Then&nbsp;<br />
				　　gCurrentPageNumber&nbsp;=&nbsp;gCurrentPageNumber&nbsp;+&nbsp;1&nbsp;<br />
				　　DisplayData()&nbsp;<br />
				　End&nbsp;If&nbsp;<br />
				End&nbsp;Function&nbsp;<br />
				Function&nbsp;btnLast_onclick()&nbsp;&rsquo;翻到末页&nbsp;<br />
				　gCurrentPageNumber&nbsp;=&nbsp;gMaxPageNumber&nbsp;<br />
				　DisplayData()&nbsp;<br />
				End&nbsp;Function</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　第四步：编写显示每一页的函数。其中使用了许多DHTML的属性和方法，请读者自行参考相关书籍。&nbsp;<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				Sub&nbsp;DisplayData()&nbsp;<br />
				startRecord&nbsp;=&nbsp;((gCurrentPageNumber&nbsp;-&nbsp;1)&nbsp;*&nbsp;gRecordsPerPage)&nbsp;+&nbsp;1&nbsp;//计算每一页开始显示的记录号数（位置，第几条）&nbsp;<br />
				rowCtr&nbsp;=&nbsp;1&nbsp;<br />
				lblPageNumber.innerHTML&nbsp;=&nbsp;gCurrentPageNumber&nbsp;&amp;&nbsp;&quot;/&quot;&nbsp;&amp;&nbsp;gMaxPageNumber&nbsp;<br />
				For&nbsp;recordPtr&nbsp;=&nbsp;startRecord&nbsp;To&nbsp;(startRecord&nbsp;+&nbsp;gRecordsPerPage&nbsp;-&nbsp;1)&nbsp;//循环显示一页的各条记录&nbsp;<br />
				　If&nbsp;recordPtr&nbsp;＞&nbsp;Recordset1.getCount()&nbsp;Then&nbsp;//显示空表&nbsp;<br />
				　　Table1.rows(rowCtr).cells(0).innerHTML&nbsp;=&nbsp;&quot;＜P＞&nbsp;＜/P＞&quot;&nbsp;<br />
				　　Table1.rows(rowCtr).cells(1).innerHTML&nbsp;=&nbsp;&quot;＜P＞&nbsp;＜/P＞&quot;&nbsp;<br />
				　　Table1.rows(rowCtr).cells(2).innerHTML&nbsp;=&nbsp;&quot;＜P＞&nbsp;＜/P＞&quot;&nbsp;<br />
				　　Table1.rows(rowCtr).cells(3).innerHTML&nbsp;=&nbsp;&quot;＜P＞&nbsp;＜/P＞&quot;&nbsp;<br />
				　Else&nbsp;//具体显示每一页&nbsp;<br />
				　　Recordset1.moveAbsolute(recordPtr)&nbsp;//移动记录指针。&nbsp;<br />
				　　empID&nbsp;=&nbsp;Recordset1.fields.getValue(&quot;emp&nbsp;ID&quot;)&nbsp;<br />
				　　empLName&nbsp;=&nbsp;Recordset1.fields.getValue(&quot;first&nbsp;name&quot;)&nbsp;<br />
				　　empFName&nbsp;=&nbsp;Recordset1.fields.getValue(&quot;last&nbsp;name&quot;)&nbsp;<br />
				<br />
				　　Table1.rows(rowCtr).cells(0).innerText&nbsp;=&nbsp;recordPtr&nbsp;&rsquo;&nbsp;Counter&nbsp;<br />
				　　Table1.rows(rowCtr).cells(1).innerText&nbsp;=&nbsp;empID&nbsp;<br />
				　　Table1.rows(rowCtr).cells(2).innerText&nbsp;=&nbsp;empLName&nbsp;<br />
				　　Table1.rows(rowCtr).cells(3).innerText&nbsp;=&nbsp;empFName&nbsp;<br />
				　End&nbsp;If&nbsp;<br />
				　rowCtr&nbsp;=&nbsp;rowCtr&nbsp;+&nbsp;1&nbsp;<br />
				Next&nbsp;<br />
				End&nbsp;Sub</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　另外，我们还需要在window对象的onload事件中编写如下脚本：&nbsp;<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				For&nbsp;rowCtr&nbsp;=&nbsp;1&nbsp;to&nbsp;gRecordsPerPage&nbsp;<br />
				　Table1.insertRow(rowCtr)&nbsp;&rsquo;&nbsp;插一新列&nbsp;<br />
				　For&nbsp;cellCtr&nbsp;=&nbsp;0&nbsp;to&nbsp;3&nbsp;<br />
				　　Table1.rows(rowCtr).insertCell()&nbsp;<br />
				　Next&nbsp;<br />
				Next</td>
		</tr>
	</tbody>
</table>
&nbsp;<br />
<br />
　　第六种：服务器端控制翻页方法。&nbsp;<br />
<br />
　　如果我们在服务器端对数据进行分页形成HTML语句后再输出到客户端，就不会存在浏览器不支持DHTML的问题了。可是用服务器端法使得我们每次翻页时，都得让Recordset控件重新产生一次，因此速度肯定要比用DHTML的方法慢。但如果服务器足够快的话，这点慢客户是察觉不到的。&nbsp;<br />
<br />
　　下面的例子中，我将介绍一个新的DTC控件：PageObject。这个控件使被指定的网页成为一个网页对象，用户在此网页的服务器脚本中组织的子程序和函数可被看作是该网页对象的方法。它提供了管理状态信息的一种先进的方法：网页对象有一些属性（变量），用户可以定义这些属性的生存期。因为以上这些特性，使我们在编制翻页的脚本时非常方便。&nbsp;<br />
<br />
　　但这种方法的缺点是：当你按了&ldquo;上页&rdquo;或&ldquo;下页&rdquo;按钮后，再浏览器上的按刷新按钮，网页会自动翻页。另外，如果按了浏览器上的&ldquo;回退&rdquo;按钮后，再按翻页按钮，可能会出现一次乱翻。这都是因为网页对象属性（全局变量）造成的。&nbsp;<br />
<br />
　　第一步：拖Recordset控件到新建的网页emp6.asp中，名字为Recordset1，设置其属性，方法同第三种，此处略。&nbsp;<br />
<br />
　　第二步：拖PageObject控件到网页中，取名叫emplist。然后右键单击此控件打开属性页并设置MaxPageNumber，RecordsPerPage，CurrrentPageNumber三个属性（全局变量）。VI6.0可用get和set方法来读写它们的值，具体用法请查阅相关资料。<br />
<br />
　　第三步：编写Recordset1的ondatasetcomplete事件。&nbsp;<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				Function&nbsp;Recordset1_ondatasetcomplete()&nbsp;<br />
				recordsPerPage&nbsp;=&nbsp;5&nbsp;<br />
				empList.setRecordsPerPage(recordsPerPage)//设置网页对象每页记录条数属性为5&nbsp;<br />
				totalRecordCount&nbsp;=&nbsp;Recordset1.getCount()//获得记录集的总条数&nbsp;<br />
				mpn&nbsp;=&nbsp;Int(totalRecordCount&nbsp;/&nbsp;recordsPerPage)&nbsp;//计算出mpn为总页数&nbsp;<br />
				If&nbsp;(totalRecordCount&nbsp;Mod&nbsp;recordsPerPage)&nbsp;＞&nbsp;0&nbsp;then&nbsp;<br />
				mpn&nbsp;=&nbsp;mpn&nbsp;+&nbsp;1&nbsp;<br />
				End&nbsp;If&nbsp;<br />
				empList.setMaxPageNumber(mpn)&nbsp;<br />
				End&nbsp;Function</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　第四步：拖四个button控件到网页中，编写翻页控制脚本。我们主要是通过改变网页对象的CurrentPageNumber属性的值来实现翻页。&nbsp;<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				Function&nbsp;btnFirst_onclick()&rsquo;&nbsp;翻到首页&nbsp;<br />
				　empList.setCurrentPageNumber(1)&nbsp;<br />
				End&nbsp;Function&nbsp;<br />
				Function&nbsp;btnPrevious_onclick()&rsquo;&nbsp;翻到上一页&nbsp;<br />
				　cpn&nbsp;=&nbsp;empList.getCurrentPageNumber()&nbsp;<br />
				　if&nbsp;cpn&nbsp;＞&nbsp;1&nbsp;Then&nbsp;<br />
				　　empList.setCurrentPageNumber(cpn&nbsp;-&nbsp;1)&nbsp;<br />
				　End&nbsp;If&nbsp;<br />
				End&nbsp;Function&nbsp;<br />
				Function&nbsp;btnNext_onclick()&rsquo;&nbsp;翻到下一页&nbsp;<br />
				　cpn&nbsp;=&nbsp;empList.getCurrentPageNumber()&nbsp;<br />
				　if&nbsp;cpn&nbsp;＜&nbsp;empList.getMaxPageNumber()&nbsp;then&nbsp;<br />
				　　empList.setCurrentPageNumber(cpn&nbsp;+&nbsp;1)&nbsp;<br />
				　End&nbsp;If&nbsp;<br />
				End&nbsp;Function&nbsp;<br />
				Function&nbsp;btnLast_onclick()&nbsp;&rsquo;&nbsp;翻到末页&nbsp;<br />
				　empList.setCurrentPageNumber(&nbsp;empList.getMaxPageNumber()&nbsp;)&nbsp;<br />
				End&nbsp;Function</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　为保证首次进入该页时，显示的是第一页，我们还得编写该网页对象的onEnter事件。&nbsp;<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				Function&nbsp;empList_onEnter()&nbsp;<br />
				　If&nbsp;empList.firstEntered&nbsp;Then&nbsp;<br />
				　　empList.setCurrentPageNumber(1)&nbsp;<br />
				　End&nbsp;If&nbsp;<br />
				End&nbsp;Function</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　第五步：编写显示每一页的脚本。<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				＜HR＞＜TABLE&nbsp;BORDER=0＞＜TR＞//显示表头&nbsp;<br />
				＜TH&nbsp;ALIGN=&quot;left&quot;&nbsp;WIDTH=35＞＜/TH＞&nbsp;<br />
				＜TH&nbsp;ALIGN=&quot;left&quot;&nbsp;WIDTH=150＞Emp&nbsp;ID＜/TH＞&nbsp;<br />
				＜TH&nbsp;ALIGN=&quot;left&quot;&nbsp;WIDTH=200＞Last&nbsp;Name＜/TH＞&nbsp;<br />
				＜TH&nbsp;ALIGN=&quot;left&quot;&nbsp;WIDTH=200＞First&nbsp;Name＜/TH＞＜/TR＞&nbsp;<br />
				＜%pageNumber&nbsp;=&nbsp;empList.getCurrentPageNumber()//计算翻页所需的各种参数，同DHTML法二&nbsp;<br />
				recordsPerPage&nbsp;=&nbsp;empList.getRecordsPerPage()&nbsp;<br />
				startRecord&nbsp;=&nbsp;((pageNumber&nbsp;-&nbsp;1)&nbsp;*&nbsp;recordsPerPage)&nbsp;+&nbsp;1&nbsp;<br />
				lastRecord&nbsp;=&nbsp;Recordset1.getCount()&nbsp;<br />
				For&nbsp;recordPtr&nbsp;=&nbsp;startRecord&nbsp;To&nbsp;(startRecord&nbsp;+&nbsp;recordsPerPage&nbsp;-&nbsp;1)<br />
				If&nbsp;Recordset1.EOF&nbsp;=&nbsp;True&nbsp;Then%＞&nbsp;<br />
				＜TR＞&nbsp;<br />
				＜TD＞&nbsp;＜/TD＞&nbsp;<br />
				＜TD＞&nbsp;＜/TD＞&nbsp;<br />
				＜TD＞&nbsp;＜/TD＞&nbsp;<br />
				＜TD＞&nbsp;＜/TD＞&nbsp;<br />
				＜/TR＞&nbsp;<br />
				＜%Else%＞&nbsp;<br />
				＜%Recordset1.moveAbsolute(recordPtr)%＞&nbsp;<br />
				＜TR＞&nbsp;<br />
				＜%&nbsp;If&nbsp;recordPtr&nbsp;＜=&nbsp;lastRecord&nbsp;Then&nbsp;%＞&nbsp;<br />
				＜TD＞＜%=recordptr%＞＜/TD＞&nbsp;<br />
				＜%Else%＞&nbsp;<br />
				＜TD＞&nbsp;＜/TD＞&nbsp;<br />
				＜%&nbsp;End&nbsp;If&nbsp;%＞&nbsp;<br />
				＜TD＞＜%=Recordset1.fields.getValue(&quot;emp&nbsp;ID&quot;)%＞＜/TD＞&nbsp;<br />
				＜TD＞＜%=Recordset1.fields.getValue(&quot;last&nbsp;name&quot;)%＞＜/TD＞&nbsp;<br />
				＜TD＞＜%=Recordset1.fields.getValue(&quot;first&nbsp;name&quot;)%＞＜/TD＞&nbsp;<br />
				＜/TR＞&nbsp;<br />
				＜%End&nbsp;If%＞&nbsp;<br />
				＜%Next%＞&nbsp;<br />
				＜/TABLE＞＜HR＞</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　第七种：Data&nbsp;Environment&nbsp;Object&nbsp;Model（数据环境对象模型）法<br />
<br />
　　Data&nbsp;Environment对象模型把ADO对象模型及它的对象----&ldquo;Connection&rdquo;，&ldquo;Command&rdquo;，&ldquo;Recordset&rdquo;，&ldquo;Field&rdquo;以及&ldquo;Parameter&rdquo;对象----抽象到一个更加容易的表单中。Data&nbsp;Environment&nbsp;Object&nbsp;Model把命令显露为方法。用户可以调用这些方法，这些方法会执行这些命令并返回所得到的记录集。关于DEOM对象模型详细资料请参考相关书籍。我们来看下面网页emp7.asp的例子：&nbsp;<br />
<br />
　　第一步：在VI6.0的&ldquo;project&nbsp;Explorer&rdquo;窗口中的工程项目上右击鼠标并从弹出式菜单选择&ldquo;Add&nbsp;Data&nbsp;Connection&rdquo;。根据VI给出的导航提示建立一个到数据库的连接之后，用户就添加了一个实现从ASP应用程序访问数据库的数据命令。同时，你将会在&ldquo;Project&nbsp;Explorer&rdquo;窗口中的global.asa文件下方看到一个&ldquo;Data&nbsp;Environment&rdquo;对象。&nbsp;<br />
<br />
　　第二步：右击&ldquo;Data&nbsp;Environment&rdquo;对象然后从弹出式菜单中选择&ldquo;Add&nbsp;Data&nbsp;Command&rdquo;选项，添加一个数据命令Command1。根据VI6.0的导航提示，你可以在Command1&nbsp;Properties弹出窗口的Genetal页中选SQL&nbsp;Statement，输入：select&nbsp;*&nbsp;from&nbsp;emp。按OK返回。&nbsp;<br />
<br />
　　第三步：你创建了这个数据命令后，就已经为该Data&nbsp;Environment对象创建了一个方法，然后就可以从脚本中调用这个方法，而且该方法将会给用户返回一个记录集。&nbsp;<br />
<br />
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				thisPage.createDE()&nbsp;//在SOM模式下，thisPage表示当前网页对象，createDE()方法创建了DE对象。&nbsp;<br />
				DE.Command1//执行DE对象的命令，后面可代参数，做有条件查询时很有用。&nbsp;<br />
				Set&nbsp;rs=DE.rsCommand1//DE.rscommand1使得rs对象完全等同于一个ADO的Recordset对象。</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　第四步：因为rs为ADO对象，所以，以下的实现翻页代码完全参照以上介绍的几种方法，此处略过。&nbsp;<br />
<br />
　　其它还有如FrontPage2000的数据库导航中实现的方法等，因与本主题无关，此处略。&nbsp;<br />
<br />
　　综上所述，前面介绍的每种方法都包含了很多新的技术，由于篇幅的关系，无法深入。本文只是想通过实现翻页这一具体的例子来介绍ASP网页编程的多种方法；让大家亲身体验一下VI6.0在编制网页中的强大功能；了解和熟悉微软在网页编程中提出的ADO、DHTML、DTC控件、SOM对象模型和DEOM对象模型的使用方法；希望能给大家在编制网页时提供更多的选择和参考。</div>
  		  <!-- 将此标记放在您希望显示like按钮的位置 -->          
            <div class="art_like"><div class="bdlikebutton"></div></div>
          </div>
        </div>
      </div>
      <div class="pnum">
        <div class="pages mypagelist">
          <div></div>
        </div>
      </div>
      <div class="pre_next">
        <nav>
          <ul class="pager">
            <li class="previous">上一篇：<a href='/bcsj/aspnet/2015/0512/745.html'>提高ASP执行效率的几个技巧</a> </li>
            <li class="next">下一篇：<a href='/bcsj/aspnet/2015/0512/748.html'>AspJpeg组件按宽高比例真正缩略图</a> </li>
          </ul>
        </nav>
      </div>
      <div class="well"> 
    		如果你有好的<a href="http://www.win10os.com/win10zixun" title="win10资讯">win10资讯</a>或者<a href="http://www.win10os.com/win10jiqiao" title="win10教程">win10教程</a>，以及<a href="http://www.win10os.com/win10xitong" title="win10">win10</a>相关的问题想要获得<a href="http://www.win10os.com/win10xiazai" title="win10系统下载">win10系统下载</a>的关注与报道。<br/>欢迎加入发送邮件到657025171#qq.com(#替换为@)。期待你的好消息！
    	</div>  
      <div class="row">
        
          
        
      </div>
    </div>
    <!--右侧部分-->
    <div class="col-sm-4 col-md-4">
      <script src='/plus/ad_js.php?aid=12' language='javascript'></script>
      <div class="panel panel-custom panel-custom-right">
        <div class="panel-heading">最新文章>>></div>
        <div class="panel-body">
          <ul class="all_list">
            <li><a href="/bcsj/aspnet/2015/0515/806.html" >ASP下实现多条件模糊查询SQL语句</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/805.html" >ASP网站漏洞及入侵防范方法</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/804.html" >如何动态创建网页的RSS内容摘要</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/803.html" >ASP动态网页开发中的WEB打印代码大全</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/802.html" >VS2010快捷键</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/801.html" >获得当前带参数的页面地址</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/800.html" >Global.asa文件用法详解</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/799.html" >替换DISTINCT查找重复记录的方法</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/798.html" >用XMLHTTP解析图片地址并保存</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/797.html" >ASP小偷中可控制删除文本html标签的函数</a><span>05.15</span></li>
 
          </ul>
        </div>
      </div>  
      <script src='/plus/ad_js.php?aid=14' language='javascript'></script>
      <div id="scr_cont" class="panel panel-custom panel-custom-right">
        <div class="panel-heading">相关热门>>></div>
        <div class="panel-body">
          <ul class="all_list">
            <li><a href="/bcsj/aspnet/2015/0515/802.html" >VS2010快捷键</a><span>70</span></li>
<li><a href="/bcsj/aspnet/2015/0515/804.html" >如何动态创建网页的RSS内容摘要</a><span>61</span></li>
<li><a href="/bcsj/aspnet/2015/0515/806.html" >ASP下实现多条件模糊查询SQL语句</a><span>54</span></li>
<li><a href="/bcsj/aspnet/2015/0305/176.html" >ASP实现可显隐的树型菜单</a><span>49</span></li>
<li><a href="/bcsj/aspnet/2015/0515/801.html" >获得当前带参数的页面地址</a><span>49</span></li>
<li><a href="/bcsj/aspnet/2015/0515/799.html" >替换DISTINCT查找重复记录的方法</a><span>48</span></li>
<li><a href="/bcsj/aspnet/2015/0515/805.html" >ASP网站漏洞及入侵防范方法</a><span>47</span></li>
<li><a href="/bcsj/aspnet/2015/0513/779.html" >实例演练ASP+XML编程</a><span>36</span></li>
<li><a href="/bcsj/aspnet/2015/0513/789.html" >重新安装IIS的方法</a><span>36</span></li>
<li><a href="/bcsj/aspnet/2015/0515/798.html" >用XMLHTTP解析图片地址并保存</a><span>36</span></li>
 
          </ul>
          </ul>
        </div>
      </div>
      <script src='/plus/ad_js.php?aid=15' language='javascript'></script>
    </div>
    
  </div>
  <nav class="navbar navbar-default navbar-fixed-bottom navbar-bottom-custom">
    <div class="container">
      <span class="pull-right navbar-text" id="font_smaller" onclick="changeFont('smaller')">A-</span>&nbsp;&nbsp;<span class="pull-right navbar-text" id="font_bigger" onclick="changeFont('bigger')">A+</span>
    </div>
  </nav>
  <div class="footer">
  <div class="container">
    <div class="foot">
      <br/>
                一起学编程网是一家纯计算机技术学习、电脑学习、IT技术学习交流型网站，一起学编程网站所载文章来源于网络，如果不慎侵犯了您的权益，请联系我们删除！站长QQ：657025171<br/>
               <a href="/aboutus.html">关于我们</a> | <a href="/dashiji.html">大事记</a> | <a href="/jiazhiguan.html">网站价值观</a> | <a href="/contactus.html">联系我们</a> | <a href="/submenu.html">网站地图</a> | <a href="/copyright.html">版权声明</a> | <a href="/changwei.html">长尾关键词</a> <br/>
              Copyright ◎ 2011 - 2023 zftb.cn All Rights Reserved.<br/>zftb.cn 版权所有  <a href="https://beian.miit.gov.cn/" target="_blank">京ICP备11048740号-7</a><br/>
        
    </div>
  </div>
</div> 
  <span id="count_data" style="display:none">
    <script src="/plus/count.php?view=yes&aid=747&mid=1" type='text/javascript' language="javascript">
    </script>
  </span>
  <script type="text/javascript">
    document.getElementById('count').innerHTML = document.getElementById('count_data').innerHTML;
  </script>
    <script>
      var img = $(".art_content p").find("img")
      $.each(img,function(index,el){
        el.style.width='100%';
      });
    </script>

  <!-- 将此代码放在适当的位置，建议在body结束前 -->
  <script id="bdlike_shell"></script>
  <script>

  var bdShare_config = {

  	"type":"large",

  	"color":"blue",

  	"likeText":"内容很精彩",

  	"likedText":"您已顶过，谢谢！"

  };

  document.getElementById("bdlike_shell").src="http://bdimg.share.baidu.com/static/js/like_shell.js?t=" + Math.ceil(new Date()/3600000);

  </script>
</body>
</html>