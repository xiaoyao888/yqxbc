<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>ASP网站漏洞解析及黑客入侵防范方法_鹏鹏电脑知识网_为你而生的电脑知识网站_win10系统下载_鹏鹏网</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords" content="ASP网站漏洞解析及黑客入" />
  <meta name="description" content="如何更好的达到防范黑客攻击，本人提一下个人意见！第一，免费程序不要真的就免费用，既然你可以共享原码，那么攻击者一样可以分析代码。如果在细节上注意防范，那样你站点的" />
  	<!-- Bootstrap core CSS -->
	<link href="/templets/default/css/bootstrap.min.css" rel="stylesheet">
	<!-- Bootstrap theme -->
	<link href="/templets/default/css/bootstrap-theme.min.css" rel="stylesheet">

	<!-- Custom styles for this template -->
	<link href="/templets/default/css/theme.css" rel="stylesheet">

	<!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
	<!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
	<script src="/templets/default/js/ie-emulation-modes-warning.js"></script>

	<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
	<script src="/templets/default/js/ie10-viewport-bug-workaround.js"></script>

	<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
	  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
	<script src="/templets/default/js/jquery-2.1.3.js"></script>
	<script src="/templets/default/js/bootstrap.min.js"></script>
	<script src="/templets/default/js/docs.min.js"></script>
	<link href="/templets/default/css/main.css" rel="stylesheet">
	<script src="/templets/default/js/main.js"></script>

  <script src="/templets/default/js/article.js"></script>
<!-- flypeng.com Baidu tongji analytics -->
<script>
var _hmt = _hmt || [];
(function() {
var hm = document.createElement("script");
hm.src = "//hm.baidu.com/hm.js?01a1ff7b6ab0650920aa64bf8bfad7e2";
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();
</script>
</head>
<body>
      <nav class="navbar navbar-default">

      <div class="container" style="margin-top:0px;">

        <div class="row" style="line-height:45px;">

          学习电脑知识上鹏鹏电脑知识网，www.flypeng.com！<span class="hidden-xs"><a href="javascript:void(0)" class="pull-right" onclick="alert('按Ctrl+D收藏本站')" title="win10系统">收藏本站</a></span>

        </div>

      </div>      

    </nav>

    <div class="container" style="margin-top:0px;">
      <div class="row" >

        <div class="col-sm-8 col-md-8">

            <a href="/index.html"><img src="http://www.flypeng.com/templets/default/images/logo.png" alt="Windows10系统下载,Win10激活,Win10教程" width="196" height="64"/></a>

        </div>
        <div class="col-sm-4 col-md-4">
        <div style="height:45px;">
        <form  method="post" id="searchFrm" role="search" action="/plus/search.php">
            <div class="input-group">
                <input type="text" class="form-control" id="keyword" name="keyword" placeholder="Search">
                <span class="input-group-btn">
                    <button type="button" class="btn btn-default" onclick="searchKey()">搜索</button>
                </span>
            </div><!-- /input-group -->
          </form>
        </div>
        </div>
      </div>
    </div>

    <nav class="navbar navbar-default navbar-custom">

      <div class="container">


<!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header navbar-header-custom">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">首页</a>
        </div>


        <!-- Collect the nav links, forms, and other content for toggling -->

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

          <ul class="nav navbar-nav nav-custom">
             <li class="dropdown">

              <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">电脑知识<span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="/dnzs" title="电脑基础知识学习，计算机技术学习网站，计算机基础知识,电脑学习">电脑知识 <span class="sr-only">(current)</span></a></li>

                <li><a href="/dngz" title="电脑故障大全，计算机故障大全">故障大全</a></li>

                <li><a href="/wlzs" title="网络知识大全">网络知识</a></li>

              </ul>

            </li>

            <li><a href="/sjzs" title="手机故障，手机知识，手机频道">手机知识</a></li>            

            <li class="dropdown">

              <a href="/czxt" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">操作系统<span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="/czxt/windows7" title="windows7系统">windows7</a></li>                

                <li><a href="/czxt/windows8" title="windows8系统">windows8</a></li>                

                <li><a href="http://www.win10os.com" title="windows10系统">windows10</a></li>                

                <li><a href="/czxt/linux" title="linux系统">linux</a></li>

              </ul>

            </li>

            
            <li class="dropdown">

              <a href="/bcsj" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">编程设计<span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="/bcsj/css" title="css">css</a></li>

                <li><a href="/bcsj/java" title="java">java</a></li>

                <li><a href="/bcsj/php" title="php">php</a></li>

                <li><a href="/bcsj/aspnet" title="aspnet">aspnet</a></li>

                <li><a href="/bcsj/js" title="javascript">javascript</a></li>

                <li><a href="/bcsj/ajax" title="ajax">ajax</a></li>

                <li><a href="/bcsj/hadoop" title="hadoop">hadoop</a></li>                

              </ul>

            </li>     

            <li class="dropdown">

              <a href="/shujuku" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">数据库 <span class="caret"></span></a>

              <ul class="dropdown-menu">

                <li><a href="/shujuku/sqlserver" title="sql server数据库">SqlServer</a></li>

                <li><a href="/shujuku/mysql" title="MySQL数据库">MySql</a></li>                

                <li><a href="/shujuku/oracle" title="Oracle数据库">Oracle</a></li>                

                <li><a href="/shujuku/mangodb" title="MangoDB数据库">MangoDB</a></li>                

                <li><a href="/shujuku/hbase" title="HBase数据库">HBase</a></li>

                <li><a href="/shujuku/db2" title="DB2数据库">DB2</a></li>

                <li><a href="/shujuku/redis" title="Redis数据库">Redis</a></li>

              </ul>

            </li>
            <li><a href='/yunjisuan' target="_blank" title="云计算">云计算</a></li>
            <li><a href='/dashuju' target="_blank" title="大数据">大数据</a></li>
            <li><a href='/wulianwang' target="_blank" title="物联网">物联网</a></li>
            <li><a href='/main/website.html' target="_blank" title="好站推荐">好站推荐</a></li>
            <li><a href='/erweima/' target="_blank" title="二维码生成">常用工具</a></li>
          </ul>

          
        </div><!-- /.navbar-collapse -->

      </div><!-- /.container-fluid -->

    </nav>

    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">

       <div class="modal-dialog">

          <div class="modal-content">

             <div class="modal-header">

                <button type="button" class="close" data-dismiss="modal" 

                   aria-hidden="true">×

                </button>

                <h4 class="modal-title" id="myModalLabel">

                   搜索提示

                </h4>

             </div>

             <div class="modal-body">

                <div style="height:60px;line-height:60px;">

                  关键字不能小于2个字！

                </div>

             </div>

          </div><!-- /.modal-content -->

       </div><!-- /.modal-dialog -->

    </div><!-- /.modal -->
<script type="text/javascript">
  function searchKey(){
    var keyword = $("#keyword").val();
    if(keyword.length<2){
      $('#myModal').modal('show');     
      return;
    }else{
      $("#searchFrm").submit();
    }

  }
</script>
  <div class="modal fade" id="imgModal" tabindex="-1" role="dialog" aria-hidden="true">
	   <div class="modal-dialog">
		  <div class="modal-content">
			 <div class="modal-body">
				<div id="modal_img" ></div>
			 </div>
		  </div>
	   </div>
	</div>
  <div class="container" style="padding-left:0px;padding-right:0px">
    
    <div class="col-sm-8  col-md-8">
      <ol class="breadcrumb">
      当前位置：<a href='http://www.flypeng.com/'>首页</a> > <a href='/bcsj/'>编程设计</a> > <a href='/bcsj/aspnet/'>aspnet</a> > 
      </ol>
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="art_title">
            <h3>ASP网站漏洞解析及黑客入侵防范方法</h3>
            <a href="http://www.flypeng.com" title="http://www.flypeng.com">http://www.flypeng.com</a>&nbsp;<a href="http://www.flypeng.com">win10系统</a>  发布时间：2015-05-12 09:14 来源：鹏鹏电脑知识网 浏览：<span id="count"style="font-size:14px;">加载中</span>次
          </div>
          <div class="art_body">
            <div class="art_share"><div><div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script></div></div>
            <div id="741" class="art_content">&nbsp;&nbsp;&nbsp;&nbsp;如何更好的达到防范黑客攻击，本人提一下个人意见！第一，免费程序不要真的就免费用，既然你可以共享原码，那么攻击者一样可以分析代码。如果在细节上注意防范，那样你站点的安全性就大大的提高了。即使出现了SQL&nbsp;Injection这样的漏洞，攻击者也不可能马上拿下你的站点。&nbsp;<br />
<br />
　　由于ASP的方便易用，越来越多的网站后台程序都使用ASP脚本语言。但是，&nbsp;由于ASP本身存在一些安全漏洞，稍不小心就会给黑客提供可乘之机。事实上，安全不仅是网管的事，编程人员也必须在某些安全细节上注意，养成良好的安全习惯，否则会给自己的网站带来巨大的安全隐患。目前，大多数网站上的ASP程序有这样那样的安全漏洞，但如果编写程序的时候注意一点的话，还是可以避免的。<br />
<br />
　　1、用户名与口令被破解<br />
<br />
　　攻击原理：用户名与口令，往往是黑客们最感兴趣的东西，如果被通过某种方式看到源代码，后果是严重的。<br />
<br />
　　防范技巧：涉及用户名与口令的程序最好封装在服务器端，尽量少在ASP文件里出现，涉及与数据库连接的用户名与口令应给予最小的权限。出现次数多的用户名与口令可以写在一个位置比较隐蔽的包含文件中。如果涉及与数据库连接，在理想状态下只给它以执行存储过程的权限，千万不要直接给予该用户修改、插入、删除记录的权限。&nbsp;<br />
<br />
　　2、验证被绕过<br />
<br />
　　攻击原理：现在需要经过验证的ASP程序大多是在页面头部加一个判断语句，但这还不够，有可能被黑客绕过验证直接进入。<br />
<br />
　　防范技巧：需要经过验证的ASP页面，可跟踪上一个页面的文件名，只有从上一页面转进来的会话才能读取这个页面。<br />
<br />
　　3、inc文件泄露问题<br />
<br />
　　攻击原理：当存在ASP的主页正在制作且没有进行最后调试完成以前，可以被某些搜索引擎机动追加为搜索对象。如果这时候有人利用搜索引擎对这些网页进行查找，会得到有关文件的定位，并能在浏览器中查看到数据库地点和结构的细节，并以此揭示完整的源代码。<br />
<br />
　　防范技巧：程序员应该在网页发布前对它进行彻底的调试；安全专家则需要加固ASP文件以便外部的用户不能看到它们。首先对.inc文件内容进行加密，其次也可以使用.asp文件代替.inc文件使用户无法从浏览器直接观看文件的源代码。inc文件的文件名不要使用系统默认的或者有特殊含义容易被用户猜测到的名称，尽量使用无规则的英文字母。<br />
<br />
　　4、自动备份被下载<br />
<br />
　　攻击原理：在有些编辑ASP程序的工具中，当创建或者修改一个ASP文件时，编辑器自动创建一个备份文件，比如：UltraEdit就会备份一个.bak文件，如你创建或者修改了some.asp，编辑器会自动生成一个叫some.asp.bak文件，如果你没有删除这个bak文件，攻击者可以直接下载some.asp.bak文件，这样some.asp的源程序就会被下载。<br />
<br />
　　防范技巧：上传程序之前要仔细检查，删除不必要的文档。对以BAK为后缀的文件要特别小心。<br />
<br />
　　5、特殊字符<br />
<br />
　　攻击原理：输入框是黑客利用的一个目标，他们可以通过输入脚本语言等对用户客户端造成损坏；如果该输入框涉及数据查询，他们会利用特殊查询语句，得到更多的数据库数据，甚至表的全部。因此必须对输入框进行过滤。但如果为了提高效率仅在客户端进行输入合法性检查，仍有可能被绕过。<br />
<br />
　　防范技巧：在处理类似留言板、BBS等输入框的ASP程序中，最好屏蔽掉HTML、JavaScript、VBScript语句，如无特殊要求，可以限定只允许输入字母与数字，屏蔽掉特殊字符。同时对输入字符的长度进行限制。而且不但要在客户端进行输入合法性检查，同时要在服务器端程序中进行类似检查。<br />
<br />
　　6、数据库下载漏洞<br />
<br />
　　攻击原理：在用Access做后台数据库时，如果有人通过各种方法知道或者猜到了服务器的Access数据库的路径和数据库名称，那么他也能够下载这个Access数据库文件，这是非常危险的。<br />
<br />
　　防范技巧：<br />
<br />
　　（1）为你的数据库文件名称起个复杂的非常规的名字，并把它放在几层目录下。所谓&nbsp;&ldquo;非常规&rdquo;，&nbsp;打个比方说，比如有个数据库要保存的是有关书籍的信息，&nbsp;可不要给它起个&ldquo;book.mdb&rdquo;的名字，而要起个怪怪的名称，比如d34ksfslf.mdb，&nbsp;并把它放在如./kdslf/i44/studi/的几层目录下，这样黑客要想通过猜的方式得到你的Access数据库文件就难上加难了。<br />
<br />
　　（2）不要把数据库名写在程序中。有些人喜欢把DSN写在程序中，比如：&nbsp;<br />
<br />
　　
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				DBPath&nbsp;=&nbsp;Server.MapPath（&ldquo;cmddb.mdb&rdquo;）<br />
				　　conn.Open&nbsp;&ldquo;driver={Microsoft&nbsp;Access&nbsp;Driver&nbsp;（*.mdb）}；dbq=&rdquo;&nbsp;&amp;&nbsp;DBPath</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　假如万一给人拿到了源程序，你的Access数据库的名字就一览无余了。因此建议你在ODBC里设置数据源，再在程序中这样写：<br />
<br />
　　
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				conn.open&ldquo;shujiyuan&rdquo;</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　（3）使用Access来为数据库文件编码及加密。首先在&ldquo;工具&rarr;安全&rarr;加密/解密数据库&rdquo;中选取数据库（如：employer.mdb），然后按确定，接着会出现&ldquo;数据库加密后另存为&rdquo;的窗口，可存为：&ldquo;employer1.mdb&rdquo;。<br />
<br />
　　要注意的是，以上的动作并不是对数据库设置密码，而只是对数据库文件加以编码，目的是为了防止他人使用别的工具来查看数据库文件的内容。<br />
<br />
　　接下来我们为数据库加密，首先打开经过编码了的&nbsp;employer1.mdb，在打开时，选择&ldquo;独占&rdquo;方式。然后选取功能表的&ldquo;工具&rarr;安全&rarr;设置数据库密码&rdquo;，接着输入密码即可。这样即使他人得到了employer1.mdb文件，没有密码他也是无法看到&nbsp;employer1.mdb中的内容。<br />
<br />
　　7、防范远程注入攻击&nbsp;<br />
<br />
　　这类攻击在以前应该是比较常见的攻击方式,比如POST攻击,攻击者可以随便的改变要提交的数据值已达到攻击目的.又如:COOKIES&nbsp;的伪造,这一点更值得引起程序编写者或站长的注意，不要使用COOKIES来做为用户验证的方式,否则你和把钥匙留给贼是同一个道理.&nbsp;<br />
<br />
　　比如:&nbsp;<br />
<br />
　　
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				If&nbsp;trim(Request.&nbsp;cookies&nbsp;(&quot;uname&quot;))=&quot;fqy&quot;&nbsp;and&nbsp;Request.cookies(&quot;upwd&quot;)&nbsp;=&rdquo;fqy#e3i5.com&rdquo;&nbsp;then&nbsp;<br />
				　　&hellip;&hellip;..more&hellip;&hellip;&hellip;&nbsp;<br />
				　　End&nbsp;if</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;&nbsp;<br />
<br />
　　我想各位站长或者是喜好写程序的朋友千万别出这类错误,真的是不可饶恕.伪造COOKIES&nbsp;都多少年了，你还用这样的就不能怪别人跑你的密码.涉及到用户密码或者是用户登陆时,你最好使用session&nbsp;它才是最安全的.如果要使用COOKIES就在你的COOKIES上多加一个信息,SessionID,它的随机值是64位的,要猜解它,不可能.例:&nbsp;<br />
<br />
　　
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				if&nbsp;not&nbsp;(rs.BOF&nbsp;or&nbsp;rs.eof)&nbsp;then&nbsp;<br />
				　　login=&quot;true&quot;&nbsp;<br />
				　　Session(&quot;username&quot;&amp;sessionID)&nbsp;=&nbsp;Username&nbsp;<br />
				　　Session(&quot;password&quot;&amp;&nbsp;sessionID)&nbsp;=&nbsp;Password&nbsp;<br />
				　　&lsquo;Response.cookies(&ldquo;username&rdquo;)=&nbsp;Username&nbsp;<br />
				　　&lsquo;Response.cookies(&ldquo;Password&rdquo;)=&nbsp;Password</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;&nbsp;<br />
<br />
　　下面我们来谈谈如何防范远程注入攻击,一般的攻击都是将单表提交文件拖到本地,将Form&nbsp;ACTION=&rdquo;chk.asp&rdquo;&nbsp;指向你服务器中处理数据的文件即可.如果你全部的数据过滤都在单表页上，那么恭喜你，你将已经被脚本攻击了.&nbsp;<br />
<br />
　　怎么才能制止这样的远程攻击?好办,请看代码如下:&nbsp;程序体(9)&nbsp;<br />
<br />
　　
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				＜%&nbsp;<br />
				　　server_v1=Cstr(Request.ServerVariables(&quot;HTTP_REFERER&quot;))&nbsp;<br />
				　　server_v2=Cstr(Request.ServerVariables(&quot;SERVER_NAME&quot;))&nbsp;<br />
				　　if&nbsp;mid(server_v1,8,len(server_v2))＜＞server_v2&nbsp;then&nbsp;<br />
				　　response.write&nbsp;&quot;＜br＞＜br＞＜center&gt;&quot;&nbsp;<br />
				　　response.write&nbsp;&quot;&nbsp;&quot;&nbsp;<br />
				　　response.write&nbsp;&quot;你提交的路径有误，禁止从站点外部提交数据请不要乱改参数！&quot;&nbsp;<br />
				　　response.write&nbsp;&quot;&nbsp;&quot;&nbsp;<br />
				　　response.end&nbsp;<br />
				　　end&nbsp;if&nbsp;<br />
				　　%&gt;</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;个人感觉上面的代码过滤不是很好，有一些外部提交竟然还能堂堂正正的进来,于是再写一个.&nbsp;<br />
<br />
　　这个是过滤效果很好,建议使用.&nbsp;&nbsp;<br />
<br />
　　
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				if&nbsp;instr(request.servervariables(&quot;http_referer&quot;),&quot;http://&quot;&amp;request.servervariables(&quot;host&quot;)&nbsp;)&lt;1&nbsp;then&nbsp;<br />
				&nbsp;&nbsp;&nbsp;&nbsp;response.write&nbsp;&quot;处理&nbsp;URL&nbsp;时服务器上出错。如果您是在用任何手段攻击服务器，那你应该庆幸，你的所有操作已经被服务器记录，我们会第一时间通知公安局与国家安全部门来调查你的IP。&quot;&nbsp;<br />
				　　response.end&nbsp;<br />
				　　end&nbsp;if</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　程序体(9)&nbsp;<br />
<br />
　　本以为这样就万事大吉了，在表格页上加一些限制,比如maxlength啦,等等..但天公就是那么不作美,你越怕什么他越来什么.你别忘了,攻击者可以突破sql注入攻击时输入框长度的限制.写一个SOCKET程序改变HTTP_REFERER？我不会。网上发表了这样一篇文章：&nbsp;<br />
<br />
　　
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				------------len.reg-----------------&nbsp;<br />
				　　Windows&nbsp;Registry&nbsp;Editor&nbsp;Version&nbsp;5.00&nbsp;<br />
				　　[HKEY_CURRENT_USER\\Software\\Microsoft\\Internet&nbsp;Explorer\\MenuExt\\扩展(&amp;E)]&nbsp;<br />
				　　@=&quot;C:\\Documents&nbsp;and&nbsp;Settings\\Administrator\\桌面\\len.htm&quot;&nbsp;<br />
				　　&quot;contexts&quot;=dword:00000004&nbsp;<br />
				　　-----------end----------------------&nbsp;<br />
				　　-----------len.htm------------------&nbsp;<br />
				　　-----------end-----------------------</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　用法:先把len.reg导入注册表(注意文件路径)&nbsp;<br />
<br />
　　然后把len.htm拷到注册表中指定的地方.&nbsp;<br />
<br />
　　打开网页,光标放在要改变长度的输入框上点右键,看多了一个叫扩展的选项了吧&nbsp;<br />
<br />
　　单击搞定!&nbsp;后记:同样的也就可以对付那些限制输入内容的脚本了.&nbsp;<br />
<br />
　　怎么办？我们的限制被饶过了，所有的努力都白费了？不，举起你de键盘，说不。让我们继续回到脚本字符的过滤吧，他们所进行的注入无非就是进行脚本攻击。我们把所有的精力全都用到ACTION以后的页面吧，在chk.asp页中，我们将非法的字符全部过滤掉，结果如何？我们只在前面虚晃一枪，叫他们去改注册表吧，当他们改完才会发现，他们所做的都是那么的徒劳。&nbsp;<br />
<br />
　　8、ASP木马<br />
<br />
　　已经讲到这里了，再提醒各位论坛站长一句，小心你们的文件上传：为什么论坛程序被攻破后主机也随之被攻击者占据。原因就在&hellip;&hellip;对！ASP木马！一个绝对可恶的东西。病毒么？非也.把个文件随便放到你论坛的程序中，您老找去吧。不吐血才怪哦。如何才能防止ASP木马被上传到服务器呢？方法很简单，如果你的论坛支持文件上传，请设定好你要上传的文件格式，我不赞成使用可更改的文件格式，直接从程序上锁定，只有图象文件格式，和压缩文件就完全可以，多给自己留点方便也就多给攻击者留点方便。怎么判断格式，我这里收集了一个，也改出了一个，大家可以看一下：&nbsp;<br />
<br />
　　程序体（10）&nbsp;<br />
<br />
　　
<table align="\&quot;center\&quot;" border="\&quot;0\&quot;" cellpadding="\&quot;0\&quot;" cellspacing="\&quot;0\&quot;">
	<tbody>
		<tr>
			<td class="\&quot;code\&quot;" width="\&quot;560\&quot;">
				朙判断文件类型是否合格&nbsp;<br />
				　　Private&nbsp;Function&nbsp;CheckFileExt&nbsp;(fileEXT)&nbsp;<br />
				　　dim&nbsp;Forumupload&nbsp;<br />
				　　Forumupload=&quot;gif,jpg,bmp,jpeg&quot;&nbsp;<br />
				　　Forumupload=split(Forumupload,&quot;,&quot;)&nbsp;<br />
				　　for&nbsp;i=0&nbsp;to&nbsp;ubound(Forumupload)&nbsp;<br />
				　　if&nbsp;lcase(fileEXT)=lcase(trim(Forumupload(i)))&nbsp;then&nbsp;<br />
				　　CheckFileExt=true&nbsp;<br />
				　　exit&nbsp;Function&nbsp;<br />
				　　else&nbsp;<br />
				　　CheckFileExt=false&nbsp;<br />
				　　end&nbsp;if&nbsp;<br />
				　　next&nbsp;<br />
				　　End&nbsp;Function&nbsp;<br />
				　　朙验证文件内容的合法性<br />
				&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;MyFile&nbsp;=&nbsp;server.CreateObject&nbsp;(&quot;Scripting.FileSystemObject&quot;)&nbsp;<br />
				　　set&nbsp;MyText&nbsp;=&nbsp;MyFile.OpenTextFile&nbsp;(sFile,&nbsp;1)&nbsp;<br />
				&nbsp;&nbsp;&nbsp;&nbsp;朙读取文本文件&nbsp;<br />
				　　sTextAll&nbsp;=&nbsp;lcase(MyText.ReadAll):&nbsp;MyText.close&nbsp;<br />
				　　朙判断用户文件中的危险操作&nbsp;<br />
				　　sStr&nbsp;=&quot;8　.getfolder　.createfolder　.deletefolder　.createdirectory　&nbsp;<br />
				　　.deletedirectory&quot;&nbsp;<br />
				　　sStr&nbsp;=&nbsp;sStr&nbsp;&amp;&nbsp;&quot;　.saveas　wscript.shell　script.encode&quot;&nbsp;<br />
				　　sNoString&nbsp;=&nbsp;split(sStr,&quot;　&quot;)&nbsp;<br />
				　　for&nbsp;i&nbsp;=&nbsp;1&nbsp;to&nbsp;sNoString(0)&nbsp;<br />
				　　if&nbsp;instr(sTextAll,&nbsp;sNoString(i))&nbsp;＜＞&nbsp;0&nbsp;then&nbsp;<br />
				　　sFile&nbsp;=&nbsp;Upl.Path&nbsp;&amp;&nbsp;sFileSave:&nbsp;fs.DeleteFile&nbsp;sFile&nbsp;<br />
				　　Response.write&nbsp;&quot;＜center＞＜br＞＜big＞&quot;&amp;&nbsp;sFileSave&nbsp;&amp;&quot;文件中含有与操作目录等有关的命令&quot;&amp;_&nbsp;<br />
				　　&quot;＜br＞＜font&nbsp;color=red＞&quot;&amp;&nbsp;mid(sNoString(i),2)&nbsp;&amp;&quot;＜/font＞，为了安全原因，＜b＞不能上传。＜b＞&quot;&amp;_&quot;＜/big＞＜/center＞＜/html＞&quot;&nbsp;<br />
				　　Response.end&nbsp;<br />
				　　end&nbsp;if&nbsp;<br />
				　　next</td>
		</tr>
	</tbody>
</table>
&nbsp;&nbsp;<br />
<br />
　　把他们加到你的上传程序里做一次验证，那么你的上传程序安全性将会大大提高.&nbsp;<br />
<br />
　　什么？你还不放心？拿出杀手锏，请你的虚拟主机服务商来帮忙吧。登陆到服务器，将PROG&nbsp;ID&nbsp;中的&quot;shell.application&quot;项和&quot;shell.application.1&quot;项改名或删除。再将&rdquo;WSCRIPT.SHELL&rdquo;项和&rdquo;WSCRIPT.SHELL.1&rdquo;这两项都要改名或删除。呵呵，我可以大胆的说，国内可能近半以上的虚拟主机都没改过。只能庆幸你们的用户很合作，否则&hellip;&hellip;我删，我删，我删删删&hellip;&hellip;</div>
  		  <!-- 将此标记放在您希望显示like按钮的位置 -->          
            <div class="art_like"><div class="bdlikebutton"></div></div>
          </div>
        </div>
      </div>
      <div class="pnum">
        <div class="pages mypagelist">
          <div></div>
        </div>
      </div>
      <div class="pre_next">
        <nav>
          <ul class="pager">
            <li class="previous">上一篇：<a href='/bcsj/aspnet/2015/0512/740.html'>三种方法ASP读取大量数据的速度比较</a> </li>
            <li class="next">下一篇：<a href='/bcsj/aspnet/2015/0512/743.html'>IIS服务器排错指南及错误代码大全</a> </li>
          </ul>
        </nav>
      </div>
      <div class="well"> 
    		如果你有好的<a href="http://www.win10os.com/win10zixun" title="win10资讯">win10资讯</a>或者<a href="http://www.win10os.com/win10jiqiao" title="win10教程">win10教程</a>，以及<a href="http://www.win10os.com/win10xitong" title="win10">win10</a>相关的问题想要获得<a href="http://www.win10os.com/win10xiazai" title="win10系统下载">win10系统下载</a>的关注与报道。<br/>欢迎加入发送邮件到657025171#qq.com(#替换为@)。期待你的好消息！
    	</div>  
      <div class="row">
        
          
        
      </div>
    </div>
    <!--右侧部分-->
    <div class="col-sm-4 col-md-4">
      <script src='/plus/ad_js.php?aid=12' language='javascript'></script>
      <div class="panel panel-custom panel-custom-right">
        <div class="panel-heading">最新文章>>></div>
        <div class="panel-body">
          <ul class="all_list">
            <li><a href="/bcsj/aspnet/2015/0515/806.html" >ASP下实现多条件模糊查询SQL语句</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/805.html" >ASP网站漏洞及入侵防范方法</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/804.html" >如何动态创建网页的RSS内容摘要</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/803.html" >ASP动态网页开发中的WEB打印代码大全</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/802.html" >VS2010快捷键</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/801.html" >获得当前带参数的页面地址</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/800.html" >Global.asa文件用法详解</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/799.html" >替换DISTINCT查找重复记录的方法</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/798.html" >用XMLHTTP解析图片地址并保存</a><span>05.15</span></li>
<li><a href="/bcsj/aspnet/2015/0515/797.html" >ASP小偷中可控制删除文本html标签的函数</a><span>05.15</span></li>
 
          </ul>
        </div>
      </div>  
      <script src='/plus/ad_js.php?aid=14' language='javascript'></script>
      <div id="scr_cont" class="panel panel-custom panel-custom-right">
        <div class="panel-heading">相关热门>>></div>
        <div class="panel-body">
          <ul class="all_list">
            <li><a href="/bcsj/aspnet/2015/0515/802.html" >VS2010快捷键</a><span>70</span></li>
<li><a href="/bcsj/aspnet/2015/0515/804.html" >如何动态创建网页的RSS内容摘要</a><span>61</span></li>
<li><a href="/bcsj/aspnet/2015/0515/806.html" >ASP下实现多条件模糊查询SQL语句</a><span>54</span></li>
<li><a href="/bcsj/aspnet/2015/0305/176.html" >ASP实现可显隐的树型菜单</a><span>49</span></li>
<li><a href="/bcsj/aspnet/2015/0515/801.html" >获得当前带参数的页面地址</a><span>49</span></li>
<li><a href="/bcsj/aspnet/2015/0515/799.html" >替换DISTINCT查找重复记录的方法</a><span>48</span></li>
<li><a href="/bcsj/aspnet/2015/0515/805.html" >ASP网站漏洞及入侵防范方法</a><span>47</span></li>
<li><a href="/bcsj/aspnet/2015/0513/779.html" >实例演练ASP+XML编程</a><span>36</span></li>
<li><a href="/bcsj/aspnet/2015/0513/789.html" >重新安装IIS的方法</a><span>36</span></li>
<li><a href="/bcsj/aspnet/2015/0515/798.html" >用XMLHTTP解析图片地址并保存</a><span>36</span></li>
 
          </ul>
          </ul>
        </div>
      </div>
      <script src='/plus/ad_js.php?aid=15' language='javascript'></script>
    </div>
    
  </div>
  <nav class="navbar navbar-default navbar-fixed-bottom navbar-bottom-custom">
    <div class="container">
      <span class="pull-right navbar-text" id="font_smaller" onclick="changeFont('smaller')">A-</span>&nbsp;&nbsp;<span class="pull-right navbar-text" id="font_bigger" onclick="changeFont('bigger')">A+</span>
    </div>
  </nav>
  <div class="footer">
  <div class="container">
    <div class="foot">
      <br/>
                鹏鹏电脑知识网是一家纯计算机技术学习、电脑学习、IT技术学习交流型网站，鹏鹏电脑知识网站所载文章来源于网络，如果不慎侵犯了您的权益，请联系我们删除！站长QQ：657025171<br/>
               <a href="/aboutus.html">关于我们</a> | <a href="/dashiji.html">大事记</a> | <a href="/jiazhiguan.html">网站价值观</a> | <a href="/contactus.html">联系我们</a> | <a href="/submenu.html">网站地图</a> | <a href="/copyright.html">版权声明</a> | <a href="/changwei.html">长尾关键词</a> <br/>
              Copyright ◎ 2011 - 2017 flypeng.com All Rights Reserved.<br/>flypeng.com 版权所有  <a href="http://www.miit.gov.cn/n11293472/index.html" target="_blank">京ICP备11048740号</a><br/>
        
    </div>
  </div>
</div> 
  <span id="count_data" style="display:none">
    <script src="/plus/count.php?view=yes&aid=741&mid=1" type='text/javascript' language="javascript">
    </script>
  </span>
  <script type="text/javascript">
    document.getElementById('count').innerHTML = document.getElementById('count_data').innerHTML;
  </script>
    <script>
      var img = $(".art_content p").find("img")
      $.each(img,function(index,el){
        el.style.width='100%';
      });
    </script>

  <!-- 将此代码放在适当的位置，建议在body结束前 -->
  <script id="bdlike_shell"></script>
  <script>

  var bdShare_config = {

  	"type":"large",

  	"color":"blue",

  	"likeText":"内容很精彩",

  	"likedText":"您已顶过，谢谢！"

  };

  document.getElementById("bdlike_shell").src="http://bdimg.share.baidu.com/static/js/like_shell.js?t=" + Math.ceil(new Date()/3600000);

  </script>
</body>
</html>